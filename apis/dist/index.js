var Fg=Object.create;var bs=Object.defineProperty;var qg=Object.getOwnPropertyDescriptor;var Qg=Object.getOwnPropertyNames;var Ug=Object.getPrototypeOf,$g=Object.prototype.hasOwnProperty;var i=(r,e)=>bs(r,"name",{value:e,configurable:!0}),jg=(r=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(r,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):r)(function(r){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+r+'" is not supported')});var fe=(r,e)=>()=>(r&&(e=r(r=0)),e);var te=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Hg=(r,e)=>{for(var t in e)bs(r,t,{get:e[t],enumerable:!0})},Vg=(r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Qg(e))!$g.call(r,n)&&n!==t&&bs(r,n,{get:()=>e[n],enumerable:!(s=qg(e,n))||s.enumerable});return r};var Kg=(r,e,t)=>(t=r!=null?Fg(Ug(r)):{},Vg(e||!r||!r.__esModule?bs(t,"default",{value:r,enumerable:!0}):t,r));function de(r){return new Error(`[unenv] ${r} is not implemented yet!`)}function j(r){return Object.assign(i(()=>{throw de(r)},"fn"),{__unenv__:!0})}function _e(r){let e=j(r);return e.__promisify__=()=>j(r+".__promisify__"),e.native=e,e}function it(r){return class{__unenv__=!0;constructor(){throw new Error(`[unenv] ${r} is not implemented yet!`)}}}var ot=fe(()=>{S();w();b();i(de,"createNotImplementedError");i(j,"notImplemented");i(_e,"notImplementedAsync");i(it,"notImplementedClass")});var yi,gi,zg,Rt,bi,_r,Er,ws,xr,Ss,bu,wu=fe(()=>{S();w();b();ot();yi=globalThis.performance?.timeOrigin??Date.now(),gi=globalThis.performance?.now?globalThis.performance.now.bind(globalThis.performance):()=>Date.now()-yi,zg={name:"node",entryType:"node",startTime:0,duration:0,nodeStart:0,v8Start:0,bootstrapComplete:0,environment:0,loopStart:0,loopExit:0,idleTime:0,uvMetricsInfo:{loopCount:0,events:0,eventsWaiting:0},detail:void 0,toJSON(){return this}},Rt=class{static{i(this,"PerformanceEntry")}__unenv__=!0;detail;entryType="event";name;startTime;constructor(e,t){this.name=e,this.startTime=t?.startTime||gi(),this.detail=t?.detail}get duration(){return gi()-this.startTime}toJSON(){return{name:this.name,entryType:this.entryType,startTime:this.startTime,duration:this.duration,detail:this.detail}}},bi=class extends Rt{static{i(this,"PerformanceMark")}entryType="mark";constructor(){super(...arguments)}get duration(){return 0}},_r=class extends Rt{static{i(this,"PerformanceMeasure")}entryType="measure"},Er=class extends Rt{static{i(this,"PerformanceResourceTiming")}entryType="resource";serverTiming=[];connectEnd=0;connectStart=0;decodedBodySize=0;domainLookupEnd=0;domainLookupStart=0;encodedBodySize=0;fetchStart=0;initiatorType="";name="";nextHopProtocol="";redirectEnd=0;redirectStart=0;requestStart=0;responseEnd=0;responseStart=0;secureConnectionStart=0;startTime=0;transferSize=0;workerStart=0;responseStatus=0},ws=class{static{i(this,"PerformanceObserverEntryList")}__unenv__=!0;getEntries(){return[]}getEntriesByName(e,t){return[]}getEntriesByType(e){return[]}},xr=class{static{i(this,"Performance")}__unenv__=!0;timeOrigin=yi;eventCounts=new Map;_entries=[];_resourceTimingBufferSize=0;navigation=void 0;timing=void 0;timerify(e,t){throw de("Performance.timerify")}get nodeTiming(){return zg}eventLoopUtilization(){return{}}markResourceTiming(){return new Er("")}onresourcetimingbufferfull=null;now(){return this.timeOrigin===yi?gi():Date.now()-this.timeOrigin}clearMarks(e){this._entries=e?this._entries.filter(t=>t.name!==e):this._entries.filter(t=>t.entryType!=="mark")}clearMeasures(e){this._entries=e?this._entries.filter(t=>t.name!==e):this._entries.filter(t=>t.entryType!=="measure")}clearResourceTimings(){this._entries=this._entries.filter(e=>e.entryType!=="resource"||e.entryType!=="navigation")}getEntries(){return this._entries}getEntriesByName(e,t){return this._entries.filter(s=>s.name===e&&(!t||s.entryType===t))}getEntriesByType(e){return this._entries.filter(t=>t.entryType===e)}mark(e,t){let s=new bi(e,t);return this._entries.push(s),s}measure(e,t,s){let n,o;typeof t=="string"?(n=this.getEntriesByName(t,"mark")[0]?.startTime,o=this.getEntriesByName(s,"mark")[0]?.startTime):(n=Number.parseFloat(t?.start)||this.now(),o=Number.parseFloat(t?.end)||this.now());let a=new _r(e,{startTime:n,detail:{start:n,end:o}});return this._entries.push(a),a}setResourceTimingBufferSize(e){this._resourceTimingBufferSize=e}addEventListener(e,t,s){throw de("Performance.addEventListener")}removeEventListener(e,t,s){throw de("Performance.removeEventListener")}dispatchEvent(e){throw de("Performance.dispatchEvent")}toJSON(){return this}},Ss=class{static{i(this,"PerformanceObserver")}__unenv__=!0;static supportedEntryTypes=[];_callback=null;constructor(e){this._callback=e}takeRecords(){return[]}disconnect(){throw de("PerformanceObserver.disconnect")}observe(e){throw de("PerformanceObserver.observe")}bind(e){return e}runInAsyncScope(e,t,...s){return e.call(t,...s)}asyncId(){return 0}triggerAsyncId(){return 0}emitDestroy(){return this}},bu=globalThis.performance&&"addEventListener"in globalThis.performance?globalThis.performance:new xr});var Su=fe(()=>{S();w();b();wu()});var b=fe(()=>{Su();globalThis.performance=bu;globalThis.Performance=xr;globalThis.PerformanceEntry=Rt;globalThis.PerformanceMark=bi;globalThis.PerformanceMeasure=_r;globalThis.PerformanceObserver=Ss;globalThis.PerformanceObserverEntryList=ws;globalThis.PerformanceResourceTiming=Er});var Fe,vu=fe(()=>{S();w();b();Fe=Object.assign(()=>{},{__unenv__:!0})});import{Writable as _u}from"node:stream";var Ce,Eu,xu,Cu,vs,Wg,QT,UT,$T,Gg,jT,HT,VT,KT,zT,WT,GT,YT,JT,XT,ZT,eP,tP,rP,sP,nP,Tu,Pu,Au,Ru,Nu=fe(()=>{S();w();b();vu();ot();Ce=globalThis.console,Eu=!0,xu=new _u,Cu=new _u,vs=Ce?.log??Fe,Wg=Ce?.info??vs,QT=Ce?.trace??Wg,UT=Ce?.debug??vs,$T=Ce?.table??vs,Gg=Ce?.error??vs,jT=Ce?.warn??Gg,HT=Ce?.createTask??j("console.createTask"),VT=Ce?.clear??Fe,KT=Ce?.count??Fe,zT=Ce?.countReset??Fe,WT=Ce?.dir??Fe,GT=Ce?.dirxml??Fe,YT=Ce?.group??Fe,JT=Ce?.groupEnd??Fe,XT=Ce?.groupCollapsed??Fe,ZT=Ce?.profile??Fe,eP=Ce?.profileEnd??Fe,tP=Ce?.time??Fe,rP=Ce?.timeEnd??Fe,sP=Ce?.timeLog??Fe,nP=Ce?.timeStamp??Fe,Tu=Ce?.Console??it("console.Console"),Pu=new Map,Au=Fe,Ru=Fe});var wi,hP,fP,pP,dP,mP,yP,gP,bP,wP,SP,vP,_P,EP,xP,CP,TP,PP,AP,RP,NP,OP,IP,LP,MP,Ou,Iu=fe(()=>{S();w();b();Nu();wi=globalThis.console,{assert:hP,clear:fP,context:pP,count:dP,countReset:mP,createTask:yP,debug:gP,dir:bP,dirxml:wP,error:SP,group:vP,groupCollapsed:_P,groupEnd:EP,info:xP,log:CP,profile:TP,profileEnd:PP,table:AP,time:RP,timeEnd:NP,timeLog:OP,timeStamp:IP,trace:LP,warn:MP}=wi;Object.assign(wi,{Console:Tu,_ignoreErrors:Eu,_stderr:xu,_stderrErrorHandler:Ru,_stdout:Cu,_stdoutErrorHandler:Au,_times:Pu});Ou=wi});var w=fe(()=>{Iu();globalThis.console=Ou});var Lu,Mu=fe(()=>{S();w();b();Lu=Object.assign(i(function(e){let t=Date.now(),s=Math.trunc(t/1e3),n=t%1e3*1e6;if(e){let o=s-e[0],a=n-e[0];return a<0&&(o=o-1,a=1e9+a),[o,a]}return[s,n]},"hrtime"),{bigint:i(function(){return BigInt(Date.now()*1e6)},"bigint")})});var Ht,Du=fe(()=>{S();w();b();Ht=class{static{i(this,"WriteStream")}fd;columns=80;rows=24;isTTY=!1;constructor(e){this.fd=e}clearLine(e,t){return t&&t(),!1}clearScreenDown(e){return e&&e(),!1}cursorTo(e,t,s){return s&&typeof s=="function"&&s(),!1}moveCursor(e,t,s){return s&&s(),!1}getColorDepth(e){return 1}hasColors(e,t){return!1}getWindowSize(){return[this.columns,this.rows]}write(e,t,s){e instanceof Uint8Array&&(e=new TextDecoder().decode(e));try{console.log(e)}catch{}return s&&typeof s=="function"&&s(),!1}}});var Cr,Bu=fe(()=>{S();w();b();Cr=class{static{i(this,"ReadStream")}fd;isRaw=!1;isTTY=!1;constructor(e){this.fd=e}setRawMode(e){return this.isRaw=e,this}}});var ku=fe(()=>{S();w();b();Bu();Du()});var Si,Fu=fe(()=>{S();w();b();Si="22.14.0"});import{EventEmitter as qu}from"node:events";var _s,Qu=fe(()=>{S();w();b();ku();ot();Fu();_s=class r extends qu{static{i(this,"Process")}env;hrtime;nextTick;constructor(e){super(),this.env=e.env,this.hrtime=e.hrtime,this.nextTick=e.nextTick;for(let t of[...Object.getOwnPropertyNames(r.prototype),...Object.getOwnPropertyNames(qu.prototype)]){let s=this[t];typeof s=="function"&&(this[t]=s.bind(this))}}emitWarning(e,t,s){console.warn(`${s?`[${s}] `:""}${t?`${t}: `:""}${e}`)}emit(...e){return super.emit(...e)}listeners(e){return super.listeners(e)}#t;#e;#r;get stdin(){return this.#t??=new Cr(0)}get stdout(){return this.#e??=new Ht(1)}get stderr(){return this.#r??=new Ht(2)}#i="/";chdir(e){this.#i=e}cwd(){return this.#i}arch="";platform="";argv=[];argv0="";execArgv=[];execPath="";title="";pid=200;ppid=100;get version(){return`v${Si}`}get versions(){return{node:Si}}get allowedNodeEnvironmentFlags(){return new Set}get sourceMapsEnabled(){return!1}get debugPort(){return 0}get throwDeprecation(){return!1}get traceDeprecation(){return!1}get features(){return{}}get release(){return{}}get connected(){return!1}get config(){return{}}get moduleLoadList(){return[]}constrainedMemory(){return 0}availableMemory(){return 0}uptime(){return 0}resourceUsage(){return{}}ref(){}unref(){}umask(){throw de("process.umask")}getBuiltinModule(){}getActiveResourcesInfo(){throw de("process.getActiveResourcesInfo")}exit(){throw de("process.exit")}reallyExit(){throw de("process.reallyExit")}kill(){throw de("process.kill")}abort(){throw de("process.abort")}dlopen(){throw de("process.dlopen")}setSourceMapsEnabled(){throw de("process.setSourceMapsEnabled")}loadEnvFile(){throw de("process.loadEnvFile")}disconnect(){throw de("process.disconnect")}cpuUsage(){throw de("process.cpuUsage")}setUncaughtExceptionCaptureCallback(){throw de("process.setUncaughtExceptionCaptureCallback")}hasUncaughtExceptionCaptureCallback(){throw de("process.hasUncaughtExceptionCaptureCallback")}initgroups(){throw de("process.initgroups")}openStdin(){throw de("process.openStdin")}assert(){throw de("process.assert")}binding(){throw de("process.binding")}permission={has:j("process.permission.has")};report={directory:"",filename:"",signal:"SIGUSR2",compact:!1,reportOnFatalError:!1,reportOnSignal:!1,reportOnUncaughtException:!1,getReport:j("process.report.getReport"),writeReport:j("process.report.writeReport")};finalization={register:j("process.finalization.register"),unregister:j("process.finalization.unregister"),registerBeforeExit:j("process.finalization.registerBeforeExit")};memoryUsage=Object.assign(()=>({arrayBuffers:0,rss:0,external:0,heapTotal:0,heapUsed:0}),{rss:i(()=>0,"rss")});mainModule=void 0;domain=void 0;send=void 0;exitCode=void 0;channel=void 0;getegid=void 0;geteuid=void 0;getgid=void 0;getgroups=void 0;getuid=void 0;setegid=void 0;seteuid=void 0;setgid=void 0;setgroups=void 0;setuid=void 0;_events=void 0;_eventsCount=void 0;_exiting=void 0;_maxListeners=void 0;_debugEnd=void 0;_debugProcess=void 0;_fatalException=void 0;_getActiveHandles=void 0;_getActiveRequests=void 0;_kill=void 0;_preload_modules=void 0;_rawDebug=void 0;_startProfilerIdleNotifier=void 0;_stopProfilerIdleNotifier=void 0;_tickCallback=void 0;_disconnect=void 0;_handleQueue=void 0;_pendingMessage=void 0;_channel=void 0;_send=void 0;_linkedBinding=void 0}});var Uu,$u,Yg,Jg,ju,Xg,Zg,eb,tb,rb,sb,nb,ib,ob,ab,cb,ub,lb,hb,fb,pb,db,mb,yb,gb,bb,wb,Sb,vb,_b,Eb,xb,Cb,Tb,Pb,Ab,Rb,Nb,Ob,Ib,Lb,Mb,Db,Bb,kb,Fb,qb,Qb,Ub,$b,jb,Hb,Vb,Kb,zb,Wb,Gb,Yb,Jb,Xb,Zb,e0,t0,r0,s0,n0,i0,o0,a0,c0,u0,l0,h0,f0,p0,d0,m0,y0,g0,b0,w0,S0,v0,_0,E0,x0,C0,T0,P0,A0,R0,N0,O0,I0,L0,M0,D0,B0,k0,F0,q0,Q0,U0,$0,j0,H0,V0,K0,z0,W0,Hu,Vu=fe(()=>{S();w();b();Mu();Qu();Uu=globalThis.process,$u=Uu.getBuiltinModule,{exit:Yg,platform:Jg,nextTick:ju}=$u("node:process"),Xg=new _s({env:Uu.env,hrtime:Lu,nextTick:ju}),{abort:Zg,addListener:eb,allowedNodeEnvironmentFlags:tb,hasUncaughtExceptionCaptureCallback:rb,setUncaughtExceptionCaptureCallback:sb,loadEnvFile:nb,sourceMapsEnabled:ib,arch:ob,argv:ab,argv0:cb,chdir:ub,config:lb,connected:hb,constrainedMemory:fb,availableMemory:pb,cpuUsage:db,cwd:mb,debugPort:yb,dlopen:gb,disconnect:bb,emit:wb,emitWarning:Sb,env:vb,eventNames:_b,execArgv:Eb,execPath:xb,finalization:Cb,features:Tb,getActiveResourcesInfo:Pb,getMaxListeners:Ab,hrtime:Rb,kill:Nb,listeners:Ob,listenerCount:Ib,memoryUsage:Lb,on:Mb,off:Db,once:Bb,pid:kb,ppid:Fb,prependListener:qb,prependOnceListener:Qb,rawListeners:Ub,release:$b,removeAllListeners:jb,removeListener:Hb,report:Vb,resourceUsage:Kb,setMaxListeners:zb,setSourceMapsEnabled:Wb,stderr:Gb,stdin:Yb,stdout:Jb,title:Xb,throwDeprecation:Zb,traceDeprecation:e0,umask:t0,uptime:r0,version:s0,versions:n0,domain:i0,initgroups:o0,moduleLoadList:a0,reallyExit:c0,openStdin:u0,assert:l0,binding:h0,send:f0,exitCode:p0,channel:d0,getegid:m0,geteuid:y0,getgid:g0,getgroups:b0,getuid:w0,setegid:S0,seteuid:v0,setgid:_0,setgroups:E0,setuid:x0,permission:C0,mainModule:T0,_events:P0,_eventsCount:A0,_exiting:R0,_maxListeners:N0,_debugEnd:O0,_debugProcess:I0,_fatalException:L0,_getActiveHandles:M0,_getActiveRequests:D0,_kill:B0,_preload_modules:k0,_rawDebug:F0,_startProfilerIdleNotifier:q0,_stopProfilerIdleNotifier:Q0,_tickCallback:U0,_disconnect:$0,_handleQueue:j0,_pendingMessage:H0,_channel:V0,_send:K0,_linkedBinding:z0}=Xg,W0={abort:Zg,addListener:eb,allowedNodeEnvironmentFlags:tb,hasUncaughtExceptionCaptureCallback:rb,setUncaughtExceptionCaptureCallback:sb,loadEnvFile:nb,sourceMapsEnabled:ib,arch:ob,argv:ab,argv0:cb,chdir:ub,config:lb,connected:hb,constrainedMemory:fb,availableMemory:pb,cpuUsage:db,cwd:mb,debugPort:yb,dlopen:gb,disconnect:bb,emit:wb,emitWarning:Sb,env:vb,eventNames:_b,execArgv:Eb,execPath:xb,exit:Yg,finalization:Cb,features:Tb,getBuiltinModule:$u,getActiveResourcesInfo:Pb,getMaxListeners:Ab,hrtime:Rb,kill:Nb,listeners:Ob,listenerCount:Ib,memoryUsage:Lb,nextTick:ju,on:Mb,off:Db,once:Bb,pid:kb,platform:Jg,ppid:Fb,prependListener:qb,prependOnceListener:Qb,rawListeners:Ub,release:$b,removeAllListeners:jb,removeListener:Hb,report:Vb,resourceUsage:Kb,setMaxListeners:zb,setSourceMapsEnabled:Wb,stderr:Gb,stdin:Yb,stdout:Jb,title:Xb,throwDeprecation:Zb,traceDeprecation:e0,umask:t0,uptime:r0,version:s0,versions:n0,domain:i0,initgroups:o0,moduleLoadList:a0,reallyExit:c0,openStdin:u0,assert:l0,binding:h0,send:f0,exitCode:p0,channel:d0,getegid:m0,geteuid:y0,getgid:g0,getgroups:b0,getuid:w0,setegid:S0,seteuid:v0,setgid:_0,setgroups:E0,setuid:x0,permission:C0,mainModule:T0,_events:P0,_eventsCount:A0,_exiting:R0,_maxListeners:N0,_debugEnd:O0,_debugProcess:I0,_fatalException:L0,_getActiveHandles:M0,_getActiveRequests:D0,_kill:B0,_preload_modules:k0,_rawDebug:F0,_startProfilerIdleNotifier:q0,_stopProfilerIdleNotifier:Q0,_tickCallback:U0,_disconnect:$0,_handleQueue:j0,_pendingMessage:H0,_channel:V0,_send:K0,_linkedBinding:z0},Hu=W0});var S=fe(()=>{Vu();globalThis.process=Hu});import yS from"events";var kt=te((R8,pf)=>{S();w();b();pf.exports=yS});var Ia=te(df=>{"use strict";S();w();b();df.parse=function(r,e){return new Oa(r,e).parse()};var Oa=class r{static{i(this,"ArrayParser")}constructor(e,t){this.source=e,this.transform=t||gS,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var e=this.source[this.position++];return e==="\\"?{value:this.source[this.position++],escaped:!0}:{value:e,escaped:!1}}record(e){this.recorded.push(e)}newEntry(e){var t;(this.recorded.length>0||e)&&(t=this.recorded.join(""),t==="NULL"&&!e&&(t=null),t!==null&&(t=this.transform(t)),this.entries.push(t),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var e=this.nextCharacter();if(e.value==="=")break}}parse(e){var t,s,n;for(this.consumeDimensions();!this.isEof();)if(t=this.nextCharacter(),t.value==="{"&&!n)this.dimension++,this.dimension>1&&(s=new r(this.source.substr(this.position-1),this.transform),this.entries.push(s.parse(!0)),this.position+=s.position-2);else if(t.value==="}"&&!n){if(this.dimension--,!this.dimension&&(this.newEntry(),e))return this.entries}else t.value==='"'&&!t.escaped?(n&&this.newEntry(!0),n=!n):t.value===","&&!n?this.newEntry():this.record(t.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};function gS(r){return r}i(gS,"identity")});var La=te((F8,mf)=>{S();w();b();var bS=Ia();mf.exports={create:i(function(r,e){return{parse:i(function(){return bS.parse(r,e)},"parse")}},"create")}});var bf=te((j8,gf)=>{"use strict";S();w();b();var wS=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,SS=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,vS=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,_S=/^-?infinity$/;gf.exports=i(function(e){if(_S.test(e))return Number(e.replace("i","I"));var t=wS.exec(e);if(!t)return ES(e)||null;var s=!!t[8],n=parseInt(t[1],10);s&&(n=yf(n));var o=parseInt(t[2],10)-1,a=t[3],c=parseInt(t[4],10),l=parseInt(t[5],10),d=parseInt(t[6],10),f=t[7];f=f?1e3*parseFloat(f):0;var v,y=xS(e);return y!=null?(v=new Date(Date.UTC(n,o,a,c,l,d,f)),Ma(n)&&v.setUTCFullYear(n),y!==0&&v.setTime(v.getTime()-y)):(v=new Date(n,o,a,c,l,d,f),Ma(n)&&v.setFullYear(n)),v},"parseDate");function ES(r){var e=SS.exec(r);if(e){var t=parseInt(e[1],10),s=!!e[4];s&&(t=yf(t));var n=parseInt(e[2],10)-1,o=e[3],a=new Date(t,n,o);return Ma(t)&&a.setFullYear(t),a}}i(ES,"getDate");function xS(r){if(r.endsWith("+00"))return 0;var e=vS.exec(r.split(" ")[1]);if(e){var t=e[1];if(t==="Z")return 0;var s=t==="-"?-1:1,n=parseInt(e[2],10)*3600+parseInt(e[3]||0,10)*60+parseInt(e[4]||0,10);return n*s*1e3}}i(xS,"timeZoneOffset");function yf(r){return-(r-1)}i(yf,"bcYearToNegativeYear");function Ma(r){return r>=0&&r<100}i(Ma,"is0To99")});var Sf=te((W8,wf)=>{S();w();b();wf.exports=TS;var CS=Object.prototype.hasOwnProperty;function TS(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)CS.call(t,s)&&(r[s]=t[s])}return r}i(TS,"extend")});var Ef=te((Z8,_f)=>{"use strict";S();w();b();var PS=Sf();_f.exports=or;function or(r){if(!(this instanceof or))return new or(r);PS(this,qS(r))}i(or,"PostgresInterval");var AS=["seconds","minutes","hours","days","months","years"];or.prototype.toPostgres=function(){var r=AS.filter(this.hasOwnProperty,this);return this.milliseconds&&r.indexOf("seconds")<0&&r.push("seconds"),r.length===0?"0":r.map(function(e){var t=this[e]||0;return e==="seconds"&&this.milliseconds&&(t=(t+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),t+" "+e},this).join(" ")};var RS={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},NS=["years","months","days"],OS=["hours","minutes","seconds"];or.prototype.toISOString=or.prototype.toISO=function(){var r=NS.map(t,this).join(""),e=OS.map(t,this).join("");return"P"+r+"T"+e;function t(s){var n=this[s]||0;return s==="seconds"&&this.milliseconds&&(n=(n+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),n+RS[s]}};var Da="([+-]?\\d+)",IS=Da+"\\s+years?",LS=Da+"\\s+mons?",MS=Da+"\\s+days?",DS="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",BS=new RegExp([IS,LS,MS,DS].map(function(r){return"("+r+")?"}).join("\\s*")),vf={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},kS=["hours","minutes","seconds","milliseconds"];function FS(r){var e=r+"000000".slice(r.length);return parseInt(e,10)/1e3}i(FS,"parseMilliseconds");function qS(r){if(!r)return{};var e=BS.exec(r),t=e[8]==="-";return Object.keys(vf).reduce(function(s,n){var o=vf[n],a=e[o];return!a||(a=n==="milliseconds"?FS(a):parseInt(a,10),!a)||(t&&~kS.indexOf(n)&&(a*=-1),s[n]=a),s},{})}i(qS,"parse")});var Cf=te((nF,xf)=>{"use strict";S();w();b();xf.exports=i(function(e){if(/^\\x/.test(e))return new Buffer(e.substr(2),"hex");for(var t="",s=0;s<e.length;)if(e[s]!=="\\")t+=e[s],++s;else if(/[0-7]{3}/.test(e.substr(s+1,3)))t+=String.fromCharCode(parseInt(e.substr(s+1,3),8)),s+=4;else{for(var n=1;s+n<e.length&&e[s+n]==="\\";)n++;for(var o=0;o<Math.floor(n/2);++o)t+="\\";s+=Math.floor(n/2)*2}return new Buffer(t,"binary")},"parseBytea")});var If=te((uF,Of)=>{S();w();b();var Zr=Ia(),es=La(),cn=bf(),Pf=Ef(),Af=Cf();function un(r){return i(function(t){return t===null?t:r(t)},"nullAllowed")}i(un,"allowNull");function Rf(r){return r===null?r:r==="TRUE"||r==="t"||r==="true"||r==="y"||r==="yes"||r==="on"||r==="1"}i(Rf,"parseBool");function QS(r){return r?Zr.parse(r,Rf):null}i(QS,"parseBoolArray");function US(r){return parseInt(r,10)}i(US,"parseBaseTenInt");function Ba(r){return r?Zr.parse(r,un(US)):null}i(Ba,"parseIntegerArray");function $S(r){return r?Zr.parse(r,un(function(e){return Nf(e).trim()})):null}i($S,"parseBigIntegerArray");var jS=i(function(r){if(!r)return null;var e=es.create(r,function(t){return t!==null&&(t=Qa(t)),t});return e.parse()},"parsePointArray"),ka=i(function(r){if(!r)return null;var e=es.create(r,function(t){return t!==null&&(t=parseFloat(t)),t});return e.parse()},"parseFloatArray"),rt=i(function(r){if(!r)return null;var e=es.create(r);return e.parse()},"parseStringArray"),Fa=i(function(r){if(!r)return null;var e=es.create(r,function(t){return t!==null&&(t=cn(t)),t});return e.parse()},"parseDateArray"),HS=i(function(r){if(!r)return null;var e=es.create(r,function(t){return t!==null&&(t=Pf(t)),t});return e.parse()},"parseIntervalArray"),VS=i(function(r){return r?Zr.parse(r,un(Af)):null},"parseByteAArray"),qa=i(function(r){return parseInt(r,10)},"parseInteger"),Nf=i(function(r){var e=String(r);return/^\d+$/.test(e)?e:r},"parseBigInteger"),Tf=i(function(r){return r?Zr.parse(r,un(JSON.parse)):null},"parseJsonArray"),Qa=i(function(r){return r[0]!=="("?null:(r=r.substring(1,r.length-1).split(","),{x:parseFloat(r[0]),y:parseFloat(r[1])})},"parsePoint"),KS=i(function(r){if(r[0]!=="<"&&r[1]!=="(")return null;for(var e="(",t="",s=!1,n=2;n<r.length-1;n++){if(s||(e+=r[n]),r[n]===")"){s=!0;continue}else if(!s)continue;r[n]!==","&&(t+=r[n])}var o=Qa(e);return o.radius=parseFloat(t),o},"parseCircle"),zS=i(function(r){r(20,Nf),r(21,qa),r(23,qa),r(26,qa),r(700,parseFloat),r(701,parseFloat),r(16,Rf),r(1082,cn),r(1114,cn),r(1184,cn),r(600,Qa),r(651,rt),r(718,KS),r(1e3,QS),r(1001,VS),r(1005,Ba),r(1007,Ba),r(1028,Ba),r(1016,$S),r(1017,jS),r(1021,ka),r(1022,ka),r(1231,ka),r(1014,rt),r(1015,rt),r(1008,rt),r(1009,rt),r(1040,rt),r(1041,rt),r(1115,Fa),r(1182,Fa),r(1185,Fa),r(1186,Pf),r(1187,HS),r(17,Af),r(114,JSON.parse.bind(JSON)),r(3802,JSON.parse.bind(JSON)),r(199,Tf),r(3807,Tf),r(3907,rt),r(2951,rt),r(791,rt),r(1183,rt),r(1270,rt)},"init");Of.exports={init:zS}});var Mf=te((dF,Lf)=>{"use strict";S();w();b();var Ye=1e6;function WS(r){var e=r.readInt32BE(0),t=r.readUInt32BE(4),s="";e<0&&(e=~e+(t===0),t=~t+1>>>0,s="-");var n="",o,a,c,l,d,f;{if(o=e%Ye,e=e/Ye>>>0,a=4294967296*o+t,t=a/Ye>>>0,c=""+(a-Ye*t),t===0&&e===0)return s+c+n;for(l="",d=6-c.length,f=0;f<d;f++)l+="0";n=l+c+n}{if(o=e%Ye,e=e/Ye>>>0,a=4294967296*o+t,t=a/Ye>>>0,c=""+(a-Ye*t),t===0&&e===0)return s+c+n;for(l="",d=6-c.length,f=0;f<d;f++)l+="0";n=l+c+n}{if(o=e%Ye,e=e/Ye>>>0,a=4294967296*o+t,t=a/Ye>>>0,c=""+(a-Ye*t),t===0&&e===0)return s+c+n;for(l="",d=6-c.length,f=0;f<d;f++)l+="0";n=l+c+n}return o=e%Ye,a=4294967296*o+t,c=""+a%Ye,s+c+n}i(WS,"readInt8");Lf.exports=WS});var qf=te((wF,Ff)=>{S();w();b();var GS=Mf(),Te=i(function(r,e,t,s,n){t=t||0,s=s||!1,n=n||function(x,m,h){return x*Math.pow(2,h)+m};var o=t>>3,a=i(function(x){return s?~x&255:x},"inv"),c=255,l=8-t%8;e<l&&(c=255<<8-e&255,l=e),t&&(c=c>>t%8);var d=0;t%8+e>=8&&(d=n(0,a(r[o])&c,l));for(var f=e+t>>3,v=o+1;v<f;v++)d=n(d,a(r[v]),8);var y=(e+t)%8;return y>0&&(d=n(d,a(r[f])>>8-y,y)),d},"parseBits"),kf=i(function(r,e,t){var s=Math.pow(2,t-1)-1,n=Te(r,1),o=Te(r,t,1);if(o===0)return 0;var a=1,c=i(function(d,f,v){d===0&&(d=1);for(var y=1;y<=v;y++)a/=2,(f&1<<v-y)>0&&(d+=a);return d},"parsePrecisionBits"),l=Te(r,e,t+1,!1,c);return o==Math.pow(2,t+1)-1?l===0?n===0?1/0:-1/0:NaN:(n===0?1:-1)*Math.pow(2,o-s)*l},"parseFloatFromBits"),YS=i(function(r){return Te(r,1)==1?-1*(Te(r,15,1,!0)+1):Te(r,15,1)},"parseInt16"),Df=i(function(r){return Te(r,1)==1?-1*(Te(r,31,1,!0)+1):Te(r,31,1)},"parseInt32"),JS=i(function(r){return kf(r,23,8)},"parseFloat32"),XS=i(function(r){return kf(r,52,11)},"parseFloat64"),ZS=i(function(r){var e=Te(r,16,32);if(e==49152)return NaN;for(var t=Math.pow(1e4,Te(r,16,16)),s=0,n=[],o=Te(r,16),a=0;a<o;a++)s+=Te(r,16,64+16*a)*t,t/=1e4;var c=Math.pow(10,Te(r,16,48));return(e===0?1:-1)*Math.round(s*c)/c},"parseNumeric"),Bf=i(function(r,e){var t=Te(e,1),s=Te(e,63,1),n=new Date((t===0?1:-1)*s/1e3+9466848e5);return r||n.setTime(n.getTime()+n.getTimezoneOffset()*6e4),n.usec=s%1e3,n.getMicroSeconds=function(){return this.usec},n.setMicroSeconds=function(o){this.usec=o},n.getUTCMicroSeconds=function(){return this.usec},n},"parseDate"),ts=i(function(r){for(var e=Te(r,32),t=Te(r,32,32),s=Te(r,32,64),n=96,o=[],a=0;a<e;a++)o[a]=Te(r,32,n),n+=32,n+=32;var c=i(function(d){var f=Te(r,32,n);if(n+=32,f==4294967295)return null;var v;if(d==23||d==20)return v=Te(r,f*8,n),n+=f*8,v;if(d==25)return v=r.toString(this.encoding,n>>3,(n+=f<<3)>>3),v;console.log("ERROR: ElementType not implemented: "+d)},"parseElement"),l=i(function(d,f){var v=[],y;if(d.length>1){var x=d.shift();for(y=0;y<x;y++)v[y]=l(d,f);d.unshift(x)}else for(y=0;y<d[0];y++)v[y]=c(f);return v},"parse");return l(o,s)},"parseArray"),e1=i(function(r){return r.toString("utf8")},"parseText"),t1=i(function(r){return r===null?null:Te(r,8)>0},"parseBool"),r1=i(function(r){r(20,GS),r(21,YS),r(23,Df),r(26,Df),r(1700,ZS),r(700,JS),r(701,XS),r(16,t1),r(1114,Bf.bind(null,!1)),r(1184,Bf.bind(null,!0)),r(1e3,ts),r(1007,ts),r(1016,ts),r(1008,ts),r(1009,ts),r(25,e1)},"init");Ff.exports={init:r1}});var Uf=te((xF,Qf)=>{S();w();b();Qf.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var ns=te(ss=>{S();w();b();var s1=If(),n1=qf(),i1=La(),o1=Uf();ss.getTypeParser=a1;ss.setTypeParser=c1;ss.arrayParser=i1;ss.builtins=o1;var rs={text:{},binary:{}};function $f(r){return String(r)}i($f,"noParse");function a1(r,e){return e=e||"text",rs[e]&&rs[e][r]||$f}i(a1,"getTypeParser");function c1(r,e,t){typeof e=="function"&&(t=e,e="text"),rs[e][r]=t}i(c1,"setTypeParser");s1.init(function(r,e){rs.text[r]=e});n1.init(function(r,e){rs.binary[r]=e})});var is=te((LF,Ua)=>{"use strict";S();w();b();Ua.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var ar=ns(),u1=ar.getTypeParser(20,"text"),l1=ar.getTypeParser(1016,"text");Ua.exports.__defineSetter__("parseInt8",function(r){ar.setTypeParser(20,"text",r?ar.getTypeParser(23,"text"):u1),ar.setTypeParser(1016,"text",r?ar.getTypeParser(1007,"text"):l1)})});var jf,Hf,Vf,Kf,zf,Wf,Gf,Yf,Jf,Xf,Zf,ep,tp,rp,sp=fe(()=>{S();w();b();jf=i(r=>r instanceof RegExp,"isRegExp"),Hf=i(r=>r instanceof Date,"isDate"),Vf=i(r=>typeof r=="boolean","isBoolean"),Kf=i(r=>r===null,"isNull"),zf=i(r=>r==null,"isNullOrUndefined"),Wf=i(r=>typeof r=="number","isNumber"),Gf=i(r=>typeof r=="string","isString"),Yf=i(r=>typeof r=="symbol","isSymbol"),Jf=i(r=>r===void 0,"isUndefined"),Xf=i(r=>typeof r=="function","isFunction"),Zf=i(r=>r&&typeof r=="object"&&typeof r.copy=="function"&&typeof r.fill=="function"&&typeof r.readUInt8=="function","isBuffer"),ep=i(r=>r!==null&&typeof r=="object"&&Object.getPrototypeOf(r).isPrototypeOf(Object),"isObject"),tp=i(r=>r instanceof Error,"isError"),rp=i(r=>typeof r=="object"?r===null:typeof r!="function","isPrimitive")});var np=fe(()=>{S();w();b()});import WF from"node:util/types";import{default as iq}from"node:util/types";var YF,JF,ip,op,ap,cp,up,lp,hp=fe(()=>{S();w();b();ot();sp();np();YF=globalThis.TextDecoder,JF=globalThis.TextEncoder,ip=j("util._errnoException"),op=j("util._exceptionWithHostPort"),ap=j("util.getSystemErrorMap"),cp=j("util.getSystemErrorName"),up=j("util.parseEnv"),lp=j("util.styleText")});var fp,h1,f1,p1,d1,m1,y1,g1,b1,w1,S1,v1,_1,E1,x1,C1,T1,P1,A1,R1,N1,O1,I1,L1,M1,D1,pp,dp=fe(()=>{S();w();b();hp();fp=process.getBuiltinModule("node:util"),{MIMEParams:h1,MIMEType:f1,TextDecoder:p1,TextEncoder:d1,_extend:m1,aborted:y1,callbackify:g1,debug:b1,debuglog:w1,deprecate:S1,format:v1,formatWithOptions:_1,getCallSite:E1,inherits:x1,inspect:C1,isArray:T1,isDeepStrictEqual:P1,log:A1,parseArgs:R1,promisify:N1,stripVTControlCharacters:O1,toUSVString:I1,transferableAbortController:L1,transferableAbortSignal:M1}=fp,D1=fp.types,pp={_errnoException:ip,_exceptionWithHostPort:op,getSystemErrorMap:ap,getSystemErrorName:cp,isBoolean:Vf,isBuffer:Zf,isDate:Hf,isError:tp,isFunction:Xf,isNull:Kf,isNullOrUndefined:zf,isNumber:Wf,isObject:ep,isPrimitive:rp,isRegExp:jf,isString:Gf,isSymbol:Yf,isUndefined:Jf,parseEnv:up,styleText:lp,_extend:m1,aborted:y1,callbackify:g1,debug:b1,debuglog:w1,deprecate:S1,format:v1,formatWithOptions:_1,getCallSite:E1,inherits:x1,inspect:C1,isArray:T1,isDeepStrictEqual:P1,log:A1,MIMEParams:h1,MIMEType:f1,parseArgs:R1,promisify:N1,stripVTControlCharacters:O1,TextDecoder:p1,TextEncoder:d1,toUSVString:I1,transferableAbortController:L1,transferableAbortSignal:M1,types:D1}});var os=te((pq,mp)=>{S();w();b();dp();mp.exports=pp});var cr=te((gq,bp)=>{"use strict";S();w();b();var B1=is(),yp=os(),{isDate:k1}=yp.types||yp;function F1(r){return'"'+r.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'}i(F1,"escapeElement");function gp(r){let e="{";for(let t=0;t<r.length;t++)if(t>0&&(e=e+","),r[t]===null||typeof r[t]>"u")e=e+"NULL";else if(Array.isArray(r[t]))e=e+gp(r[t]);else if(ArrayBuffer.isView(r[t])){let s=r[t];if(!(s instanceof Buffer)){let n=Buffer.from(s.buffer,s.byteOffset,s.byteLength);n.length===s.byteLength?s=n:s=n.slice(s.byteOffset,s.byteOffset+s.byteLength)}e+="\\\\x"+s.toString("hex")}else e+=F1(ln(r[t]));return e=e+"}",e}i(gp,"arrayString");var ln=i(function(r,e){if(r==null)return null;if(typeof r=="object"){if(r instanceof Buffer)return r;if(ArrayBuffer.isView(r)){let t=Buffer.from(r.buffer,r.byteOffset,r.byteLength);return t.length===r.byteLength?t:t.slice(r.byteOffset,r.byteOffset+r.byteLength)}return k1(r)?B1.parseInputDatesAsUTC?U1(r):Q1(r):Array.isArray(r)?gp(r):q1(r,e)}return r.toString()},"prepareValue");function q1(r,e){if(r&&typeof r.toPostgres=="function"){if(e=e||[],e.indexOf(r)!==-1)throw new Error('circular reference detected while preparing "'+r+'" for query');return e.push(r),ln(r.toPostgres(ln),e)}return JSON.stringify(r)}i(q1,"prepareObject");function Q1(r){let e=-r.getTimezoneOffset(),t=r.getFullYear(),s=t<1;s&&(t=Math.abs(t)+1);let n=String(t).padStart(4,"0")+"-"+String(r.getMonth()+1).padStart(2,"0")+"-"+String(r.getDate()).padStart(2,"0")+"T"+String(r.getHours()).padStart(2,"0")+":"+String(r.getMinutes()).padStart(2,"0")+":"+String(r.getSeconds()).padStart(2,"0")+"."+String(r.getMilliseconds()).padStart(3,"0");return e<0?(n+="-",e*=-1):n+="+",n+=String(Math.floor(e/60)).padStart(2,"0")+":"+String(e%60).padStart(2,"0"),s&&(n+=" BC"),n}i(Q1,"dateToString");function U1(r){let e=r.getUTCFullYear(),t=e<1;t&&(e=Math.abs(e)+1);let s=String(e).padStart(4,"0")+"-"+String(r.getUTCMonth()+1).padStart(2,"0")+"-"+String(r.getUTCDate()).padStart(2,"0")+"T"+String(r.getUTCHours()).padStart(2,"0")+":"+String(r.getUTCMinutes()).padStart(2,"0")+":"+String(r.getUTCSeconds()).padStart(2,"0")+"."+String(r.getUTCMilliseconds()).padStart(3,"0");return s+="+00:00",t&&(s+=" BC"),s}i(U1,"dateToStringUTC");function $1(r,e,t){return r=typeof r=="string"?{text:r}:r,e&&(typeof e=="function"?r.callback=e:r.values=e),t&&(r.callback=t),r}i($1,"normalizeQueryConfig");var j1=i(function(r){return'"'+r.replace(/"/g,'""')+'"'},"escapeIdentifier"),H1=i(function(r){let e=!1,t="'";if(r==null||typeof r!="string")return"''";for(let s=0;s<r.length;s++){let n=r[s];n==="'"?t+=n+n:n==="\\"?(t+=n+n,e=!0):t+=n}return t+="'",e===!0&&(t=" E"+t),t},"escapeLiteral");bp.exports={prepareValue:i(function(e){return ln(e)},"prepareValueWrapper"),normalizeQueryConfig:$1,escapeIdentifier:j1,escapeLiteral:H1}});var _q,wp=fe(()=>{S();w();b();_q=globalThis.crypto?.subtle});var Sp,vp,_p,Ep,xp,Cp,Tp=fe(()=>{S();w();b();ot();Sp=new Proxy(globalThis.crypto,{get(r,e){return e==="CryptoKey"?globalThis.CryptoKey:typeof globalThis.crypto[e]=="function"?globalThis.crypto[e].bind(globalThis.crypto):globalThis.crypto[e]}}),vp=j("crypto.createCipher"),_p=j("crypto.createDecipher"),Ep=j("crypto.pseudoRandomBytes"),xp=it("crypto.Cipher"),Cp=it("crypto.Decipher")});var Pp=fe(()=>{S();w();b();wp();Tp()});var V1,K1,z1,W1,G1,Y1,J1,X1,Z1,ev,tv,rv,sv,nv,iv,ov,av,cv,uv,lv,hv,fv,pv,dv,mv,yv,gv,bv,wv,Sv,vv,_v,Ev,xv,Cv,Tv,Ap,Pv,Av,Rv,Nv,Ov,Iv,Lv,Mv,Dv,Bv,kv,Fv,qv,Qv,Uv,$v,Rp,jv,Hv,Vv,Kv,zv,Wv,Gv,Np,Yv,Jv,Xv,Zv,e_,Op,Ip=fe(()=>{S();w();b();Pp();V1=process.getBuiltinModule("node:crypto"),{Certificate:K1,checkPrime:z1,checkPrimeSync:W1,constants:G1,Cipheriv:Y1,createCipheriv:J1,createDecipheriv:X1,createDiffieHellman:Z1,createDiffieHellmanGroup:ev,createECDH:tv,createHash:rv,createHmac:sv,createPrivateKey:nv,createPublicKey:iv,createSecretKey:ov,createSign:av,createVerify:cv,Decipheriv:uv,diffieHellman:lv,DiffieHellman:hv,DiffieHellmanGroup:fv,ECDH:pv,fips:dv,generateKey:mv,generateKeyPair:yv,generateKeyPairSync:gv,generateKeySync:bv,generatePrime:wv,generatePrimeSync:Sv,getCipherInfo:vv,getCiphers:_v,getCurves:Ev,getDiffieHellman:xv,getFips:Cv,getHashes:Tv,getRandomValues:Ap,hash:Pv,Hash:Av,hkdf:Rv,hkdfSync:Nv,Hmac:Ov,KeyObject:Iv,pbkdf2:Lv,pbkdf2Sync:Mv,privateDecrypt:Dv,privateEncrypt:Bv,publicDecrypt:kv,publicEncrypt:Fv,randomBytes:qv,randomFill:Qv,randomFillSync:Uv,randomInt:$v,randomUUID:Rp,scrypt:jv,scryptSync:Hv,secureHeapUsed:Vv,setEngine:Kv,setFips:zv,sign:Wv,Sign:Gv,subtle:Np,timingSafeEqual:Yv,verify:Jv,Verify:Xv,X509Certificate:Zv}=V1,e_={CryptoKey:Sp.CryptoKey,getRandomValues:Ap,randomUUID:Rp,subtle:Np},Op={Certificate:K1,Cipher:xp,Cipheriv:Y1,Decipher:Cp,Decipheriv:uv,ECDH:pv,Sign:Gv,Verify:Xv,X509Certificate:Zv,constants:G1,createCipheriv:J1,createDecipheriv:X1,createECDH:tv,createSign:av,createVerify:cv,diffieHellman:lv,getCipherInfo:vv,hash:Pv,privateDecrypt:Dv,privateEncrypt:Bv,publicDecrypt:kv,publicEncrypt:Fv,scrypt:jv,scryptSync:Hv,sign:Wv,verify:Jv,createCipher:vp,createDecipher:_p,pseudoRandomBytes:Ep,DiffieHellman:hv,DiffieHellmanGroup:fv,Hash:Av,Hmac:Ov,KeyObject:Iv,checkPrime:z1,checkPrimeSync:W1,createDiffieHellman:Z1,createDiffieHellmanGroup:ev,createHash:rv,createHmac:sv,createPrivateKey:nv,createPublicKey:iv,createSecretKey:ov,generateKey:mv,generateKeyPair:yv,generateKeyPairSync:gv,generateKeySync:bv,generatePrime:wv,generatePrimeSync:Sv,getCiphers:_v,getCurves:Ev,getDiffieHellman:xv,getFips:Cv,getHashes:Tv,getRandomValues:Ap,hkdf:Rv,hkdfSync:Nv,pbkdf2:Lv,pbkdf2Sync:Mv,randomBytes:qv,randomFill:Qv,randomFillSync:Uv,randomInt:$v,randomUUID:Rp,secureHeapUsed:Vv,setEngine:Kv,setFips:zv,subtle:Np,timingSafeEqual:Yv,fips:dv,webcrypto:e_}});var $a=te((Kq,Lp)=>{S();w();b();Ip();Lp.exports=Op});var Dp=te((Yq,Mp)=>{"use strict";S();w();b();var ur=$a();function ja(r){return ur.createHash("md5").update(r,"utf-8").digest("hex")}i(ja,"md5");function t_(r,e,t){let s=ja(e+r);return"md5"+ja(Buffer.concat([Buffer.from(s),t]))}i(t_,"postgresMd5PasswordHash");function r_(r){return ur.createHash("sha256").update(r).digest()}i(r_,"sha256");function s_(r,e){return r=r.replace(/(\D)-/,"$1"),ur.createHash(r).update(e).digest()}i(s_,"hashByName");function n_(r,e){return ur.createHmac("sha256",r).update(e).digest()}i(n_,"hmacSha256");async function i_(r,e,t){return ur.pbkdf2Sync(r,e,t,32,"sha256")}i(i_,"deriveKey");Mp.exports={postgresMd5PasswordHash:t_,randomBytes:ur.randomBytes,deriveKey:i_,sha256:r_,hashByName:s_,hmacSha256:n_,md5:ja}});var qp=te((tQ,Fp)=>{S();w();b();var Bp=$a();Fp.exports={postgresMd5PasswordHash:a_,randomBytes:o_,deriveKey:h_,sha256:c_,hashByName:u_,hmacSha256:l_,md5:Ha};var kp=Bp.webcrypto||globalThis.crypto,Ft=kp.subtle,Va=new TextEncoder;function o_(r){return kp.getRandomValues(Buffer.alloc(r))}i(o_,"randomBytes");async function Ha(r){try{return Bp.createHash("md5").update(r,"utf-8").digest("hex")}catch{let t=typeof r=="string"?Va.encode(r):r,s=await Ft.digest("MD5",t);return Array.from(new Uint8Array(s)).map(n=>n.toString(16).padStart(2,"0")).join("")}}i(Ha,"md5");async function a_(r,e,t){let s=await Ha(e+r);return"md5"+await Ha(Buffer.concat([Buffer.from(s),t]))}i(a_,"postgresMd5PasswordHash");async function c_(r){return await Ft.digest("SHA-256",r)}i(c_,"sha256");async function u_(r,e){return await Ft.digest(r,e)}i(u_,"hashByName");async function l_(r,e){let t=await Ft.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await Ft.sign("HMAC",t,Va.encode(e))}i(l_,"hmacSha256");async function h_(r,e,t){let s=await Ft.importKey("raw",Va.encode(r),"PBKDF2",!1,["deriveBits"]),n={name:"PBKDF2",hash:"SHA-256",salt:e,iterations:t};return await Ft.deriveBits(n,s,32*8,["deriveBits"])}i(h_,"deriveKey")});var za=te((oQ,Ka)=>{"use strict";S();w();b();var f_=parseInt(process.versions&&process.versions.node&&process.versions.node.split(".")[0])<15;f_?Ka.exports=Dp():Ka.exports=qp()});var $p=te((lQ,Up)=>{S();w();b();function qt(r,e){return new Error("SASL channel binding: "+r+" when parsing public certificate "+e.toString("base64"))}i(qt,"x509Error");function Wa(r,e){let t=r[e++];if(t<128)return{length:t,index:e};let s=t&127;if(s>4)throw qt("bad length",r);t=0;for(let n=0;n<s;n++)t=t<<8|r[e++];return{length:t,index:e}}i(Wa,"readASN1Length");function Qp(r,e){if(r[e++]!==6)throw qt("non-OID data",r);let{length:t,index:s}=Wa(r,e);e=s;let n=e+t,o=r[e++],a=(o/40>>0)+"."+o%40;for(;e<n;){let c=0;for(;e<n;){let l=r[e++];if(c=c<<7|l&127,l<128)break}a+="."+c}return{oid:a,index:e}}i(Qp,"readASN1OID");function as(r,e){if(r[e++]!==48)throw qt("non-sequence data",r);return Wa(r,e)}i(as,"expectASN1Seq");function p_(r,e){e===void 0&&(e=0),e=as(r,e).index;let{length:t,index:s}=as(r,e);e=s+t,e=as(r,e).index;let{oid:n,index:o}=Qp(r,e);switch(n){case"1.2.840.113549.1.1.4":return"MD5";case"1.2.840.113549.1.1.5":return"SHA-1";case"1.2.840.113549.1.1.11":return"SHA-256";case"1.2.840.113549.1.1.12":return"SHA-384";case"1.2.840.113549.1.1.13":return"SHA-512";case"1.2.840.113549.1.1.14":return"SHA-224";case"1.2.840.113549.1.1.15":return"SHA512-224";case"1.2.840.113549.1.1.16":return"SHA512-256";case"1.2.840.10045.4.1":return"SHA-1";case"1.2.840.10045.4.3.1":return"SHA-224";case"1.2.840.10045.4.3.2":return"SHA-256";case"1.2.840.10045.4.3.3":return"SHA-384";case"1.2.840.10045.4.3.4":return"SHA-512";case"1.2.840.113549.1.1.10":{if(e=o,e=as(r,e).index,r[e++]!==160)throw qt("non-tag data",r);e=Wa(r,e).index,e=as(r,e).index;let{oid:a}=Qp(r,e);switch(a){case"1.2.840.113549.2.5":return"MD5";case"1.3.14.3.2.26":return"SHA-1";case"2.16.840.1.101.3.4.2.1":return"SHA-256";case"2.16.840.1.101.3.4.2.2":return"SHA-384";case"2.16.840.1.101.3.4.2.3":return"SHA-512"}throw qt("unknown hash OID "+a,r)}case"1.3.101.110":case"1.3.101.112":return"SHA-512";case"1.3.101.111":case"1.3.101.113":throw qt("Ed448 certificate channel binding is not currently supported by Postgres")}throw qt("unknown OID "+n,r)}i(p_,"signatureAlgorithmHashFromCertificate");Up.exports={signatureAlgorithmHashFromCertificate:p_}});var Kp=te((mQ,Vp)=>{"use strict";S();w();b();var Ct=za(),{signatureAlgorithmHashFromCertificate:d_}=$p();function m_(r,e){let t=["SCRAM-SHA-256"];e&&t.unshift("SCRAM-SHA-256-PLUS");let s=t.find(a=>r.includes(a));if(!s)throw new Error("SASL: Only mechanism(s) "+t.join(" and ")+" are supported");if(s==="SCRAM-SHA-256-PLUS"&&typeof e.getPeerCertificate!="function")throw new Error("SASL: Mechanism SCRAM-SHA-256-PLUS requires a certificate");let n=Ct.randomBytes(18).toString("base64");return{mechanism:s,clientNonce:n,response:(s==="SCRAM-SHA-256-PLUS"?"p=tls-server-end-point":e?"y":"n")+",,n=*,r="+n,message:"SASLInitialResponse"}}i(m_,"startSession");async function y_(r,e,t,s){if(r.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(e==="")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof t!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let n=w_(t);if(n.nonce.startsWith(r.clientNonce)){if(n.nonce.length===r.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");let o="n=*,r="+r.clientNonce,a="r="+n.nonce+",s="+n.salt+",i="+n.iteration,c=s?"eSws":"biws";if(r.mechanism==="SCRAM-SHA-256-PLUS"){let P=s.getPeerCertificate().raw,A=d_(P);(A==="MD5"||A==="SHA-1")&&(A="SHA-256");let B=await Ct.hashByName(A,P);c=Buffer.concat([Buffer.from("p=tls-server-end-point,,"),Buffer.from(B)]).toString("base64")}let l="c="+c+",r="+n.nonce,d=o+","+a+","+l,f=Buffer.from(n.salt,"base64"),v=await Ct.deriveKey(e,f,n.iteration),y=await Ct.hmacSha256(v,"Client Key"),x=await Ct.sha256(y),m=await Ct.hmacSha256(x,d),h=v_(Buffer.from(y),Buffer.from(m)).toString("base64"),E=await Ct.hmacSha256(v,"Server Key"),C=await Ct.hmacSha256(E,d);r.message="SASLResponse",r.serverSignature=Buffer.from(C).toString("base64"),r.response=l+",p="+h}i(y_,"continueSession");function g_(r,e){if(r.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof e!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:t}=S_(e);if(t!==r.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}i(g_,"finalizeSession");function b_(r){if(typeof r!="string")throw new TypeError("SASL: text must be a string");return r.split("").map((e,t)=>r.charCodeAt(t)).every(e=>e>=33&&e<=43||e>=45&&e<=126)}i(b_,"isPrintableChars");function jp(r){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(r)}i(jp,"isBase64");function Hp(r){if(typeof r!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(r.split(",").map(e=>{if(!/^.=/.test(e))throw new Error("SASL: Invalid attribute pair entry");let t=e[0],s=e.substring(2);return[t,s]}))}i(Hp,"parseAttributePairs");function w_(r){let e=Hp(r),t=e.get("r");if(t){if(!b_(t))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let s=e.get("s");if(s){if(!jp(s))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let n=e.get("i");if(n){if(!/^[1-9][0-9]*$/.test(n))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let o=parseInt(n,10);return{nonce:t,salt:s,iteration:o}}i(w_,"parseServerFirstMessage");function S_(r){let t=Hp(r).get("v");if(t){if(!jp(t))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:t}}i(S_,"parseServerFinalMessage");function v_(r,e){if(!Buffer.isBuffer(r))throw new TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(e))throw new TypeError("second argument must be a Buffer");if(r.length!==e.length)throw new Error("Buffer lengths must match");if(r.length===0)throw new Error("Buffers cannot be empty");return Buffer.from(r.map((t,s)=>r[s]^e[s]))}i(v_,"xorBuffers");Vp.exports={startSession:m_,continueSession:y_,finalizeSession:g_}});var fn=te((SQ,zp)=>{"use strict";S();w();b();var __=ns();function hn(r){this._types=r||__,this.text={},this.binary={}}i(hn,"TypeOverrides");hn.prototype.getOverrides=function(r){switch(r){case"text":return this.text;case"binary":return this.binary;default:return{}}};hn.prototype.setTypeParser=function(r,e,t){typeof e=="function"&&(t=e,e="text"),this.getOverrides(e)[r]=t};hn.prototype.getTypeParser=function(r,e){return e=e||"text",this.getOverrides(e)[r]||this._types.getTypeParser(r,e)};zp.exports=hn});import E_ from"dns";var Gp=te((TQ,Wp)=>{S();w();b();Wp.exports=E_});var pn,dn,mn,yn,gn,bn,wn,Sn,vn,_n,En,xn,Cn,Tn,Pn,An,Rn,Nn,On,In,Ln,Mn,Dn,Bn,kn,Fn,qn,Qn,Yp,Un,Jp,$n=fe(()=>{S();w();b();ot();pn=j("fs.access"),dn=j("fs.copyFile"),mn=j("fs.cp"),yn=j("fs.open"),gn=j("fs.opendir"),bn=j("fs.rename"),wn=j("fs.truncate"),Sn=j("fs.rm"),vn=j("fs.rmdir"),_n=j("fs.mkdir"),En=j("fs.readdir"),xn=j("fs.readlink"),Cn=j("fs.symlink"),Tn=j("fs.lstat"),Pn=j("fs.stat"),An=j("fs.link"),Rn=j("fs.unlink"),Nn=j("fs.chmod"),On=j("fs.lchmod"),In=j("fs.lchown"),Ln=j("fs.chown"),Mn=j("fs.utimes"),Dn=j("fs.lutimes"),Bn=j("fs.realpath"),kn=j("fs.mkdtemp"),Fn=j("fs.writeFile"),qn=j("fs.appendFile"),Qn=j("fs.readFile"),Yp=j("fs.watch"),Un=j("fs.statfs"),Jp=j("fs.glob")});var cs={};Hg(cs,{COPYFILE_EXCL:()=>SE,COPYFILE_FICLONE:()=>_E,COPYFILE_FICLONE_FORCE:()=>xE,EXTENSIONLESS_FORMAT_JAVASCRIPT:()=>F_,EXTENSIONLESS_FORMAT_WASM:()=>q_,F_OK:()=>Xp,O_APPEND:()=>Z_,O_CREAT:()=>W_,O_DIRECT:()=>iE,O_DIRECTORY:()=>eE,O_DSYNC:()=>nE,O_EXCL:()=>G_,O_NOATIME:()=>tE,O_NOCTTY:()=>J_,O_NOFOLLOW:()=>rE,O_NONBLOCK:()=>oE,O_RDONLY:()=>P_,O_RDWR:()=>R_,O_SYNC:()=>sE,O_TRUNC:()=>X_,O_WRONLY:()=>A_,R_OK:()=>Zp,S_IFBLK:()=>H_,S_IFCHR:()=>j_,S_IFDIR:()=>$_,S_IFIFO:()=>V_,S_IFLNK:()=>K_,S_IFMT:()=>Q_,S_IFREG:()=>U_,S_IFSOCK:()=>z_,S_IRGRP:()=>fE,S_IROTH:()=>yE,S_IRUSR:()=>cE,S_IRWXG:()=>hE,S_IRWXO:()=>mE,S_IRWXU:()=>aE,S_IWGRP:()=>pE,S_IWOTH:()=>gE,S_IWUSR:()=>uE,S_IXGRP:()=>dE,S_IXOTH:()=>bE,S_IXUSR:()=>lE,UV_DIRENT_BLOCK:()=>k_,UV_DIRENT_CHAR:()=>B_,UV_DIRENT_DIR:()=>I_,UV_DIRENT_FIFO:()=>M_,UV_DIRENT_FILE:()=>O_,UV_DIRENT_LINK:()=>L_,UV_DIRENT_SOCKET:()=>D_,UV_DIRENT_UNKNOWN:()=>N_,UV_FS_COPYFILE_EXCL:()=>wE,UV_FS_COPYFILE_FICLONE:()=>vE,UV_FS_COPYFILE_FICLONE_FORCE:()=>EE,UV_FS_O_FILEMAP:()=>Y_,UV_FS_SYMLINK_DIR:()=>C_,UV_FS_SYMLINK_JUNCTION:()=>T_,W_OK:()=>ed,X_OK:()=>td});var C_,T_,P_,A_,R_,N_,O_,I_,L_,M_,D_,B_,k_,F_,q_,Q_,U_,$_,j_,H_,V_,K_,z_,W_,G_,Y_,J_,X_,Z_,eE,tE,rE,sE,nE,iE,oE,aE,cE,uE,lE,hE,fE,pE,dE,mE,yE,gE,bE,Xp,Zp,ed,td,wE,SE,vE,_E,EE,xE,Ga=fe(()=>{S();w();b();C_=1,T_=2,P_=0,A_=1,R_=2,N_=0,O_=1,I_=2,L_=3,M_=4,D_=5,B_=6,k_=7,F_=0,q_=1,Q_=61440,U_=32768,$_=16384,j_=8192,H_=24576,V_=4096,K_=40960,z_=49152,W_=64,G_=128,Y_=0,J_=256,X_=512,Z_=1024,eE=65536,tE=262144,rE=131072,sE=1052672,nE=4096,iE=16384,oE=2048,aE=448,cE=256,uE=128,lE=64,hE=56,fE=32,pE=16,dE=8,mE=7,yE=4,gE=2,bE=1,Xp=0,Zp=4,ed=2,td=1,wE=1,SE=1,vE=2,_E=2,EE=4,xE=4});var rd,sd=fe(()=>{S();w();b();$n();Ga();$n();rd={constants:cs,access:pn,appendFile:qn,chmod:Nn,chown:Ln,copyFile:dn,cp:mn,glob:Jp,lchmod:On,lchown:In,link:An,lstat:Tn,lutimes:Dn,mkdir:_n,mkdtemp:kn,open:yn,opendir:gn,readFile:Qn,readdir:En,readlink:xn,realpath:Bn,rename:bn,rm:Sn,rmdir:vn,stat:Pn,statfs:Un,symlink:Cn,truncate:wn,unlink:Rn,utimes:Mn,watch:Yp,writeFile:Fn}});var nd,id,od,Ya,Ja,ad,cd,Xa=fe(()=>{S();w();b();ot();nd=it("fs.Dir"),id=it("fs.Dirent"),od=it("fs.Stats"),Ya=it("fs.ReadStream"),Ja=it("fs.WriteStream"),ad=Ya,cd=Ja});function me(r){let e=i(function(...t){let s=t.pop();r().catch(n=>s(n)).then(n=>s(void 0,n))},"fnc");return e.__promisify__=r,e.native=e,e}var ud,ld,hd,fd,pd,dd,md,yd,gd,bd,wd,Sd,vd,_d,Ed,xd,Cd,Td,Pd,Ad,Rd,Nd,Od,Id,Ld,Md,Dd,Bd,kd,Fd,qd,Qd,Ud,$d,jd,Hd,Vd,Kd,zd,Wd,Gd,Yd,Jd,Xd,Zd,em,tm,rm,sm,nm,im,om,am,cm,um,lm,hm,fm,pm,dm,mm,ym,gm,bm,wm,Sm,vm,_m,Em,xm,Cm,Tm,Pm,Am,Rm,Nm,Om,Im,Lm,Mm,Dm,Bm,km,Fm,qm,Qm,Um,$m,jm,Hm,Vm,Km,zm,Za=fe(()=>{S();w();b();ot();$n();i(me,"callbackify");ud=me(pn),ld=me(qn),hd=me(Ln),fd=me(Nn),pd=me(dn),dd=me(mn),md=me(In),yd=me(On),gd=me(An),bd=me(Tn),wd=me(Dn),Sd=me(_n),vd=me(kn),_d=me(Bn),Ed=me(yn),xd=me(gn),Cd=me(En),Td=me(Qn),Pd=me(xn),Ad=me(bn),Rd=me(Sn),Nd=me(vn),Od=me(Pn),Id=me(Cn),Ld=me(wn),Md=me(Rn),Dd=me(Mn),Bd=me(Fn),kd=me(Un),Fd=_e("fs.close"),qd=_e("fs.createReadStream"),Qd=_e("fs.createWriteStream"),Ud=_e("fs.exists"),$d=_e("fs.fchown"),jd=_e("fs.fchmod"),Hd=_e("fs.fdatasync"),Vd=_e("fs.fstat"),Kd=_e("fs.fsync"),zd=_e("fs.ftruncate"),Wd=_e("fs.futimes"),Gd=_e("fs.lstatSync"),Yd=_e("fs.read"),Jd=_e("fs.readv"),Xd=_e("fs.realpathSync"),Zd=_e("fs.statSync"),em=_e("fs.unwatchFile"),tm=_e("fs.watch"),rm=_e("fs.watchFile"),sm=_e("fs.write"),nm=_e("fs.writev"),im=_e("fs._toUnixTimestamp"),om=_e("fs.openAsBlob"),am=_e("fs.glob"),cm=j("fs.appendFileSync"),um=j("fs.accessSync"),lm=j("fs.chownSync"),hm=j("fs.chmodSync"),fm=j("fs.closeSync"),pm=j("fs.copyFileSync"),dm=j("fs.cpSync"),mm=i(()=>!1,"existsSync"),ym=j("fs.fchownSync"),gm=j("fs.fchmodSync"),bm=j("fs.fdatasyncSync"),wm=j("fs.fstatSync"),Sm=j("fs.fsyncSync"),vm=j("fs.ftruncateSync"),_m=j("fs.futimesSync"),Em=j("fs.lchownSync"),xm=j("fs.lchmodSync"),Cm=j("fs.linkSync"),Tm=j("fs.lutimesSync"),Pm=j("fs.mkdirSync"),Am=j("fs.mkdtempSync"),Rm=j("fs.openSync"),Nm=j("fs.opendirSync"),Om=j("fs.readdirSync"),Im=j("fs.readSync"),Lm=j("fs.readvSync"),Mm=j("fs.readFileSync"),Dm=j("fs.readlinkSync"),Bm=j("fs.renameSync"),km=j("fs.rmSync"),Fm=j("fs.rmdirSync"),qm=j("fs.symlinkSync"),Qm=j("fs.truncateSync"),Um=j("fs.unlinkSync"),$m=j("fs.utimesSync"),jm=j("fs.writeFileSync"),Hm=j("fs.writeSync"),Vm=j("fs.writevSync"),Km=j("fs.statfsSync"),zm=j("fs.globSync")});var Wm,Gm=fe(()=>{S();w();b();sd();Xa();Za();Ga();Za();Xa();Wm={F_OK:0,R_OK:4,W_OK:2,X_OK:1,constants:cs,promises:rd,Dir:nd,Dirent:id,FileReadStream:ad,FileWriteStream:cd,ReadStream:Ya,Stats:od,WriteStream:Ja,_toUnixTimestamp:im,access:ud,accessSync:um,appendFile:ld,appendFileSync:cm,chmod:fd,chmodSync:hm,chown:hd,chownSync:lm,close:Fd,closeSync:fm,copyFile:pd,copyFileSync:pm,cp:dd,cpSync:dm,createReadStream:qd,createWriteStream:Qd,exists:Ud,existsSync:mm,fchmod:jd,fchmodSync:gm,fchown:$d,fchownSync:ym,fdatasync:Hd,fdatasyncSync:bm,fstat:Vd,fstatSync:wm,fsync:Kd,fsyncSync:Sm,ftruncate:zd,ftruncateSync:vm,futimes:Wd,futimesSync:_m,glob:am,lchmod:yd,globSync:zm,lchmodSync:xm,lchown:md,lchownSync:Em,link:gd,linkSync:Cm,lstat:bd,lstatSync:Gd,lutimes:wd,lutimesSync:Tm,mkdir:Sd,mkdirSync:Pm,mkdtemp:vd,mkdtempSync:Am,open:Ed,openAsBlob:om,openSync:Rm,opendir:xd,opendirSync:Nm,read:Yd,readFile:Td,readFileSync:Mm,readSync:Im,readdir:Cd,readdirSync:Om,readlink:Pd,readlinkSync:Dm,readv:Jd,readvSync:Lm,realpath:_d,realpathSync:Xd,rename:Ad,renameSync:Bm,rm:Rd,rmSync:km,rmdir:Nd,rmdirSync:Fm,stat:Od,statSync:Zd,statfs:kd,statfsSync:Km,symlink:Id,symlinkSync:qm,truncate:Ld,truncateSync:Qm,unlink:Md,unlinkSync:Um,unwatchFile:em,utimes:Dd,utimesSync:$m,watch:tm,watchFile:rm,write:sm,writeFile:Bd,writeFileSync:jm,writeSync:Hm,writev:nm,writevSync:Vm}});var ec=te((lU,Ym)=>{S();w();b();Gm();Ym.exports=Wm});var Zm=te((dU,Xm)=>{"use strict";S();w();b();function lr(r,e={}){if(r.charAt(0)==="/"){let l=r.split(" ");return{host:l[0],database:l[1]}}let t={},s,n=!1;/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(r)&&(r=encodeURI(r).replace(/%25(\d\d)/g,"%$1"));try{try{s=new URL(r,"postgres://base")}catch{s=new URL(r.replace("@/","@___DUMMY___/"),"postgres://base"),n=!0}}catch(l){l.input&&(l.input="*****REDACTED*****")}for(let l of s.searchParams.entries())t[l[0]]=l[1];if(t.user=t.user||decodeURIComponent(s.username),t.password=t.password||decodeURIComponent(s.password),s.protocol=="socket:")return t.host=decodeURI(s.pathname),t.database=s.searchParams.get("db"),t.client_encoding=s.searchParams.get("encoding"),t;let o=n?"":s.hostname;t.host?o&&/^%2f/i.test(o)&&(s.pathname=o+s.pathname):t.host=decodeURIComponent(o),t.port||(t.port=s.port);let a=s.pathname.slice(1)||null;t.database=a?decodeURI(a):null,(t.ssl==="true"||t.ssl==="1")&&(t.ssl=!0),t.ssl==="0"&&(t.ssl=!1),(t.sslcert||t.sslkey||t.sslrootcert||t.sslmode)&&(t.ssl={});let c=t.sslcert||t.sslkey||t.sslrootcert?ec():null;if(t.sslcert&&(t.ssl.cert=c.readFileSync(t.sslcert).toString()),t.sslkey&&(t.ssl.key=c.readFileSync(t.sslkey).toString()),t.sslrootcert&&(t.ssl.ca=c.readFileSync(t.sslrootcert).toString()),e.useLibpqCompat&&t.uselibpqcompat)throw new Error("Both useLibpqCompat and uselibpqcompat are set. Please use only one of them.");if(t.uselibpqcompat==="true"||e.useLibpqCompat)switch(t.sslmode){case"disable":{t.ssl=!1;break}case"prefer":{t.ssl.rejectUnauthorized=!1;break}case"require":{t.sslrootcert?t.ssl.checkServerIdentity=function(){}:t.ssl.rejectUnauthorized=!1;break}case"verify-ca":{if(!t.ssl.ca)throw new Error("SECURITY WARNING: Using sslmode=verify-ca requires specifying a CA with sslrootcert. If a public CA is used, verify-ca allows connections to a server that somebody else may have registered with the CA, making you vulnerable to Man-in-the-Middle attacks. Either specify a custom CA certificate with sslrootcert parameter or use sslmode=verify-full for proper security.");t.ssl.checkServerIdentity=function(){};break}case"verify-full":break}else switch(t.sslmode){case"disable":{t.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{t.ssl.rejectUnauthorized=!1;break}}return t}i(lr,"parse");function CE(r){return Object.entries(r).reduce((t,[s,n])=>(n!=null&&(t[s]=n),t),{})}i(CE,"toConnectionOptions");function Jm(r){return Object.entries(r).reduce((t,[s,n])=>{if(s==="ssl"){let o=n;typeof o=="boolean"&&(t[s]=o),typeof o=="object"&&(t[s]=CE(o))}else if(n!=null)if(s==="port"){if(n!==""){let o=parseInt(n,10);if(isNaN(o))throw new Error(`Invalid ${s}: ${n}`);t[s]=o}}else t[s]=n;return t},{})}i(Jm,"toClientConfig");function TE(r){return Jm(lr(r))}i(TE,"parseIntoClientConfig");Xm.exports=lr;lr.parse=lr;lr.toClientConfig=Jm;lr.parseIntoClientConfig=TE});var rc=te((wU,ry)=>{"use strict";S();w();b();var PE=Gp(),ty=is(),ey=Zm().parse,He=i(function(r,e,t){return t===void 0?t=process.env["PG"+r.toUpperCase()]:t===!1||(t=process.env[t]),e[r]||t||ty[r]},"val"),AE=i(function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return ty.ssl},"readSSLConfigFromEnvironment"),hr=i(function(r){return"'"+(""+r).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),st=i(function(r,e,t){let s=e[t];s!=null&&r.push(t+"="+hr(s))},"add"),tc=class{static{i(this,"ConnectionParameters")}constructor(e){e=typeof e=="string"?ey(e):e||{},e.connectionString&&(e=Object.assign({},e,ey(e.connectionString))),this.user=He("user",e),this.database=He("database",e),this.database===void 0&&(this.database=this.user),this.port=parseInt(He("port",e),10),this.host=He("host",e),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:He("password",e)}),this.binary=He("binary",e),this.options=He("options",e),this.ssl=typeof e.ssl>"u"?AE():e.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=He("client_encoding",e),this.replication=He("replication",e),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=He("application_name",e,"PGAPPNAME"),this.fallback_application_name=He("fallback_application_name",e,!1),this.statement_timeout=He("statement_timeout",e,!1),this.lock_timeout=He("lock_timeout",e,!1),this.idle_in_transaction_session_timeout=He("idle_in_transaction_session_timeout",e,!1),this.query_timeout=He("query_timeout",e,!1),e.connectionTimeoutMillis===void 0?this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(e.connectionTimeoutMillis/1e3),e.keepAlive===!1?this.keepalives=0:e.keepAlive===!0&&(this.keepalives=1),typeof e.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(e.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(e){let t=[];st(t,this,"user"),st(t,this,"password"),st(t,this,"port"),st(t,this,"application_name"),st(t,this,"fallback_application_name"),st(t,this,"connect_timeout"),st(t,this,"options");let s=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(st(t,s,"sslmode"),st(t,s,"sslca"),st(t,s,"sslkey"),st(t,s,"sslcert"),st(t,s,"sslrootcert"),this.database&&t.push("dbname="+hr(this.database)),this.replication&&t.push("replication="+hr(this.replication)),this.host&&t.push("host="+hr(this.host)),this.isDomainSocket)return e(null,t.join(" "));this.client_encoding&&t.push("client_encoding="+hr(this.client_encoding)),PE.lookup(this.host,function(n,o){return n?e(n,null):(t.push("hostaddr="+hr(o)),e(null,t.join(" ")))})}};ry.exports=tc});var nc=te((xU,ny)=>{"use strict";S();w();b();var RE=ns(),sy=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,sc=class{static{i(this,"Result")}constructor(e,t){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=t,this.RowCtor=null,this.rowAsArray=e==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray),this._prebuiltEmptyResultObject=null}addCommandComplete(e){let t;e.text?t=sy.exec(e.text):t=sy.exec(e.command),t&&(this.command=t[1],t[3]?(this.oid=parseInt(t[2],10),this.rowCount=parseInt(t[3],10)):t[2]&&(this.rowCount=parseInt(t[2],10)))}_parseRowAsArray(e){let t=new Array(e.length);for(let s=0,n=e.length;s<n;s++){let o=e[s];o!==null?t[s]=this._parsers[s](o):t[s]=null}return t}parseRow(e){let t={...this._prebuiltEmptyResultObject};for(let s=0,n=e.length;s<n;s++){let o=e[s],a=this.fields[s].name;if(o!==null){let c=this.fields[s].format==="binary"?Buffer.from(o):o;t[a]=this._parsers[s](c)}else t[a]=null}return t}addRow(e){this.rows.push(e)}addFields(e){this.fields=e,this.fields.length&&(this._parsers=new Array(e.length));let t={};for(let s=0;s<e.length;s++){let n=e[s];t[n.name]=null,this._types?this._parsers[s]=this._types.getTypeParser(n.dataTypeID,n.format||"text"):this._parsers[s]=RE.getTypeParser(n.dataTypeID,n.format||"text")}this._prebuiltEmptyResultObject={...t}}};ny.exports=sc});var cy=te((RU,ay)=>{"use strict";S();w();b();var{EventEmitter:NE}=kt(),iy=nc(),oy=cr(),ic=class extends NE{static{i(this,"Query")}constructor(e,t,s){super(),e=oy.normalizeQueryConfig(e,t,s),this.text=e.text,this.values=e.values,this.rows=e.rows,this.types=e.types,this.name=e.name,this.queryMode=e.queryMode,this.binary=e.binary,this.portal=e.portal||"",this.callback=e.callback,this._rowMode=e.rowMode,process.domain&&e.callback&&(this.callback=process.domain.bind(e.callback)),this._result=new iy(this._rowMode,this.types),this._results=this._result,this._canceledDueToError=!1}requiresPreparation(){return this.queryMode==="extended"||this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new iy(this._rowMode,this._result._types),this._results.push(this._result))}handleRowDescription(e){this._checkForMultirow(),this._result.addFields(e.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(e){let t;if(!this._canceledDueToError){try{t=this._result.parseRow(e.fields)}catch(s){this._canceledDueToError=s;return}this.emit("row",t,this._result),this._accumulateRows&&this._result.addRow(t)}}handleCommandComplete(e,t){this._checkForMultirow(),this._result.addCommandComplete(e),this.rows&&t.sync()}handleEmptyQuery(e){this.rows&&e.sync()}handleError(e,t){if(this._canceledDueToError&&(e=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(e);this.emit("error",e)}handleReadyForQuery(e){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,e);if(this.callback)try{this.callback(null,this._results)}catch(t){process.nextTick(()=>{throw t})}this.emit("end",this._results)}submit(e){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let t=e.parsedStatements[this.name];if(this.text&&t&&this.text!==t)return new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);if(this.values&&!Array.isArray(this.values))return new Error("Query values must be an array");if(this.requiresPreparation()){e.stream.cork&&e.stream.cork();try{this.prepare(e)}finally{e.stream.uncork&&e.stream.uncork()}}else e.query(this.text);return null}hasBeenParsed(e){return this.name&&e.parsedStatements[this.name]}handlePortalSuspended(e){this._getRows(e,this.rows)}_getRows(e,t){e.execute({portal:this.portal,rows:t}),t?e.flush():e.sync()}prepare(e){this.hasBeenParsed(e)||e.parse({text:this.text,name:this.name,types:this.types});try{e.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:oy.prepareValue})}catch(t){this.handleError(t,e);return}e.describe({type:"P",name:this.portal||""}),this._getRows(e,this.rows)}handleCopyInResponse(e){e.sendCopyFail("No source stream defined")}handleCopyData(e,t){}};ay.exports=ic});var Sc=te(ne=>{"use strict";S();w();b();Object.defineProperty(ne,"__esModule",{value:!0});ne.NoticeMessage=ne.DataRowMessage=ne.CommandCompleteMessage=ne.ReadyForQueryMessage=ne.NotificationResponseMessage=ne.BackendKeyDataMessage=ne.AuthenticationMD5Password=ne.ParameterStatusMessage=ne.ParameterDescriptionMessage=ne.RowDescriptionMessage=ne.Field=ne.CopyResponse=ne.CopyDataMessage=ne.DatabaseError=ne.copyDone=ne.emptyQuery=ne.replicationStart=ne.portalSuspended=ne.noData=ne.closeComplete=ne.bindComplete=ne.parseComplete=void 0;ne.parseComplete={name:"parseComplete",length:5};ne.bindComplete={name:"bindComplete",length:5};ne.closeComplete={name:"closeComplete",length:5};ne.noData={name:"noData",length:5};ne.portalSuspended={name:"portalSuspended",length:5};ne.replicationStart={name:"replicationStart",length:4};ne.emptyQuery={name:"emptyQuery",length:4};ne.copyDone={name:"copyDone",length:4};var oc=class extends Error{static{i(this,"DatabaseError")}constructor(e,t,s){super(e),this.length=t,this.name=s}};ne.DatabaseError=oc;var ac=class{static{i(this,"CopyDataMessage")}constructor(e,t){this.length=e,this.chunk=t,this.name="copyData"}};ne.CopyDataMessage=ac;var cc=class{static{i(this,"CopyResponse")}constructor(e,t,s,n){this.length=e,this.name=t,this.binary=s,this.columnTypes=new Array(n)}};ne.CopyResponse=cc;var uc=class{static{i(this,"Field")}constructor(e,t,s,n,o,a,c){this.name=e,this.tableID=t,this.columnID=s,this.dataTypeID=n,this.dataTypeSize=o,this.dataTypeModifier=a,this.format=c}};ne.Field=uc;var lc=class{static{i(this,"RowDescriptionMessage")}constructor(e,t){this.length=e,this.fieldCount=t,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};ne.RowDescriptionMessage=lc;var hc=class{static{i(this,"ParameterDescriptionMessage")}constructor(e,t){this.length=e,this.parameterCount=t,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};ne.ParameterDescriptionMessage=hc;var fc=class{static{i(this,"ParameterStatusMessage")}constructor(e,t,s){this.length=e,this.parameterName=t,this.parameterValue=s,this.name="parameterStatus"}};ne.ParameterStatusMessage=fc;var pc=class{static{i(this,"AuthenticationMD5Password")}constructor(e,t){this.length=e,this.salt=t,this.name="authenticationMD5Password"}};ne.AuthenticationMD5Password=pc;var dc=class{static{i(this,"BackendKeyDataMessage")}constructor(e,t,s){this.length=e,this.processID=t,this.secretKey=s,this.name="backendKeyData"}};ne.BackendKeyDataMessage=dc;var mc=class{static{i(this,"NotificationResponseMessage")}constructor(e,t,s,n){this.length=e,this.processId=t,this.channel=s,this.payload=n,this.name="notification"}};ne.NotificationResponseMessage=mc;var yc=class{static{i(this,"ReadyForQueryMessage")}constructor(e,t){this.length=e,this.status=t,this.name="readyForQuery"}};ne.ReadyForQueryMessage=yc;var gc=class{static{i(this,"CommandCompleteMessage")}constructor(e,t){this.length=e,this.text=t,this.name="commandComplete"}};ne.CommandCompleteMessage=gc;var bc=class{static{i(this,"DataRowMessage")}constructor(e,t){this.length=e,this.fields=t,this.name="dataRow",this.fieldCount=t.length}};ne.DataRowMessage=bc;var wc=class{static{i(this,"NoticeMessage")}constructor(e,t){this.length=e,this.message=t,this.name="notice"}};ne.NoticeMessage=wc});var uy=te(jn=>{"use strict";S();w();b();Object.defineProperty(jn,"__esModule",{value:!0});jn.Writer=void 0;var vc=class{static{i(this,"Writer")}constructor(e=256){this.size=e,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(e)}ensure(e){if(this.buffer.length-this.offset<e){let s=this.buffer,n=s.length+(s.length>>1)+e;this.buffer=Buffer.allocUnsafe(n),s.copy(this.buffer)}}addInt32(e){return this.ensure(4),this.buffer[this.offset++]=e>>>24&255,this.buffer[this.offset++]=e>>>16&255,this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addInt16(e){return this.ensure(2),this.buffer[this.offset++]=e>>>8&255,this.buffer[this.offset++]=e>>>0&255,this}addCString(e){if(!e)this.ensure(1);else{let t=Buffer.byteLength(e);this.ensure(t+1),this.buffer.write(e,this.offset,"utf-8"),this.offset+=t}return this.buffer[this.offset++]=0,this}addString(e=""){let t=Buffer.byteLength(e);return this.ensure(t),this.buffer.write(e,this.offset),this.offset+=t,this}add(e){return this.ensure(e.length),e.copy(this.buffer,this.offset),this.offset+=e.length,this}join(e){if(e){this.buffer[this.headerPosition]=e;let t=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(t,this.headerPosition+1)}return this.buffer.slice(e?0:5,this.offset)}flush(e){let t=this.join(e);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),t}};jn.Writer=vc});var hy=te(Vn=>{"use strict";S();w();b();Object.defineProperty(Vn,"__esModule",{value:!0});Vn.serialize=void 0;var _c=uy(),xe=new _c.Writer,OE=i(r=>{xe.addInt16(3).addInt16(0);for(let s of Object.keys(r))xe.addCString(s).addCString(r[s]);xe.addCString("client_encoding").addCString("UTF8");let e=xe.addCString("").flush(),t=e.length+4;return new _c.Writer().addInt32(t).add(e).flush()},"startup"),IE=i(()=>{let r=Buffer.allocUnsafe(8);return r.writeInt32BE(8,0),r.writeInt32BE(80877103,4),r},"requestSsl"),LE=i(r=>xe.addCString(r).flush(112),"password"),ME=i(function(r,e){return xe.addCString(r).addInt32(Buffer.byteLength(e)).addString(e),xe.flush(112)},"sendSASLInitialResponseMessage"),DE=i(function(r){return xe.addString(r).flush(112)},"sendSCRAMClientFinalMessage"),BE=i(r=>xe.addCString(r).flush(81),"query"),ly=[],kE=i(r=>{let e=r.name||"";e.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",e,e.length),console.error("This can cause conflicts and silent errors executing queries"));let t=r.types||ly,s=t.length,n=xe.addCString(e).addCString(r.text).addInt16(s);for(let o=0;o<s;o++)n.addInt32(t[o]);return xe.flush(80)},"parse"),fr=new _c.Writer,FE=i(function(r,e){for(let t=0;t<r.length;t++){let s=e?e(r[t],t):r[t];s==null?(xe.addInt16(0),fr.addInt32(-1)):s instanceof Buffer?(xe.addInt16(1),fr.addInt32(s.length),fr.add(s)):(xe.addInt16(0),fr.addInt32(Buffer.byteLength(s)),fr.addString(s))}},"writeValues"),qE=i((r={})=>{let e=r.portal||"",t=r.statement||"",s=r.binary||!1,n=r.values||ly,o=n.length;return xe.addCString(e).addCString(t),xe.addInt16(o),FE(n,r.valueMapper),xe.addInt16(o),xe.add(fr.flush()),xe.addInt16(1),xe.addInt16(s?1:0),xe.flush(66)},"bind"),QE=Buffer.from([69,0,0,0,9,0,0,0,0,0]),UE=i(r=>{if(!r||!r.portal&&!r.rows)return QE;let e=r.portal||"",t=r.rows||0,s=Buffer.byteLength(e),n=4+s+1+4,o=Buffer.allocUnsafe(1+n);return o[0]=69,o.writeInt32BE(n,1),o.write(e,5,"utf-8"),o[s+5]=0,o.writeUInt32BE(t,o.length-4),o},"execute"),$E=i((r,e)=>{let t=Buffer.allocUnsafe(16);return t.writeInt32BE(16,0),t.writeInt16BE(1234,4),t.writeInt16BE(5678,6),t.writeInt32BE(r,8),t.writeInt32BE(e,12),t},"cancel"),Ec=i((r,e)=>{let s=4+Buffer.byteLength(e)+1,n=Buffer.allocUnsafe(1+s);return n[0]=r,n.writeInt32BE(s,1),n.write(e,5,"utf-8"),n[s]=0,n},"cstringMessage"),jE=xe.addCString("P").flush(68),HE=xe.addCString("S").flush(68),VE=i(r=>r.name?Ec(68,`${r.type}${r.name||""}`):r.type==="P"?jE:HE,"describe"),KE=i(r=>{let e=`${r.type}${r.name||""}`;return Ec(67,e)},"close"),zE=i(r=>xe.add(r).flush(100),"copyData"),WE=i(r=>Ec(102,r),"copyFail"),Hn=i(r=>Buffer.from([r,0,0,0,4]),"codeOnlyBuffer"),GE=Hn(72),YE=Hn(83),JE=Hn(88),XE=Hn(99),ZE={startup:OE,password:LE,requestSsl:IE,sendSASLInitialResponseMessage:ME,sendSCRAMClientFinalMessage:DE,query:BE,parse:kE,bind:qE,execute:UE,describe:VE,close:KE,flush:i(()=>GE,"flush"),sync:i(()=>YE,"sync"),end:i(()=>JE,"end"),copyData:zE,copyDone:i(()=>XE,"copyDone"),copyFail:WE,cancel:$E};Vn.serialize=ZE});var fy=te(Kn=>{"use strict";S();w();b();Object.defineProperty(Kn,"__esModule",{value:!0});Kn.BufferReader=void 0;var ex=Buffer.allocUnsafe(0),xc=class{static{i(this,"BufferReader")}constructor(e=0){this.offset=e,this.buffer=ex,this.encoding="utf-8"}setBuffer(e,t){this.offset=e,this.buffer=t}int16(){let e=this.buffer.readInt16BE(this.offset);return this.offset+=2,e}byte(){let e=this.buffer[this.offset];return this.offset++,e}int32(){let e=this.buffer.readInt32BE(this.offset);return this.offset+=4,e}uint32(){let e=this.buffer.readUInt32BE(this.offset);return this.offset+=4,e}string(e){let t=this.buffer.toString(this.encoding,this.offset,this.offset+e);return this.offset+=e,t}cstring(){let e=this.offset,t=e;for(;this.buffer[t++]!==0;);return this.offset=t,this.buffer.toString(this.encoding,e,t-1)}bytes(e){let t=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t}};Kn.BufferReader=xc});var my=te(zn=>{"use strict";S();w();b();Object.defineProperty(zn,"__esModule",{value:!0});zn.Parser=void 0;var Pe=Sc(),tx=fy(),Cc=1,rx=4,py=Cc+rx,dy=Buffer.allocUnsafe(0),Tc=class{static{i(this,"Parser")}constructor(e){if(this.buffer=dy,this.bufferLength=0,this.bufferOffset=0,this.reader=new tx.BufferReader,e?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=e?.mode||"text"}parse(e,t){this.mergeBuffer(e);let s=this.bufferOffset+this.bufferLength,n=this.bufferOffset;for(;n+py<=s;){let o=this.buffer[n],a=this.buffer.readUInt32BE(n+Cc),c=Cc+a;if(c+n<=s){let l=this.handlePacket(n+py,o,a,this.buffer);t(l),n+=c}else break}n===s?(this.buffer=dy,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=s-n,this.bufferOffset=n)}mergeBuffer(e){if(this.bufferLength>0){let t=this.bufferLength+e.byteLength;if(t+this.bufferOffset>this.buffer.byteLength){let n;if(t<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)n=this.buffer;else{let o=this.buffer.byteLength*2;for(;t>=o;)o*=2;n=Buffer.allocUnsafe(o)}this.buffer.copy(n,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=n,this.bufferOffset=0}e.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=t}else this.buffer=e,this.bufferOffset=0,this.bufferLength=e.byteLength}handlePacket(e,t,s,n){switch(t){case 50:return Pe.bindComplete;case 49:return Pe.parseComplete;case 51:return Pe.closeComplete;case 110:return Pe.noData;case 115:return Pe.portalSuspended;case 99:return Pe.copyDone;case 87:return Pe.replicationStart;case 73:return Pe.emptyQuery;case 68:return this.parseDataRowMessage(e,s,n);case 67:return this.parseCommandCompleteMessage(e,s,n);case 90:return this.parseReadyForQueryMessage(e,s,n);case 65:return this.parseNotificationMessage(e,s,n);case 82:return this.parseAuthenticationResponse(e,s,n);case 83:return this.parseParameterStatusMessage(e,s,n);case 75:return this.parseBackendKeyData(e,s,n);case 69:return this.parseErrorMessage(e,s,n,"error");case 78:return this.parseErrorMessage(e,s,n,"notice");case 84:return this.parseRowDescriptionMessage(e,s,n);case 116:return this.parseParameterDescriptionMessage(e,s,n);case 71:return this.parseCopyInMessage(e,s,n);case 72:return this.parseCopyOutMessage(e,s,n);case 100:return this.parseCopyData(e,s,n);default:return new Pe.DatabaseError("received invalid response: "+t.toString(16),s,"error")}}parseReadyForQueryMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.string(1);return new Pe.ReadyForQueryMessage(t,n)}parseCommandCompleteMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.cstring();return new Pe.CommandCompleteMessage(t,n)}parseCopyData(e,t,s){let n=s.slice(e,e+(t-4));return new Pe.CopyDataMessage(t,n)}parseCopyInMessage(e,t,s){return this.parseCopyMessage(e,t,s,"copyInResponse")}parseCopyOutMessage(e,t,s){return this.parseCopyMessage(e,t,s,"copyOutResponse")}parseCopyMessage(e,t,s,n){this.reader.setBuffer(e,s);let o=this.reader.byte()!==0,a=this.reader.int16(),c=new Pe.CopyResponse(t,n,o,a);for(let l=0;l<a;l++)c.columnTypes[l]=this.reader.int16();return c}parseNotificationMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),o=this.reader.cstring(),a=this.reader.cstring();return new Pe.NotificationResponseMessage(t,n,o,a)}parseRowDescriptionMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),o=new Pe.RowDescriptionMessage(t,n);for(let a=0;a<n;a++)o.fields[a]=this.parseField();return o}parseField(){let e=this.reader.cstring(),t=this.reader.uint32(),s=this.reader.int16(),n=this.reader.uint32(),o=this.reader.int16(),a=this.reader.int32(),c=this.reader.int16()===0?"text":"binary";return new Pe.Field(e,t,s,n,o,a,c)}parseParameterDescriptionMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),o=new Pe.ParameterDescriptionMessage(t,n);for(let a=0;a<n;a++)o.dataTypeIDs[a]=this.reader.int32();return o}parseDataRowMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int16(),o=new Array(n);for(let a=0;a<n;a++){let c=this.reader.int32();o[a]=c===-1?null:this.reader.string(c)}return new Pe.DataRowMessage(t,o)}parseParameterStatusMessage(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.cstring(),o=this.reader.cstring();return new Pe.ParameterStatusMessage(t,n,o)}parseBackendKeyData(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),o=this.reader.int32();return new Pe.BackendKeyDataMessage(t,n,o)}parseAuthenticationResponse(e,t,s){this.reader.setBuffer(e,s);let n=this.reader.int32(),o={name:"authenticationOk",length:t};switch(n){case 0:break;case 3:o.length===8&&(o.name="authenticationCleartextPassword");break;case 5:if(o.length===12){o.name="authenticationMD5Password";let a=this.reader.bytes(4);return new Pe.AuthenticationMD5Password(t,a)}break;case 10:{o.name="authenticationSASL",o.mechanisms=[];let a;do a=this.reader.cstring(),a&&o.mechanisms.push(a);while(a)}break;case 11:o.name="authenticationSASLContinue",o.data=this.reader.string(t-8);break;case 12:o.name="authenticationSASLFinal",o.data=this.reader.string(t-8);break;default:throw new Error("Unknown authenticationOk message type "+n)}return o}parseErrorMessage(e,t,s,n){this.reader.setBuffer(e,s);let o={},a=this.reader.string(1);for(;a!=="\0";)o[a]=this.reader.cstring(),a=this.reader.string(1);let c=o.M,l=n==="notice"?new Pe.NoticeMessage(t,c):new Pe.DatabaseError(c,t,n);return l.severity=o.S,l.code=o.C,l.detail=o.D,l.hint=o.H,l.position=o.P,l.internalPosition=o.p,l.internalQuery=o.q,l.where=o.W,l.schema=o.s,l.table=o.t,l.column=o.c,l.dataType=o.d,l.constraint=o.n,l.file=o.F,l.line=o.L,l.routine=o.R,l}};zn.Parser=Tc});var Pc=te(Tt=>{"use strict";S();w();b();Object.defineProperty(Tt,"__esModule",{value:!0});Tt.DatabaseError=Tt.serialize=Tt.parse=void 0;var sx=Sc();Object.defineProperty(Tt,"DatabaseError",{enumerable:!0,get:i(function(){return sx.DatabaseError},"get")});var nx=hy();Object.defineProperty(Tt,"serialize",{enumerable:!0,get:i(function(){return nx.serialize},"get")});var ix=my();function ox(r,e){let t=new ix.Parser;return r.on("data",s=>t.parse(s,e)),new Promise(s=>r.on("end",()=>s()))}i(ox,"parse");Tt.parse=ox});import ax from"net";var Ac=te((h$,yy)=>{S();w();b();yy.exports=ax});import{Server as cx}from"node:net";var Qt,Rc=fe(()=>{S();w();b();ot();Qt=class extends cx{static{i(this,"Server")}constructor(e,t){super(e,t)}addContext(e,t){}setSecureContext(e){}setTicketKeys(e){throw de("Server.setTicketKeys")}getTicketKeys(){throw de("Server.getTicketKeys")}}});var gy,by,wy,Sy,vy=fe(()=>{S();w();b();gy="",by="auto",wy="TLSv1.2",Sy="TLSv1.3"});var _y,Ey,xy,Cy,Ty=fe(()=>{S();w();b();ot();Rc();vy();Rc();_y=i(function(){return new Qt},"createServer"),Ey=j("tls.createSecurePair"),xy=j("tls.getCiphers"),Cy=[]});var hx,fx,px,dx,mx,yx,gx,Py,Ay=fe(()=>{S();w();b();Ty();hx=process.getBuiltinModule("node:tls"),{checkServerIdentity:fx,connect:px,createSecureContext:dx,convertALPNProtocols:mx,SecureContext:yx,TLSSocket:gx}=hx,Py={CLIENT_RENEG_LIMIT:3,CLIENT_RENEG_WINDOW:600,DEFAULT_CIPHERS:gy,DEFAULT_ECDH_CURVE:by,DEFAULT_MAX_VERSION:Sy,DEFAULT_MIN_VERSION:wy,SecureContext:yx,Server:Qt,TLSSocket:gx,checkServerIdentity:fx,connect:px,convertALPNProtocols:mx,createSecureContext:dx,createSecurePair:Ey,createServer:_y,getCiphers:xy,rootCertificates:Cy}});var Ny=te((U$,Ry)=>{S();w();b();Ay();Ry.exports=Py});var Oy=te(Nc=>{"use strict";S();w();b();Object.defineProperty(Nc,"__esModule",{value:!0});Nc.default={}});var Ly=te((G$,Iy)=>{S();w();b();var{getStream:bx,getSecureStream:wx}=Ex();Iy.exports={getStream:bx,getSecureStream:wx};function Sx(){function r(t){let s=Ac();return new s.Socket}i(r,"getStream");function e(t){return Ny().connect(t)}return i(e,"getSecureStream"),{getStream:r,getSecureStream:e}}i(Sx,"getNodejsStreamFuncs");function vx(){function r(t){let{CloudflareSocket:s}=Oy();return new s(t)}i(r,"getStream");function e(t){return t.socket.startTls(t),t.socket}return i(e,"getSecureStream"),{getStream:r,getSecureStream:e}}i(vx,"getCloudflareStreamFuncs");function _x(){if(typeof navigator=="object"&&navigator!==null)return!0;if(typeof Response=="function"){let r=new Response(null,{cf:{thing:!0}});if(typeof r.cf=="object"&&r.cf!==null&&r.cf.thing)return!0}return!1}i(_x,"isCloudflareRuntime");function Ex(){return _x()?vx():Sx()}i(Ex,"getStreamFuncs")});var Ic=te((ej,My)=>{"use strict";S();w();b();var xx=kt().EventEmitter,{parse:Cx,serialize:Qe}=Pc(),{getStream:Tx,getSecureStream:Px}=Ly(),Ax=Qe.flush(),Rx=Qe.sync(),Nx=Qe.end(),Oc=class extends xx{static{i(this,"Connection")}constructor(e){super(),e=e||{},this.stream=e.stream||Tx(e.ssl),typeof this.stream=="function"&&(this.stream=this.stream(e)),this._keepAlive=e.keepAlive,this._keepAliveInitialDelayMillis=e.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=e.ssl||!1,this._ending=!1,this._emitMessage=!1;let t=this;this.on("newListener",function(s){s==="message"&&(t._emitMessage=!0)})}connect(e,t){let s=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(e,t),this.stream.once("connect",function(){s._keepAlive&&s.stream.setKeepAlive(!0,s._keepAliveInitialDelayMillis),s.emit("connect")});let n=i(function(o){s._ending&&(o.code==="ECONNRESET"||o.code==="EPIPE")||s.emit("error",o)},"reportStreamError");if(this.stream.on("error",n),this.stream.on("close",function(){s.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(o){switch(o.toString("utf8")){case"S":break;case"N":return s.stream.end(),s.emit("error",new Error("The server does not support SSL connections"));default:return s.stream.end(),s.emit("error",new Error("There was an error establishing an SSL connection"))}let c={socket:s.stream};s.ssl!==!0&&(Object.assign(c,s.ssl),"key"in s.ssl&&(c.key=s.ssl.key));let l=Ac();l.isIP&&l.isIP(t)===0&&(c.servername=t);try{s.stream=Px(c)}catch(d){return s.emit("error",d)}s.attachListeners(s.stream),s.stream.on("error",n),s.emit("sslconnect")})}attachListeners(e){Cx(e,t=>{let s=t.name==="error"?"errorMessage":t.name;this._emitMessage&&this.emit("message",t),this.emit(s,t)})}requestSsl(){this.stream.write(Qe.requestSsl())}startup(e){this.stream.write(Qe.startup(e))}cancel(e,t){this._send(Qe.cancel(e,t))}password(e){this._send(Qe.password(e))}sendSASLInitialResponseMessage(e,t){this._send(Qe.sendSASLInitialResponseMessage(e,t))}sendSCRAMClientFinalMessage(e){this._send(Qe.sendSCRAMClientFinalMessage(e))}_send(e){return this.stream.writable?this.stream.write(e):!1}query(e){this._send(Qe.query(e))}parse(e){this._send(Qe.parse(e))}bind(e){this._send(Qe.bind(e))}execute(e){this._send(Qe.execute(e))}flush(){this.stream.writable&&this.stream.write(Ax)}sync(){this._ending=!0,this._send(Rx)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(Nx,()=>{this.stream.end()})}close(e){this._send(Qe.close(e))}describe(e){this._send(Qe.describe(e))}sendCopyFromChunk(e){this._send(Qe.copyData(e))}endCopyFrom(){this._send(Qe.copyDone())}sendCopyFail(e){this._send(Qe.copyFail(e))}};My.exports=Oc});import Ox from"path";var Lc=te((oj,Dy)=>{S();w();b();Dy.exports=Ox});import Ix from"stream";var Mc=te((hj,By)=>{S();w();b();By.exports=Ix});import Lx from"string_decoder";var Fy=te((yj,ky)=>{S();w();b();ky.exports=Lx});var $y=te((Sj,Uy)=>{"use strict";S();w();b();var{Transform:Mx}=Mc(),{StringDecoder:Dx}=Fy(),Pt=Symbol("last"),Wn=Symbol("decoder");function Bx(r,e,t){let s;if(this.overflow){if(s=this[Wn].write(r).split(this.matcher),s.length===1)return t();s.shift(),this.overflow=!1}else this[Pt]+=this[Wn].write(r),s=this[Pt].split(this.matcher);this[Pt]=s.pop();for(let n=0;n<s.length;n++)try{Qy(this,this.mapper(s[n]))}catch(o){return t(o)}if(this.overflow=this[Pt].length>this.maxLength,this.overflow&&!this.skipOverflow){t(new Error("maximum buffer reached"));return}t()}i(Bx,"transform");function kx(r){if(this[Pt]+=this[Wn].end(),this[Pt])try{Qy(this,this.mapper(this[Pt]))}catch(e){return r(e)}r()}i(kx,"flush");function Qy(r,e){e!==void 0&&r.push(e)}i(Qy,"push");function qy(r){return r}i(qy,"noop");function Fx(r,e,t){switch(r=r||/\r?\n/,e=e||qy,t=t||{},arguments.length){case 1:typeof r=="function"?(e=r,r=/\r?\n/):typeof r=="object"&&!(r instanceof RegExp)&&!r[Symbol.split]&&(t=r,r=/\r?\n/);break;case 2:typeof r=="function"?(t=e,e=r,r=/\r?\n/):typeof e=="object"&&(t=e,e=qy)}t=Object.assign({},t),t.autoDestroy=!0,t.transform=Bx,t.flush=kx,t.readableObjectMode=!0;let s=new Mx(t);return s[Pt]="",s[Wn]=new Dx("utf8"),s.matcher=r,s.mapper=e,s.maxLength=t.maxLength,s.skipOverflow=t.skipOverflow||!1,s.overflow=!1,s._destroy=function(n,o){this._writableState.errorEmitted=!1,o(n)},s}i(Fx,"split");Uy.exports=Fx});var Vy=te((Cj,St)=>{"use strict";S();w();b();var jy=Lc(),qx=Mc().Stream,Qx=$y(),Hy=os(),Ux=5432,Gn=process.platform==="win32",us=process.stderr,$x=56,jx=7,Hx=61440,Vx=32768;function Kx(r){return(r&Hx)==Vx}i(Kx,"isRegFile");var pr=["host","port","database","user","password"],Dc=pr.length,zx=pr[Dc-1];function Bc(){var r=us instanceof qx&&us.writable===!0;if(r){var e=Array.prototype.slice.call(arguments).concat(`
`);us.write(Hy.format.apply(Hy,e))}}i(Bc,"warn");Object.defineProperty(St.exports,"isWin",{get:i(function(){return Gn},"get"),set:i(function(r){Gn=r},"set")});St.exports.warnTo=function(r){var e=us;return us=r,e};St.exports.getFileName=function(r){var e=r||process.env,t=e.PGPASSFILE||(Gn?jy.join(e.APPDATA||"./","postgresql","pgpass.conf"):jy.join(e.HOME||"./",".pgpass"));return t};St.exports.usePgPass=function(r,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Gn?!0:(e=e||"<unkn>",Kx(r.mode)?r.mode&($x|jx)?(Bc('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(Bc('WARNING: password file "%s" is not a plain file',e),!1))};var Wx=St.exports.match=function(r,e){return pr.slice(0,-1).reduce(function(t,s,n){return n==1&&Number(r[s]||Ux)===Number(e[s])?t&&!0:t&&(e[s]==="*"||e[s]===r[s])},!0)};St.exports.getPassword=function(r,e,t){var s,n=e.pipe(Qx());function o(l){var d=Gx(l);d&&Yx(d)&&Wx(r,d)&&(s=d[zx],n.end())}i(o,"onLine");var a=i(function(){e.destroy(),t(s)},"onEnd"),c=i(function(l){e.destroy(),Bc("WARNING: error on reading file: %s",l),t(void 0)},"onErr");e.on("error",c),n.on("data",o).on("end",a).on("error",c)};var Gx=St.exports.parseLine=function(r){if(r.length<11||r.match(/^\s+#/))return null;for(var e="",t="",s=0,n=0,o=0,a={},c=!1,l=i(function(f,v,y){var x=r.substring(v,y);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(x=x.replace(/\\([:\\])/g,"$1")),a[pr[f]]=x},"addToObj"),d=0;d<r.length-1;d+=1){if(e=r.charAt(d+1),t=r.charAt(d),c=s==Dc-1,c){l(s,n);break}d>=0&&e==":"&&t!=="\\"&&(l(s,n,d+1),n=d+2,s+=1)}return a=Object.keys(a).length===Dc?a:null,a},Yx=St.exports.isValidEntry=function(r){for(var e={0:function(a){return a.length>0},1:function(a){return a==="*"?!0:(a=Number(a),isFinite(a)&&a>0&&a<9007199254740992&&Math.floor(a)===a)},2:function(a){return a.length>0},3:function(a){return a.length>0},4:function(a){return a.length>0}},t=0;t<pr.length;t+=1){var s=e[t],n=r[pr[t]]||"",o=s(n);if(!o)return!1}return!0}});var zy=te((Oj,kc)=>{"use strict";S();w();b();var Nj=Lc(),Ky=ec(),Yn=Vy();kc.exports=function(r,e){var t=Yn.getFileName();Ky.stat(t,function(s,n){if(s||!Yn.usePgPass(n,t))return e(void 0);var o=Ky.createReadStream(t);Yn.getPassword(r,o,e)})};kc.exports.warnTo=Yn.warnTo});var Jy=te((Dj,Yy)=>{"use strict";S();w();b();var Jx=kt().EventEmitter,Wy=cr(),Fc=Kp(),Xx=fn(),Zx=rc(),Gy=cy(),eC=is(),tC=Ic(),rC=za(),Jn=class extends Jx{static{i(this,"Client")}constructor(e){super(),this.connectionParameters=new Zx(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let t=e||{};this._Promise=t.Promise||global.Promise,this._types=new Xx(t.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!t.enableChannelBinding,this.connection=t.connection||new tC({stream:t.stream,ssl:this.connectionParameters.ssl,keepAlive:t.keepAlive||!1,keepAliveInitialDelayMillis:t.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=t.binary||eC.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=t.connectionTimeoutMillis||0}_errorAllQueries(e){let t=i(s=>{process.nextTick(()=>{s.handleError(e,this.connection)})},"enqueueError");this.activeQuery&&(t(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(t),this.queryQueue.length=0}_connect(e){let t=this,s=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let n=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(n)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{s._ending=!0,s.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){t.ssl?s.requestSsl():s.startup(t.getStartupConf())}),s.on("sslconnect",function(){s.startup(t.getStartupConf())}),this._attachListeners(s),s.once("end",()=>{let n=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(n),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(n):this._handleErrorEvent(n):this._connectionError||this._handleErrorEvent(n)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((t,s)=>{this._connect(n=>{n?s(n):t()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let t=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(s=>{if(s!==void 0){if(typeof s!="string"){t.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=s}else this.connectionParameters.password=this.password=null;e()}).catch(s=>{t.emit("error",s)});else if(this.password!==null)e();else try{zy()(this.connectionParameters,n=>{n!==void 0&&(this.connectionParameters.password=this.password=n),e()})}catch(s){this.emit("error",s)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let t=await rC.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(t)}catch(t){this.emit("error",t)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=Fc.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(t){this.connection.emit("error",t)}})}async _handleAuthSASLContinue(e){try{await Fc.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(t){this.connection.emit("error",t)}}_handleAuthSASLFinal(e){try{Fc.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(t){this.connection.emit("error",t)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:t}=this;this.activeQuery=null,this.readyForQuery=!0,t&&t.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let t=this.activeQuery;if(!t){this._handleErrorEvent(e);return}this.activeQuery=null,t.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let t=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(t);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,t={user:e.user,database:e.database},s=e.application_name||e.fallback_application_name;return s&&(t.application_name=s),e.replication&&(t.replication=""+e.replication),e.statement_timeout&&(t.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(t.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(t.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(t.options=e.options),t}cancel(e,t){if(e.activeQuery===t){let s=this.connection;this.host&&this.host.indexOf("/")===0?s.connect(this.host+"/.s.PGSQL."+this.port):s.connect(this.port,this.host),s.on("connect",function(){s.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(t)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(t),1)}setTypeParser(e,t,s){return this._types.setTypeParser(e,t,s)}getTypeParser(e,t){return this._types.getTypeParser(e,t)}escapeIdentifier(e){return Wy.escapeIdentifier(e)}escapeLiteral(e){return Wy.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,t,s){let n,o,a,c,l;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(a=e.query_timeout||this.connectionParameters.query_timeout,o=n=e,typeof t=="function"&&(n.callback=n.callback||t)):(a=e.query_timeout||this.connectionParameters.query_timeout,n=new Gy(e,t,s),n.callback||(o=new this._Promise((d,f)=>{n.callback=(v,y)=>v?f(v):d(y)}).catch(d=>{throw Error.captureStackTrace(d),d}))),a&&(l=n.callback,c=setTimeout(()=>{let d=new Error("Query read timeout");process.nextTick(()=>{n.handleError(d,this.connection)}),l(d),n.callback=()=>{};let f=this.queryQueue.indexOf(n);f>-1&&this.queryQueue.splice(f,1),this._pulseQueryQueue()},a),n.callback=(d,f)=>{clearTimeout(c),l(d,f)}),this.binary&&!n.binary&&(n.binary=!0),n._result&&!n._result._types&&(n._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"),this.connection)}),o):(this.queryQueue.push(n),this._pulseQueryQueue(),o):(process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),o)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(t=>{this.connection.once("end",t)})}};Jn.Query=Gy;Yy.exports=Jn});var tg=te((Qj,eg)=>{"use strict";S();w();b();var sC=kt().EventEmitter,Xy=i(function(){},"NOOP"),Zy=i((r,e)=>{let t=r.findIndex(e);return t===-1?void 0:r.splice(t,1)[0]},"removeWhere"),qc=class{static{i(this,"IdleItem")}constructor(e,t,s){this.client=e,this.idleListener=t,this.timeoutId=s}},dr=class{static{i(this,"PendingItem")}constructor(e){this.callback=e}};function nC(){throw new Error("Release called on client which has already been released to the pool.")}i(nC,"throwOnDoubleRelease");function Xn(r,e){if(e)return{callback:e,result:void 0};let t,s,n=i(function(a,c){a?t(a):s(c)},"cb"),o=new r(function(a,c){s=a,t=c}).catch(a=>{throw Error.captureStackTrace(a),a});return{callback:n,result:o}}i(Xn,"promisify");function iC(r,e){return i(function t(s){s.client=e,e.removeListener("error",t),e.on("error",()=>{r.log("additional client error after disconnection due to error",s)}),r._remove(e),r.emit("error",s,e)},"idleListener")}i(iC,"makeIdleListener");var Qc=class extends sC{static{i(this,"Pool")}constructor(e,t){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||t||Uc().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(t=>{this._remove(t.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let t=this._idle.pop();clearTimeout(t.timeoutId);let s=t.client;s.ref&&s.ref();let n=t.idleListener;return this._acquireClient(s,e,n,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,t){let s=Zy(this._idle,o=>o.client===e);s!==void 0&&clearTimeout(s.timeoutId),this._clients=this._clients.filter(o=>o!==e);let n=this;e.end(()=>{n.emit("remove",e),typeof t=="function"&&t()})}connect(e){if(this.ending){let n=new Error("Cannot use a pool after calling end on the pool");return e?e(n):this.Promise.reject(n)}let t=Xn(this.Promise,e),s=t.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new dr(t.callback)),s;let n=i((c,l,d)=>{clearTimeout(a),t.callback(c,l,d)},"queueCallback"),o=new dr(n),a=setTimeout(()=>{Zy(this._pendingQueue,c=>c.callback===n),o.timedOut=!0,t.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return a.unref&&a.unref(),this._pendingQueue.push(o),s}return this.newClient(new dr(t.callback)),s}newClient(e){let t=new this.Client(this.options);this._clients.push(t);let s=iC(this,t);this.log("checking client timeout");let n,o=!1;this.options.connectionTimeoutMillis&&(n=setTimeout(()=>{this.log("ending client due to timeout"),o=!0,t.connection?t.connection.stream.destroy():t.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),t.connect(a=>{if(n&&clearTimeout(n),t.on("error",s),a)this.log("client failed to connect",a),this._clients=this._clients.filter(c=>c!==t),o&&(a=new Error("Connection terminated due to connection timeout",{cause:a})),this._pulseQueue(),e.timedOut||e.callback(a,void 0,Xy);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let c=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(t),this._idle.findIndex(d=>d.client===t)!==-1&&this._acquireClient(t,new dr((d,f,v)=>v()),s,!1)},this.options.maxLifetimeSeconds*1e3);c.unref(),t.once("end",()=>clearTimeout(c))}return this._acquireClient(t,e,s,!0)}})}_acquireClient(e,t,s,n){n&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,s),e.removeListener("error",s),t.timedOut?n&&this.options.verify?this.options.verify(e,e.release):e.release():n&&this.options.verify?this.options.verify(e,o=>{if(o)return e.release(o),t.callback(o,void 0,Xy);t.callback(void 0,e,e.release)}):t.callback(void 0,e,e.release)}_releaseOnce(e,t){let s=!1;return n=>{s&&nC(),s=!0,this._release(e,t,n)}}_release(e,t,s){if(e.on("error",t),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",s,e),s||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let o;this.options.idleTimeoutMillis&&this._isAboveMin()&&(o=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&o.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new qc(e,t,o)),this._pulseQueue()}query(e,t,s){if(typeof e=="function"){let o=Xn(this.Promise,e);return setImmediate(function(){return o.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),o.result}typeof t=="function"&&(s=t,t=void 0);let n=Xn(this.Promise,s);return s=n.callback,this.connect((o,a)=>{if(o)return s(o);let c=!1,l=i(d=>{c||(c=!0,a.release(d),s(d))},"onError");a.once("error",l),this.log("dispatching query");try{a.query(e,t,(d,f)=>{if(this.log("query dispatched"),a.removeListener("error",l),!c)return c=!0,a.release(d),d?s(d):s(void 0,f)})}catch(d){return a.release(d),s(d)}}),n.result}end(e){if(this.log("ending"),this.ending){let s=new Error("Called end on pool more than once");return e?e(s):this.Promise.reject(s)}this.ending=!0;let t=Xn(this.Promise,e);return this._endCallback=t.callback,this._pulseQueue(),t.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,t)=>e+(this._expired.has(t)?1:0),0)}get totalCount(){return this._clients.length}};eg.exports=Qc});var ng=te((Vj,sg)=>{"use strict";S();w();b();var rg=kt().EventEmitter,oC=os(),$c=cr(),mr=sg.exports=function(r,e,t){rg.call(this),r=$c.normalizeQueryConfig(r,e,t),this.text=r.text,this.values=r.values,this.name=r.name,this.queryMode=r.queryMode,this.callback=r.callback,this.state="new",this._arrayMode=r.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(s){s==="row"&&(this._emitRowEvents=!0)}.bind(this))};oC.inherits(mr,rg);var aC={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};mr.prototype.handleError=function(r){let e=this.native.pq.resultErrorFields();if(e)for(let t in e){let s=aC[t]||t;r[s]=e[t]}this.callback?this.callback(r):this.emit("error",r),this.state="error"};mr.prototype.then=function(r,e){return this._getPromise().then(r,e)};mr.prototype.catch=function(r){return this._getPromise().catch(r)};mr.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(r,e){this._once("end",r),this._once("error",e)}.bind(this)),this._promise)};mr.prototype.submit=function(r){this.state="running";let e=this;this.native=r.native,r.native.arrayMode=this._arrayMode;let t=i(function(s,n,o){if(r.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),s)return e.handleError(s);e._emitRowEvents&&(o.length>1?n.forEach((a,c)=>{a.forEach(l=>{e.emit("row",l,o[c])})}):n.forEach(function(a){e.emit("row",a,o)})),e.state="end",e.emit("end",o),e.callback&&e.callback(null,o)},"after");if(process.domain&&(t=process.domain.bind(t)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let s=(this.values||[]).map($c.prepareValue);if(r.namedQueries[this.name]){if(this.text&&r.namedQueries[this.name]!==this.text){let n=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return t(n)}return r.native.execute(this.name,s,t)}return r.native.prepare(this.name,this.text,s.length,function(n){return n?t(n):(r.namedQueries[e.name]=e.text,e.native.execute(e.name,s,t))})}else if(this.values){if(!Array.isArray(this.values)){let n=new Error("Query values must be an array");return t(n)}let s=this.values.map($c.prepareValue);r.native.query(this.text,s,t)}else this.queryMode==="extended"?r.native.query(this.text,[],t):r.native.query(this.text,t)}});var ug=te((Yj,cg)=>{"use strict";S();w();b();var ig;try{ig=jg("pg-native")}catch(r){throw r}var cC=fn(),og=kt().EventEmitter,uC=os(),lC=rc(),ag=ng(),Je=cg.exports=function(r){og.call(this),r=r||{},this._Promise=r.Promise||global.Promise,this._types=new cC(r.types),this.native=new ig({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new lC(r);r.nativeConnectionString&&(e.nativeConnectionString=r.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};Je.Query=ag;uC.inherits(Je,og);Je.prototype._errorAllQueries=function(r){let e=i(t=>{process.nextTick(()=>{t.native=this.native,t.handleError(r)})},"enqueueError");this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};Je.prototype._connect=function(r){let e=this;if(this._connecting){process.nextTick(()=>r(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(t,s){if(e.connectionParameters.nativeConnectionString&&(s=e.connectionParameters.nativeConnectionString),t)return r(t);e.native.connect(s,function(n){if(n)return e.native.end(),r(n);e._connected=!0,e.native.on("error",function(o){e._queryable=!1,e._errorAllQueries(o),e.emit("error",o)}),e.native.on("notification",function(o){e.emit("notification",{channel:o.relname,payload:o.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),r()})})};Je.prototype.connect=function(r){if(r){this._connect(r);return}return new this._Promise((e,t)=>{this._connect(s=>{s?t(s):e()})})};Je.prototype.query=function(r,e,t){let s,n,o,a,c;if(r==null)throw new TypeError("Client was passed a null or undefined query");if(typeof r.submit=="function")o=r.query_timeout||this.connectionParameters.query_timeout,n=s=r,typeof e=="function"&&(r.callback=e);else if(o=r.query_timeout||this.connectionParameters.query_timeout,s=new ag(r,e,t),!s.callback){let l,d;n=new this._Promise((f,v)=>{l=f,d=v}).catch(f=>{throw Error.captureStackTrace(f),f}),s.callback=(f,v)=>f?d(f):l(v)}return o&&(c=s.callback,a=setTimeout(()=>{let l=new Error("Query read timeout");process.nextTick(()=>{s.handleError(l,this.connection)}),c(l),s.callback=()=>{};let d=this._queryQueue.indexOf(s);d>-1&&this._queryQueue.splice(d,1),this._pulseQueryQueue()},o),s.callback=(l,d)=>{clearTimeout(a),c(l,d)}),this._queryable?this._ending?(s.native=this.native,process.nextTick(()=>{s.handleError(new Error("Client was closed and is not queryable"))}),n):(this._queryQueue.push(s),this._pulseQueryQueue(),n):(s.native=this.native,process.nextTick(()=>{s.handleError(new Error("Client has encountered a connection error and is not queryable"))}),n)};Je.prototype.end=function(r){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,r));let t;return r||(t=new this._Promise(function(s,n){r=i(o=>o?n(o):s(),"cb")})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),r&&r()})}),t};Je.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};Je.prototype._pulseQueryQueue=function(r){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){r||this.emit("drain");return}this._activeQuery=e,e.submit(this);let t=this;e.once("_done",function(){t._pulseQueryQueue()})};Je.prototype.cancel=function(r){this._activeQuery===r?this.native.cancel(function(){}):this._queryQueue.indexOf(r)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(r),1)};Je.prototype.ref=function(){};Je.prototype.unref=function(){};Je.prototype.setTypeParser=function(r,e,t){return this._types.setTypeParser(r,e,t)};Je.prototype.getTypeParser=function(r,e){return this._types.getTypeParser(r,e)}});var jc=te((t9,lg)=>{"use strict";S();w();b();lg.exports=ug()});var Uc=te((o9,ls)=>{"use strict";S();w();b();var hC=Jy(),fC=is(),pC=Ic(),dC=nc(),mC=cr(),yC=tg(),gC=fn(),{DatabaseError:bC}=Pc(),{escapeIdentifier:wC,escapeLiteral:SC}=cr(),vC=i(r=>class extends yC{static{i(this,"BoundPool")}constructor(t){super(t,r)}},"poolFactory"),Hc=i(function(r){this.defaults=fC,this.Client=r,this.Query=this.Client.Query,this.Pool=vC(this.Client),this._pools=[],this.Connection=pC,this.types=ns(),this.DatabaseError=bC,this.TypeOverrides=gC,this.escapeIdentifier=wC,this.escapeLiteral=SC,this.Result=dC,this.utils=mC},"PG");typeof process.env.NODE_PG_FORCE_NATIVE<"u"?ls.exports=new Hc(jc()):(ls.exports=new Hc(hC),Object.defineProperty(ls.exports,"native",{configurable:!0,enumerable:!1,get(){let r=null;try{r=new Hc(jc())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(ls.exports,"native",{value:r}),r}}))});S();w();b();S();w();b();S();w();b();S();w();b();S();w();b();var T=Symbol.for("drizzle:entityKind"),AA=Symbol.for("drizzle:hasOwnEntityKind");function U(r,e){if(!r||typeof r!="object")return!1;if(r instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,T))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(r).constructor;if(t)for(;t;){if(T in t&&t[T]===e[T])return!0;t=Object.getPrototypeOf(t)}return!1}i(U,"is");var ye=class{static{i(this,"Column")}constructor(e,t){this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}static[T]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}};S();w();b();S();w();b();S();w();b();S();w();b();var Es=class{static{i(this,"ColumnBuilder")}static[T]="ColumnBuilder";config;constructor(e,t,s){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:s,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}};S();w();b();S();w();b();var at=Symbol.for("drizzle:Name");var xs=class{static{i(this,"ForeignKeyBuilder")}static[T]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,t){this.reference=()=>{let{name:s,columns:n,foreignColumns:o}=e();return{name:s,columns:n,foreignTable:o[0].table,foreignColumns:o}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new vi(e,this)}},vi=class{static{i(this,"ForeignKey")}constructor(e,t){this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}static[T]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:t,foreignColumns:s}=this.reference(),n=t.map(c=>c.name),o=s.map(c=>c.name),a=[this.table[at],...n,s[0].table[at],...o];return e??`${a.join("_")}_fk`}};S();w();b();function Cs(r,...e){return r(...e)}i(Cs,"iife");S();w();b();function xi(r,e){return`${r[at]}_${e.join("_")}_unique`}i(xi,"uniqueKeyName");var _i=class{static{i(this,"UniqueConstraintBuilder")}constructor(e,t){this.name=t,this.columns=e}static[T]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new Ei(e,this.columns,this.nullsNotDistinctConfig,this.name)}},Ku=class{static{i(this,"UniqueOnConstraintBuilder")}static[T]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new _i(e,this.name)}},Ei=class{static{i(this,"UniqueConstraint")}constructor(e,t,s,n){this.table=e,this.columns=t,this.name=n??xi(this.table,this.columns.map(o=>o.name)),this.nullsNotDistinct=s}static[T]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}};S();w();b();function zu(r,e,t){for(let s=e;s<r.length;s++){let n=r[s];if(n==="\\"){s++;continue}if(n==='"')return[r.slice(e,s).replace(/\\/g,""),s+1];if(!t&&(n===","||n==="}"))return[r.slice(e,s).replace(/\\/g,""),s]}return[r.slice(e).replace(/\\/g,""),r.length]}i(zu,"parsePgArrayValue");function Wu(r,e=0){let t=[],s=e,n=!1;for(;s<r.length;){let o=r[s];if(o===","){(n||s===e)&&t.push(""),n=!0,s++;continue}if(n=!1,o==="\\"){s+=2;continue}if(o==='"'){let[l,d]=zu(r,s+1,!0);t.push(l),s=d;continue}if(o==="}")return[t,s+1];if(o==="{"){let[l,d]=Wu(r,s+1);t.push(l),s=d;continue}let[a,c]=zu(r,s,!1);t.push(a),s=c}return[t,s]}i(Wu,"parsePgNestedArray");function Gu(r){let[e]=Wu(r,1);return e}i(Gu,"parsePgArray");function Ci(r){return`{${r.map(e=>Array.isArray(e)?Ci(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}i(Ci,"makePgArray");var W=class extends Es{static{i(this,"PgColumnBuilder")}foreignKeyConfigs=[];static[T]="PgColumnBuilder";array(e){return new Pi(this.config.name,this,e)}references(e,t={}){return this.foreignKeyConfigs.push({ref:e,actions:t}),this}unique(e,t){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=t?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,t){return this.foreignKeyConfigs.map(({ref:s,actions:n})=>Cs((o,a)=>{let c=new xs(()=>{let l=o();return{columns:[e],foreignColumns:[l]}});return a.onUpdate&&c.onUpdate(a.onUpdate),a.onDelete&&c.onDelete(a.onDelete),c.build(t)},s,n))}buildExtraConfigColumn(e){return new Ti(e,this.config)}},V=class extends ye{static{i(this,"PgColumn")}constructor(e,t){t.uniqueName||(t.uniqueName=xi(e,[t.name])),super(e,t),this.table=e}static[T]="PgColumn"},Ti=class extends V{static{i(this,"ExtraConfigColumn")}static[T]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},Yu=class{static{i(this,"IndexedColumn")}static[T]="IndexedColumn";constructor(e,t,s,n){this.name=e,this.keyAsName=t,this.type=s,this.indexConfig=n}name;keyAsName;type;indexConfig},Pi=class extends W{static{i(this,"PgArrayBuilder")}static[T]="PgArrayBuilder";constructor(e,t,s){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=s}build(e){let t=this.config.baseBuilder.build(e);return new Ai(e,this.config,t)}},Ai=class r extends V{static{i(this,"PgArray")}constructor(e,t,s,n){super(e,t),this.baseColumn=s,this.range=n,this.size=t.size}size;static[T]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=Gu(e)),e.map(t=>this.baseColumn.mapFromDriverValue(t))}mapToDriverValue(e,t=!1){let s=e.map(n=>n===null?null:U(this.baseColumn,r)?this.baseColumn.mapToDriverValue(n,!0):this.baseColumn.mapToDriverValue(n));return t?s:Ci(s)}};var Ju=class extends W{static{i(this,"PgEnumObjectColumnBuilder")}static[T]="PgEnumObjectColumnBuilder";constructor(e,t){super(e,"string","PgEnumObjectColumn"),this.config.enum=t}build(e){return new Ri(e,this.config)}},Ri=class extends V{static{i(this,"PgEnumObjectColumn")}static[T]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}},Xu=Symbol.for("drizzle:isPgEnum");function el(r){return!!r&&typeof r=="function"&&Xu in r&&r[Xu]===!0}i(el,"isPgEnum");var Zu=class extends W{static{i(this,"PgEnumColumnBuilder")}static[T]="PgEnumColumnBuilder";constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new Ni(e,this.config)}},Ni=class extends V{static{i(this,"PgEnumColumn")}static[T]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,t){super(e,t),this.enum=t.enum}getSQLType(){return this.enum.enumName}};S();w();b();var Ae=class{static{i(this,"Subquery")}static[T]="Subquery";constructor(e,t,s,n=!1,o=[]){this._={brand:"Subquery",sql:e,selectedFields:t,alias:s,isWith:n,usedTables:o}}},Vt=class extends Ae{static{i(this,"WithSubquery")}static[T]="WithSubquery"};S();w();b();S();w();b();var tl="0.44.2";var Oi,Ii,ge={startActiveSpan(r,e){return Oi?(Ii||(Ii=Oi.trace.getTracer("drizzle-orm",tl)),Cs((t,s)=>s.startActiveSpan(r,n=>{try{return e(n)}catch(o){throw n.setStatus({code:t.SpanStatusCode.ERROR,message:o instanceof Error?o.message:"Unknown error"}),o}finally{n.end()}}),Oi,Ii)):e()}};S();w();b();var ve=Symbol.for("drizzle:ViewBaseConfig");S();w();b();var Nt=Symbol.for("drizzle:Schema"),Ts=Symbol.for("drizzle:Columns"),rl=Symbol.for("drizzle:ExtraConfigColumns"),Li=Symbol.for("drizzle:OriginalName"),Mi=Symbol.for("drizzle:BaseName"),Tr=Symbol.for("drizzle:IsAlias"),sl=Symbol.for("drizzle:ExtraConfigBuilder"),G0=Symbol.for("drizzle:IsDrizzleTable"),z=class{static{i(this,"Table")}static[T]="Table";static Symbol={Name:at,Schema:Nt,OriginalName:Li,Columns:Ts,ExtraConfigColumns:rl,BaseName:Mi,IsAlias:Tr,ExtraConfigBuilder:sl};[at];[Li];[Nt];[Ts];[rl];[Mi];[Tr]=!1;[G0]=!0;[sl]=void 0;constructor(e,t,s){this[at]=this[Li]=e,this[Nt]=t,this[Mi]=s}};function Ve(r){return r[at]}i(Ve,"getTableName");function Ot(r){return`${r[Nt]??"public"}.${r[at]}`}i(Ot,"getTableUniqueName");var nl=class{static{i(this,"FakePrimitiveParam")}static[T]="FakePrimitiveParam"};function Di(r){return r!=null&&typeof r.getSQL=="function"}i(Di,"isSQLWrapper");function Y0(r){let e={sql:"",params:[]};for(let t of r)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}i(Y0,"mergeQueries");var Me=class{static{i(this,"StringChunk")}static[T]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new J([this])}},J=class r{static{i(this,"SQL")}constructor(e){this.queryChunks=e;for(let t of e)if(U(t,z)){let s=t[z.Symbol.Schema];this.usedTables.push(s===void 0?t[z.Symbol.Name]:s+"."+t[z.Symbol.Name])}}static[T]="SQL";decoder=ol;shouldInlineParams=!1;usedTables=[];append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return ge.startActiveSpan("drizzle.buildSQL",t=>{let s=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":s.sql,"drizzle.query.params":JSON.stringify(s.params)}),s})}buildQueryFromSourceParams(e,t){let s=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:n,escapeName:o,escapeParam:a,prepareTyping:c,inlineParams:l,paramStartIndex:d}=s;return Y0(e.map(f=>{if(U(f,Me))return{sql:f.value.join(""),params:[]};if(U(f,Pr))return{sql:o(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let v=[new Me("(")];for(let[y,x]of f.entries())v.push(x),y<f.length-1&&v.push(new Me(", "));return v.push(new Me(")")),this.buildQueryFromSourceParams(v,s)}if(U(f,r))return this.buildQueryFromSourceParams(f.queryChunks,{...s,inlineParams:l||f.shouldInlineParams});if(U(f,z)){let v=f[z.Symbol.Schema],y=f[z.Symbol.Name];return{sql:v===void 0||f[Tr]?o(y):o(v)+"."+o(y),params:[]}}if(U(f,ye)){let v=n.getColumnCasing(f);if(t.invokeSource==="indexes")return{sql:o(v),params:[]};let y=f.table[z.Symbol.Schema];return{sql:f.table[Tr]||y===void 0?o(f.table[z.Symbol.Name])+"."+o(v):o(y)+"."+o(f.table[z.Symbol.Name])+"."+o(v),params:[]}}if(U(f,je)){let v=f[ve].schema,y=f[ve].name;return{sql:v===void 0||f[ve].isAlias?o(y):o(v)+"."+o(y),params:[]}}if(U(f,Ke)){if(U(f.value,mt))return{sql:a(d.value++,f),params:[f],typings:["none"]};let v=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(U(v,r))return this.buildQueryFromSourceParams([v],s);if(l)return{sql:this.mapInlineParam(v,s),params:[]};let y=["none"];return c&&(y=[c(f.encoder)]),{sql:a(d.value++,v),params:[v],typings:y}}return U(f,mt)?{sql:a(d.value++,f),params:[f],typings:["none"]}:U(f,r.Aliased)&&f.fieldAlias!==void 0?{sql:o(f.fieldAlias),params:[]}:U(f,Ae)?f._.isWith?{sql:o(f._.alias),params:[]}:this.buildQueryFromSourceParams([new Me("("),f._.sql,new Me(") "),new Pr(f._.alias)],s):el(f)?f.schema?{sql:o(f.schema)+"."+o(f.enumName),params:[]}:{sql:o(f.enumName),params:[]}:Di(f)?f.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([f.getSQL()],s):this.buildQueryFromSourceParams([new Me("("),f.getSQL(),new Me(")")],s):l?{sql:this.mapInlineParam(f,s),params:[]}:{sql:a(d.value++,f),params:[f],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let s=e.toString();return t(s==="[object Object]"?JSON.stringify(e):s)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new r.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Pr=class{static{i(this,"Name")}constructor(e){this.value=e}static[T]="Name";brand;getSQL(){return new J([this])}};function il(r){return typeof r=="object"&&r!==null&&"mapToDriverValue"in r&&typeof r.mapToDriverValue=="function"}i(il,"isDriverValueEncoder");var ol={mapFromDriverValue:i(r=>r,"mapFromDriverValue")},al={mapToDriverValue:i(r=>r,"mapToDriverValue")},wN={...ol,...al},Ke=class{static{i(this,"Param")}constructor(e,t=al){this.value=e,this.encoder=t}static[T]="Param";brand;getSQL(){return new J([this])}};function O(r,...e){let t=[];(e.length>0||r.length>0&&r[0]!=="")&&t.push(new Me(r[0]));for(let[s,n]of e.entries())t.push(n,new Me(r[s+1]));return new J(t)}i(O,"sql");(r=>{function e(){return new J([])}i(e,"empty"),r.empty=e;function t(l){return new J(l)}i(t,"fromList"),r.fromList=t;function s(l){return new J([new Me(l)])}i(s,"raw"),r.raw=s;function n(l,d){let f=[];for(let[v,y]of l.entries())v>0&&d!==void 0&&f.push(d),f.push(y);return new J(f)}i(n,"join"),r.join=n;function o(l){return new Pr(l)}i(o,"identifier"),r.identifier=o;function a(l){return new mt(l)}i(a,"placeholder2"),r.placeholder=a;function c(l,d){return new Ke(l,d)}i(c,"param2"),r.param=c})(O||(O={}));(r=>{class e{static{i(this,"Aliased")}constructor(s,n){this.sql=s,this.fieldAlias=n}static[T]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}r.Aliased=e})(J||(J={}));var mt=class{static{i(this,"Placeholder")}constructor(e){this.name=e}static[T]="Placeholder";getSQL(){return new J([this])}};function It(r,e){return r.map(t=>{if(U(t,mt)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(U(t,Ke)&&U(t.value,mt)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}i(It,"fillPlaceholders");var J0=Symbol.for("drizzle:IsDrizzleView"),je=class{static{i(this,"View")}static[T]="View";[ve];[J0]=!0;constructor({name:e,schema:t,selectedFields:s,query:n}){this[ve]={name:e,originalName:e,schema:t,selectedFields:s,query:n,isExisting:!n,isAlias:!1}}getSQL(){return new J([this])}};ye.prototype.getSQL=function(){return new J([this])};z.prototype.getSQL=function(){return new J([this])};Ae.prototype.getSQL=function(){return new J([this])};var Lt=class{static{i(this,"ColumnAliasProxyHandler")}constructor(e){this.table=e}static[T]="ColumnAliasProxyHandler";get(e,t){return t==="table"?this.table:e[t]}},Kt=class{static{i(this,"TableAliasProxyHandler")}constructor(e,t){this.alias=e,this.replaceOriginalName=t}static[T]="TableAliasProxyHandler";get(e,t){if(t===z.Symbol.IsAlias)return!0;if(t===z.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===z.Symbol.OriginalName)return this.alias;if(t===ve)return{...e[ve],name:this.alias,isAlias:!0};if(t===z.Symbol.Columns){let n=e[z.Symbol.Columns];if(!n)return n;let o={};return Object.keys(n).map(a=>{o[a]=new Proxy(n[a],new Lt(new Proxy(e,this)))}),o}let s=e[t];return U(s,ye)?new Proxy(s,new Lt(new Proxy(e,this))):s}},cl=class{static{i(this,"RelationTableAliasProxyHandler")}constructor(e){this.alias=e}static[T]="RelationTableAliasProxyHandler";get(e,t){return t==="sourceTable"?Ar(e.sourceTable,this.alias):e[t]}};function Ar(r,e){return new Proxy(r,new Kt(e,!1))}i(Ar,"aliasedTable");function lt(r,e){return new Proxy(r,new Lt(new Proxy(r.table,new Kt(e,!1))))}i(lt,"aliasedTableColumn");function Bi(r,e){return new J.Aliased(Rr(r.sql,e),r.fieldAlias)}i(Bi,"mapColumnsInAliasedSQLToAlias");function Rr(r,e){return O.join(r.queryChunks.map(t=>U(t,ye)?lt(t,e):U(t,J)?Rr(t,e):U(t,J.Aliased)?Bi(t,e):t))}i(Rr,"mapColumnsInSQLToAlias");S();w();b();S();w();b();function Ps(r,e,t){let s={},n=r.reduce((o,{path:a,field:c},l)=>{let d;U(c,ye)?d=c:U(c,J)?d=c.decoder:d=c.sql.decoder;let f=o;for(let[v,y]of a.entries())if(v<a.length-1)y in f||(f[y]={}),f=f[y];else{let x=e[l],m=f[y]=x===null?null:d.mapFromDriverValue(x);if(t&&U(c,ye)&&a.length===2){let h=a[0];h in s?typeof s[h]=="string"&&s[h]!==Ve(c.table)&&(s[h]=!1):s[h]=m===null?Ve(c.table):!1}}return o},{});if(t&&Object.keys(s).length>0)for(let[o,a]of Object.entries(s))typeof a=="string"&&!t[a]&&(n[o]=null);return n}i(Ps,"mapResultRow");function et(r,e){return Object.entries(r).reduce((t,[s,n])=>{if(typeof s!="string")return t;let o=e?[...e,s]:[s];return U(n,ye)||U(n,J)||U(n,J.Aliased)?t.push({path:o,field:n}):U(n,z)?t.push(...et(n[z.Symbol.Columns],o)):t.push(...et(n,o)),t},[])}i(et,"orderSelectedFields");function Nr(r,e){let t=Object.keys(r),s=Object.keys(e);if(t.length!==s.length)return!1;for(let[n,o]of t.entries())if(o!==s[n])return!1;return!0}i(Nr,"haveSameKeys");function As(r,e){let t=Object.entries(e).filter(([,s])=>s!==void 0).map(([s,n])=>U(n,J)||U(n,ye)?[s,n]:[s,new Ke(n,r[z.Symbol.Columns][s])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}i(As,"mapUpdateSet");function ul(r,e){for(let t of e)for(let s of Object.getOwnPropertyNames(t.prototype))s!=="constructor"&&Object.defineProperty(r.prototype,s,Object.getOwnPropertyDescriptor(t.prototype,s)||Object.create(null))}i(ul,"applyMixins");function ll(r){return r[z.Symbol.Columns]}i(ll,"getTableColumns");function yt(r){return U(r,Ae)?r._.alias:U(r,je)?r[ve].name:U(r,J)?void 0:r[z.Symbol.IsAlias]?r[z.Symbol.Name]:r[z.Symbol.BaseName]}i(yt,"getTableLikeName");function le(r,e){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:e}}i(le,"getColumnNameAndConfig");function Rs(r){if(typeof r!="object"||r===null||r.constructor.name!=="Object")return!1;if("logger"in r){let e=typeof r.logger;return!(e!=="boolean"&&(e!=="object"||typeof r.logger.logQuery!="function")&&e!=="undefined")}if("schema"in r){let e=typeof r.schema;return!(e!=="object"&&e!=="undefined")}if("casing"in r){let e=typeof r.casing;return!(e!=="string"&&e!=="undefined")}if("mode"in r)return!(r.mode!=="default"||r.mode!=="planetscale"||r.mode!==void 0);if("connection"in r){let e=typeof r.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in r){let e=typeof r.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(r).length===0}i(Rs,"isConfig");S();w();b();var gt=class extends W{static{i(this,"PgIntColumnBaseBuilder")}static[T]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:t,...s}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:s}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...s}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:s}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}};var ki=class extends gt{static{i(this,"PgBigInt53Builder")}static[T]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Fi(e,this.config)}},Fi=class extends V{static{i(this,"PgBigInt53")}static[T]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},qi=class extends gt{static{i(this,"PgBigInt64Builder")}static[T]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Qi(e,this.config)}},Qi=class extends V{static{i(this,"PgBigInt64")}static[T]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}};function hl(r,e){let{name:t,config:s}=le(r,e);return s.mode==="number"?new ki(t):new qi(t)}i(hl,"bigint");S();w();b();var Ui=class extends W{static{i(this,"PgBigSerial53Builder")}static[T]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new $i(e,this.config)}},$i=class extends V{static{i(this,"PgBigSerial53")}static[T]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},ji=class extends W{static{i(this,"PgBigSerial64Builder")}static[T]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Hi(e,this.config)}},Hi=class extends V{static{i(this,"PgBigSerial64")}static[T]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};function fl(r,e){let{name:t,config:s}=le(r,e);return s.mode==="number"?new Ui(t):new ji(t)}i(fl,"bigserial");S();w();b();var Vi=class extends W{static{i(this,"PgBooleanBuilder")}static[T]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Ki(e,this.config)}},Ki=class extends V{static{i(this,"PgBoolean")}static[T]="PgBoolean";getSQLType(){return"boolean"}};function zt(r){return new Vi(r??"")}i(zt,"boolean");S();w();b();var zi=class extends W{static{i(this,"PgCharBuilder")}static[T]="PgCharBuilder";constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Wi(e,this.config)}},Wi=class extends V{static{i(this,"PgChar")}static[T]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}};function pl(r,e={}){let{name:t,config:s}=le(r,e);return new zi(t,s)}i(pl,"char");S();w();b();var Gi=class extends W{static{i(this,"PgCidrBuilder")}static[T]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new Yi(e,this.config)}},Yi=class extends V{static{i(this,"PgCidr")}static[T]="PgCidr";getSQLType(){return"cidr"}};function dl(r){return new Gi(r??"")}i(dl,"cidr");S();w();b();var Ji=class extends W{static{i(this,"PgCustomColumnBuilder")}static[T]="PgCustomColumnBuilder";constructor(e,t,s){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=s}build(e){return new Xi(e,this.config)}},Xi=class extends V{static{i(this,"PgCustomColumn")}static[T]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,t){super(e,t),this.sqlName=t.customTypeParams.dataType(t.fieldConfig),this.mapTo=t.customTypeParams.toDriver,this.mapFrom=t.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}};function vt(r){return(e,t)=>{let{name:s,config:n}=le(e,t);return new Ji(s,n,r)}}i(vt,"customType");S();w();b();S();w();b();var ht=class extends W{static{i(this,"PgDateColumnBaseBuilder")}static[T]="PgDateColumnBaseBuilder";defaultNow(){return this.default(O`now()`)}};var Zi=class extends ht{static{i(this,"PgDateBuilder")}static[T]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Or(e,this.config)}},Or=class extends V{static{i(this,"PgDate")}static[T]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},eo=class extends ht{static{i(this,"PgDateStringBuilder")}static[T]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Ir(e,this.config)}},Ir=class extends V{static{i(this,"PgDateString")}static[T]="PgDateString";getSQLType(){return"date"}};function ml(r,e){let{name:t,config:s}=le(r,e);return s?.mode==="date"?new Zi(t):new eo(t)}i(ml,"date");S();w();b();var to=class extends W{static{i(this,"PgDoublePrecisionBuilder")}static[T]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new ro(e,this.config)}},ro=class extends V{static{i(this,"PgDoublePrecision")}static[T]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};function yl(r){return new to(r??"")}i(yl,"doublePrecision");S();w();b();var so=class extends W{static{i(this,"PgInetBuilder")}static[T]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new no(e,this.config)}},no=class extends V{static{i(this,"PgInet")}static[T]="PgInet";getSQLType(){return"inet"}};function gl(r){return new so(r??"")}i(gl,"inet");S();w();b();var io=class extends gt{static{i(this,"PgIntegerBuilder")}static[T]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new oo(e,this.config)}},oo=class extends V{static{i(this,"PgInteger")}static[T]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};function bl(r){return new io(r??"")}i(bl,"integer");S();w();b();var ao=class extends W{static{i(this,"PgIntervalBuilder")}static[T]="PgIntervalBuilder";constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new co(e,this.config)}},co=class extends V{static{i(this,"PgInterval")}static[T]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",t=this.precision?`(${this.precision})`:"";return`interval${e}${t}`}};function wl(r,e={}){let{name:t,config:s}=le(r,e);return new ao(t,s)}i(wl,"interval");S();w();b();var uo=class extends W{static{i(this,"PgJsonBuilder")}static[T]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Lr(e,this.config)}},Lr=class extends V{static{i(this,"PgJson")}static[T]="PgJson";constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function Sl(r){return new uo(r??"")}i(Sl,"json");S();w();b();var lo=class extends W{static{i(this,"PgJsonbBuilder")}static[T]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new Mr(e,this.config)}},Mr=class extends V{static{i(this,"PgJsonb")}static[T]="PgJsonb";constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};function vl(r){return new lo(r??"")}i(vl,"jsonb");S();w();b();var ho=class extends W{static{i(this,"PgLineBuilder")}static[T]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new fo(e,this.config)}},fo=class extends V{static{i(this,"PgLineTuple")}static[T]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[t,s,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(s),Number.parseFloat(n)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},po=class extends W{static{i(this,"PgLineABCBuilder")}static[T]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new mo(e,this.config)}},mo=class extends V{static{i(this,"PgLineABC")}static[T]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[t,s,n]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(s),c:Number.parseFloat(n)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}};function _l(r,e){let{name:t,config:s}=le(r,e);return!s?.mode||s.mode==="tuple"?new ho(t):new po(t)}i(_l,"line");S();w();b();var yo=class extends W{static{i(this,"PgMacaddrBuilder")}static[T]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new go(e,this.config)}},go=class extends V{static{i(this,"PgMacaddr")}static[T]="PgMacaddr";getSQLType(){return"macaddr"}};function El(r){return new yo(r??"")}i(El,"macaddr");S();w();b();var bo=class extends W{static{i(this,"PgMacaddr8Builder")}static[T]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new wo(e,this.config)}},wo=class extends V{static{i(this,"PgMacaddr8")}static[T]="PgMacaddr8";getSQLType(){return"macaddr8"}};function xl(r){return new bo(r??"")}i(xl,"macaddr8");S();w();b();var So=class extends W{static{i(this,"PgNumericBuilder")}static[T]="PgNumericBuilder";constructor(e,t,s){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=s}build(e){return new Dr(e,this.config)}},Dr=class extends V{static{i(this,"PgNumeric")}static[T]="PgNumeric";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return typeof e=="string"?e:String(e)}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}},vo=class extends W{static{i(this,"PgNumericNumberBuilder")}static[T]="PgNumericNumberBuilder";constructor(e,t,s){super(e,"number","PgNumericNumber"),this.config.precision=t,this.config.scale=s}build(e){return new _o(e,this.config)}},_o=class extends V{static{i(this,"PgNumericNumber")}static[T]="PgNumericNumber";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}mapToDriverValue=String;getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}},Eo=class extends W{static{i(this,"PgNumericBigIntBuilder")}static[T]="PgNumericBigIntBuilder";constructor(e,t,s){super(e,"bigint","PgNumericBigInt"),this.config.precision=t,this.config.scale=s}build(e){return new xo(e,this.config)}},xo=class extends V{static{i(this,"PgNumericBigInt")}static[T]="PgNumericBigInt";precision;scale;constructor(e,t){super(e,t),this.precision=t.precision,this.scale=t.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};function Cl(r,e){let{name:t,config:s}=le(r,e),n=s?.mode;return n==="number"?new vo(t,s?.precision,s?.scale):n==="bigint"?new Eo(t,s?.precision,s?.scale):new So(t,s?.precision,s?.scale)}i(Cl,"numeric");S();w();b();var Co=class extends W{static{i(this,"PgPointTupleBuilder")}static[T]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new To(e,this.config)}},To=class extends V{static{i(this,"PgPointTuple")}static[T]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,s]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(s)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Po=class extends W{static{i(this,"PgPointObjectBuilder")}static[T]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new Ao(e,this.config)}},Ao=class extends V{static{i(this,"PgPointObject")}static[T]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,s]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(s)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}};function Tl(r,e){let{name:t,config:s}=le(r,e);return!s?.mode||s.mode==="tuple"?new Co(t):new Po(t)}i(Tl,"point");S();w();b();S();w();b();function X0(r){let e=[];for(let t=0;t<r.length;t+=2)e.push(Number.parseInt(r.slice(t,t+2),16));return new Uint8Array(e)}i(X0,"hexToBytes");function Pl(r,e){let t=new ArrayBuffer(8),s=new DataView(t);for(let n=0;n<8;n++)s.setUint8(n,r[e+n]);return s.getFloat64(0,!0)}i(Pl,"bytesToFloat64");function Ro(r){let e=X0(r),t=0,s=e[t];t+=1;let n=new DataView(e.buffer),o=n.getUint32(t,s===1);t+=4;let a;if(o&536870912&&(a=n.getUint32(t,s===1),t+=4),(o&65535)===1){let c=Pl(e,t);t+=8;let l=Pl(e,t);return t+=8,[c,l]}throw new Error("Unsupported geometry type")}i(Ro,"parseEWKB");var No=class extends W{static{i(this,"PgGeometryBuilder")}static[T]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Oo(e,this.config)}},Oo=class extends V{static{i(this,"PgGeometry")}static[T]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Ro(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},Io=class extends W{static{i(this,"PgGeometryObjectBuilder")}static[T]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new Lo(e,this.config)}},Lo=class extends V{static{i(this,"PgGeometryObject")}static[T]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=Ro(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}};function Al(r,e){let{name:t,config:s}=le(r,e);return!s?.mode||s.mode==="tuple"?new No(t):new Io(t)}i(Al,"geometry");S();w();b();var Mo=class extends W{static{i(this,"PgRealBuilder")}static[T]="PgRealBuilder";constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new Do(e,this.config)}},Do=class extends V{static{i(this,"PgReal")}static[T]="PgReal";constructor(e,t){super(e,t)}getSQLType(){return"real"}mapFromDriverValue=i(e=>typeof e=="string"?Number.parseFloat(e):e,"mapFromDriverValue")};function Rl(r){return new Mo(r??"")}i(Rl,"real");S();w();b();var Bo=class extends W{static{i(this,"PgSerialBuilder")}static[T]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new ko(e,this.config)}},ko=class extends V{static{i(this,"PgSerial")}static[T]="PgSerial";getSQLType(){return"serial"}};function Nl(r){return new Bo(r??"")}i(Nl,"serial");S();w();b();var Fo=class extends gt{static{i(this,"PgSmallIntBuilder")}static[T]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new qo(e,this.config)}},qo=class extends V{static{i(this,"PgSmallInt")}static[T]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=i(e=>typeof e=="string"?Number(e):e,"mapFromDriverValue")};function Ol(r){return new Fo(r??"")}i(Ol,"smallint");S();w();b();var Qo=class extends W{static{i(this,"PgSmallSerialBuilder")}static[T]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Uo(e,this.config)}},Uo=class extends V{static{i(this,"PgSmallSerial")}static[T]="PgSmallSerial";getSQLType(){return"smallserial"}};function Il(r){return new Qo(r??"")}i(Il,"smallserial");S();w();b();var $o=class extends W{static{i(this,"PgTextBuilder")}static[T]="PgTextBuilder";constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new jo(e,this.config)}},jo=class extends V{static{i(this,"PgText")}static[T]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}};function Mt(r,e={}){let{name:t,config:s}=le(r,e);return new $o(t,s)}i(Mt,"text");S();w();b();var Ho=class extends ht{static{i(this,"PgTimeBuilder")}constructor(e,t,s){super(e,"string","PgTime"),this.withTimezone=t,this.precision=s,this.config.withTimezone=t,this.config.precision=s}static[T]="PgTimeBuilder";build(e){return new Br(e,this.config)}},Br=class extends V{static{i(this,"PgTime")}static[T]="PgTime";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function Ll(r,e={}){let{name:t,config:s}=le(r,e);return new Ho(t,s.withTimezone??!1,s.precision)}i(Ll,"time");S();w();b();var Vo=class extends ht{static{i(this,"PgTimestampBuilder")}static[T]="PgTimestampBuilder";constructor(e,t,s){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=s}build(e){return new kr(e,this.config)}},kr=class extends V{static{i(this,"PgTimestamp")}static[T]="PgTimestamp";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=i(e=>new Date(this.withTimezone?e:e+"+0000"),"mapFromDriverValue");mapToDriverValue=i(e=>e.toISOString(),"mapToDriverValue")},Ko=class extends ht{static{i(this,"PgTimestampStringBuilder")}static[T]="PgTimestampStringBuilder";constructor(e,t,s){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=s}build(e){return new Fr(e,this.config)}},Fr=class extends V{static{i(this,"PgTimestampString")}static[T]="PgTimestampString";withTimezone;precision;constructor(e,t){super(e,t),this.withTimezone=t.withTimezone,this.precision=t.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};function Ml(r,e={}){let{name:t,config:s}=le(r,e);return s?.mode==="string"?new Ko(t,s.withTimezone??!1,s.precision):new Vo(t,s?.withTimezone??!1,s?.precision)}i(Ml,"timestamp");S();w();b();var zo=class extends W{static{i(this,"PgUUIDBuilder")}static[T]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(O`gen_random_uuid()`)}build(e){return new qr(e,this.config)}},qr=class extends V{static{i(this,"PgUUID")}static[T]="PgUUID";getSQLType(){return"uuid"}};function Dl(r){return new zo(r??"")}i(Dl,"uuid");S();w();b();var Wo=class extends W{static{i(this,"PgVarcharBuilder")}static[T]="PgVarcharBuilder";constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Go(e,this.config)}},Go=class extends V{static{i(this,"PgVarchar")}static[T]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};function Bl(r,e={}){let{name:t,config:s}=le(r,e);return new Wo(t,s)}i(Bl,"varchar");S();w();b();var Yo=class extends W{static{i(this,"PgBinaryVectorBuilder")}static[T]="PgBinaryVectorBuilder";constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new Jo(e,this.config)}},Jo=class extends V{static{i(this,"PgBinaryVector")}static[T]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}};function kl(r,e){let{name:t,config:s}=le(r,e);return new Yo(t,s)}i(kl,"bit");S();w();b();var Xo=class extends W{static{i(this,"PgHalfVectorBuilder")}static[T]="PgHalfVectorBuilder";constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new Zo(e,this.config)}},Zo=class extends V{static{i(this,"PgHalfVector")}static[T]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function Fl(r,e){let{name:t,config:s}=le(r,e);return new Xo(t,s)}i(Fl,"halfvec");S();w();b();var ea=class extends W{static{i(this,"PgSparseVectorBuilder")}static[T]="PgSparseVectorBuilder";constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new ta(e,this.config)}},ta=class extends V{static{i(this,"PgSparseVector")}static[T]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}};function ql(r,e){let{name:t,config:s}=le(r,e);return new ea(t,s)}i(ql,"sparsevec");S();w();b();var ra=class extends W{static{i(this,"PgVectorBuilder")}static[T]="PgVectorBuilder";constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new sa(e,this.config)}},sa=class extends V{static{i(this,"PgVector")}static[T]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){return e.slice(1,-1).split(",").map(t=>Number.parseFloat(t))}};function Ql(r,e){let{name:t,config:s}=le(r,e);return new ra(t,s)}i(Ql,"vector");S();w();b();S();w();b();S();w();b();var Ue=class{static{i(this,"QueryPromise")}static[T]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};S();w();b();var Re=class r{static{i(this,"SelectionProxyHandler")}static[T]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===ve)return{...e[ve],selectedFields:new Proxy(e[ve].selectedFields,this)};if(typeof t=="symbol")return e[t];let n=(U(e,Ae)?e._.selectedFields:U(e,je)?e[ve].selectedFields:e)[t];if(U(n,J.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!n.isSelectionField)return n.sql;let o=n.clone();return o.isSelectionField=!0,o}if(U(n,J)){if(this.config.sqlBehavior==="sql")return n;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return U(n,ye)?this.config.alias?new Proxy(n,new Lt(new Proxy(n.table,new Kt(this.config.alias,this.config.replaceOriginalName??!1)))):n:typeof n!="object"||n===null?n:new Proxy(n,new r(this.config))}};S();w();b();S();w();b();S();w();b();function Ul(){return{bigint:hl,bigserial:fl,boolean:zt,char:pl,cidr:dl,customType:vt,date:ml,doublePrecision:yl,inet:gl,integer:bl,interval:wl,json:Sl,jsonb:vl,line:_l,macaddr:El,macaddr8:xl,numeric:Cl,point:Tl,geometry:Al,real:Rl,serial:Nl,smallint:Ol,smallserial:Il,text:Mt,time:Ll,timestamp:Ml,uuid:Dl,varchar:Bl,bit:kl,halfvec:Fl,sparsevec:ql,vector:Ql}}i(Ul,"getPgColumnBuilders");var na=Symbol.for("drizzle:PgInlineForeignKeys"),$l=Symbol.for("drizzle:EnableRLS"),De=class extends z{static{i(this,"PgTable")}static[T]="PgTable";static Symbol=Object.assign({},z.Symbol,{InlineForeignKeys:na,EnableRLS:$l});[na]=[];[$l]=!1;[z.Symbol.ExtraConfigBuilder]=void 0;[z.Symbol.ExtraConfigColumns]={}};function Z0(r,e,t,s,n=r){let o=new De(r,s,n),a=typeof e=="function"?e(Ul()):e,c=Object.fromEntries(Object.entries(a).map(([f,v])=>{let y=v;y.setName(f);let x=y.build(o);return o[na].push(...y.buildForeignKeys(x,o)),[f,x]})),l=Object.fromEntries(Object.entries(a).map(([f,v])=>{let y=v;y.setName(f);let x=y.buildExtraConfigColumn(o);return[f,x]})),d=Object.assign(o,c);return d[z.Symbol.Columns]=c,d[z.Symbol.ExtraConfigColumns]=l,t&&(d[De.Symbol.ExtraConfigBuilder]=t),Object.assign(d,{enableRLS:i(()=>(d[De.Symbol.EnableRLS]=!0,d),"enableRLS")})}i(Z0,"pgTableWithSchema");var Ns=i((r,e,t)=>Z0(r,e,t,void 0),"pgTable");S();w();b();var Os=class{static{i(this,"PrimaryKeyBuilder")}static[T]="PgPrimaryKeyBuilder";columns;name;constructor(e,t){this.columns=e,this.name=t}build(e){return new ia(e,this.columns,this.name)}},ia=class{static{i(this,"PrimaryKey")}constructor(e,t,s){this.table=e,this.columns=t,this.name=s}static[T]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[De.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};S();w();b();S();w();b();S();w();b();function ew(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}i(ew,"toSnakeCase");function tw(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,s,n)=>{let o=n===0?s.toLowerCase():`${s[0].toUpperCase()}${s.slice(1)}`;return t+o},"")}i(tw,"toCamelCase");function rw(r){return r}i(rw,"noopCase");var Is=class{static{i(this,"CasingCache")}static[T]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?ew:e==="camelCase"?tw:rw}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[z.Symbol.Schema]??"public",s=e.table[z.Symbol.OriginalName],n=`${t}.${s}.${e.name}`;return this.cache[n]||this.cacheTable(e.table),this.cache[n]}cacheTable(e){let t=e[z.Symbol.Schema]??"public",s=e[z.Symbol.OriginalName],n=`${t}.${s}`;if(!this.cachedTables[n]){for(let o of Object.values(e[z.Symbol.Columns])){let a=`${n}.${o.name}`;this.cache[a]=this.convert(o.name)}this.cachedTables[n]=!0}}clearCache(){this.cache={},this.cachedTables={}}};S();w();b();var Qr=class extends Error{static{i(this,"DrizzleError")}static[T]="DrizzleError";constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}},Ls=class extends Qr{static{i(this,"TransactionRollbackError")}static[T]="TransactionRollbackError";constructor(){super({message:"Rollback"})}};S();w();b();S();w();b();function ze(r,e){return il(e)&&!Di(r)&&!U(r,Ke)&&!U(r,mt)&&!U(r,ye)&&!U(r,z)&&!U(r,je)?new Ke(r,e):r}i(ze,"bindIfParam");var Ms=i((r,e)=>O`${r} = ${ze(e,r)}`,"eq"),jl=i((r,e)=>O`${r} <> ${ze(e,r)}`,"ne");function Ur(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new J(e):new J([new Me("("),O.join(e,new Me(" and ")),new Me(")")])}i(Ur,"and");function Hl(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new J(e):new J([new Me("("),O.join(e,new Me(" or ")),new Me(")")])}i(Hl,"or");function Vl(r){return O`not ${r}`}i(Vl,"not");var Kl=i((r,e)=>O`${r} > ${ze(e,r)}`,"gt"),zl=i((r,e)=>O`${r} >= ${ze(e,r)}`,"gte"),Wl=i((r,e)=>O`${r} < ${ze(e,r)}`,"lt"),Gl=i((r,e)=>O`${r} <= ${ze(e,r)}`,"lte");function Yl(r,e){return Array.isArray(e)?e.length===0?O`false`:O`${r} in ${e.map(t=>ze(t,r))}`:O`${r} in ${ze(e,r)}`}i(Yl,"inArray");function Jl(r,e){return Array.isArray(e)?e.length===0?O`true`:O`${r} not in ${e.map(t=>ze(t,r))}`:O`${r} not in ${ze(e,r)}`}i(Jl,"notInArray");function Xl(r){return O`${r} is null`}i(Xl,"isNull");function Zl(r){return O`${r} is not null`}i(Zl,"isNotNull");function eh(r){return O`exists ${r}`}i(eh,"exists");function th(r){return O`not exists ${r}`}i(th,"notExists");function rh(r,e,t){return O`${r} between ${ze(e,r)} and ${ze(t,r)}`}i(rh,"between");function sh(r,e,t){return O`${r} not between ${ze(e,r)} and ${ze(t,r)}`}i(sh,"notBetween");function nh(r,e){return O`${r} like ${e}`}i(nh,"like");function ih(r,e){return O`${r} not like ${e}`}i(ih,"notLike");function oh(r,e){return O`${r} ilike ${e}`}i(oh,"ilike");function ah(r,e){return O`${r} not ilike ${e}`}i(ah,"notIlike");S();w();b();function ch(r){return O`${r} asc`}i(ch,"asc");function uh(r){return O`${r} desc`}i(uh,"desc");var Ds=class{static{i(this,"Relation")}constructor(e,t,s){this.sourceTable=e,this.referencedTable=t,this.relationName=s,this.referencedTableName=t[z.Symbol.Name]}static[T]="Relation";referencedTableName;fieldName},oa=class{static{i(this,"Relations")}constructor(e,t){this.table=e,this.config=t}static[T]="Relations"},_t=class r extends Ds{static{i(this,"One")}constructor(e,t,s,n){super(e,t,s?.relationName),this.config=s,this.isNullable=n}static[T]="One";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},$r=class r extends Ds{static{i(this,"Many")}constructor(e,t,s){super(e,t,s?.relationName),this.config=s}static[T]="Many";withFieldName(e){let t=new r(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}};function lh(){return{and:Ur,between:rh,eq:Ms,exists:eh,gt:Kl,gte:zl,ilike:oh,inArray:Yl,isNull:Xl,isNotNull:Zl,like:nh,lt:Wl,lte:Gl,ne:jl,not:Vl,notBetween:sh,notExists:th,notLike:ih,notIlike:ah,notInArray:Jl,or:Hl,sql:O}}i(lh,"getOperators");function hh(){return{sql:O,asc:ch,desc:uh}}i(hh,"getOrderByOperators");function ks(r,e){Object.keys(r).length===1&&"default"in r&&!U(r.default,z)&&(r=r.default);let t={},s={},n={};for(let[o,a]of Object.entries(r))if(U(a,z)){let c=Ot(a),l=s[c];t[c]=o,n[o]={tsName:o,dbName:a[z.Symbol.Name],schema:a[z.Symbol.Schema],columns:a[z.Symbol.Columns],relations:l?.relations??{},primaryKey:l?.primaryKey??[]};for(let f of Object.values(a[z.Symbol.Columns]))f.primary&&n[o].primaryKey.push(f);let d=a[z.Symbol.ExtraConfigBuilder]?.(a[z.Symbol.ExtraConfigColumns]);if(d)for(let f of Object.values(d))U(f,Os)&&n[o].primaryKey.push(...f.columns)}else if(U(a,oa)){let c=Ot(a.table),l=t[c],d=a.config(e(a.table)),f;for(let[v,y]of Object.entries(d))if(l){let x=n[l];x.relations[v]=y,f&&x.primaryKey.push(...f)}else c in s||(s[c]={relations:{},primaryKey:f}),s[c].relations[v]=y}return{tables:n,tableNamesMap:t}}i(ks,"extractTablesRelationalConfig");function sw(r){return i(function(t,s){return new _t(r,t,s,s?.fields.reduce((n,o)=>n&&o.notNull,!0)??!1)},"one")}i(sw,"createOne");function nw(r){return i(function(t,s){return new $r(r,t,s)},"many")}i(nw,"createMany");function fh(r,e,t){if(U(t,_t)&&t.config)return{fields:t.config.fields,references:t.config.references};let s=e[Ot(t.referencedTable)];if(!s)throw new Error(`Table "${t.referencedTable[z.Symbol.Name]}" not found in schema`);let n=r[s];if(!n)throw new Error(`Table "${s}" not found in schema`);let o=t.sourceTable,a=e[Ot(o)];if(!a)throw new Error(`Table "${o[z.Symbol.Name]}" not found in schema`);let c=[];for(let l of Object.values(n.relations))(t.relationName&&t!==l&&l.relationName===t.relationName||!t.relationName&&l.referencedTable===t.sourceTable)&&c.push(l);if(c.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${s}"`):new Error(`There are multiple relations between "${s}" and "${t.sourceTable[z.Symbol.Name]}". Please specify relation name`);if(c[0]&&U(c[0],_t)&&c[0].config)return{fields:c[0].config.references,references:c[0].config.fields};throw new Error(`There is not enough information to infer relation "${a}.${t.fieldName}"`)}i(fh,"normalizeRelation");function Fs(r){return{one:sw(r),many:nw(r)}}i(Fs,"createTableRelationsHelpers");function Bs(r,e,t,s,n=o=>o){let o={};for(let[a,c]of s.entries())if(c.isJson){let l=e.relations[c.tsKey],d=t[a],f=typeof d=="string"?JSON.parse(d):d;o[c.tsKey]=U(l,_t)?f&&Bs(r,r[c.relationTableTsKey],f,c.selection,n):f.map(v=>Bs(r,r[c.relationTableTsKey],v,c.selection,n))}else{let l=n(t[a]),d=c.field,f;U(d,ye)?f=d:U(d,J)?f=d.decoder:f=d.sql.decoder,o[c.tsKey]=l===null?null:f.mapFromDriverValue(l)}return o}i(Bs,"mapRelationalRow");S();w();b();var Wt=class extends je{static{i(this,"PgViewBase")}static[T]="PgViewBase"};var ft=class{static{i(this,"PgDialect")}static[T]="PgDialect";casing;constructor(e){this.casing=new Is(e?.casing)}async migrate(e,t,s){let n=typeof s=="string"?"__drizzle_migrations":s.migrationsTable??"__drizzle_migrations",o=typeof s=="string"?"drizzle":s.migrationsSchema??"drizzle",a=O`
			CREATE TABLE IF NOT EXISTS ${O.identifier(o)}.${O.identifier(n)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(O`CREATE SCHEMA IF NOT EXISTS ${O.identifier(o)}`),await t.execute(a);let l=(await t.all(O`select id, hash, created_at from ${O.identifier(o)}.${O.identifier(n)} order by created_at desc limit 1`))[0];await t.transaction(async d=>{for await(let f of e)if(!l||Number(l.created_at)<f.folderMillis){for(let v of f.sql)await d.execute(O.raw(v));await d.execute(O`insert into ${O.identifier(o)}.${O.identifier(n)} ("hash", "created_at") values(${f.hash}, ${f.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[O`with `];for(let[s,n]of e.entries())t.push(O`${O.identifier(n._.alias)} as (${n._.sql})`),s<e.length-1&&t.push(O`, `);return t.push(O` `),O.join(t)}buildDeleteQuery({table:e,where:t,returning:s,withList:n}){let o=this.buildWithCTE(n),a=s?O` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,c=t?O` where ${t}`:void 0;return O`${o}delete from ${e}${c}${a}`}buildUpdateSet(e,t){let s=e[z.Symbol.Columns],n=Object.keys(s).filter(a=>t[a]!==void 0||s[a]?.onUpdateFn!==void 0),o=n.length;return O.join(n.flatMap((a,c)=>{let l=s[a],d=t[a]??O.param(l.onUpdateFn(),l),f=O`${O.identifier(this.casing.getColumnCasing(l))} = ${d}`;return c<o-1?[f,O.raw(", ")]:[f]}))}buildUpdateQuery({table:e,set:t,where:s,returning:n,withList:o,from:a,joins:c}){let l=this.buildWithCTE(o),d=e[De.Symbol.Name],f=e[De.Symbol.Schema],v=e[De.Symbol.OriginalName],y=d===v?void 0:d,x=O`${f?O`${O.identifier(f)}.`:void 0}${O.identifier(v)}${y&&O` ${O.identifier(y)}`}`,m=this.buildUpdateSet(e,t),h=a&&O.join([O.raw(" from "),this.buildFromTable(a)]),E=this.buildJoins(c),C=n?O` returning ${this.buildSelection(n,{isSingleTable:!a})}`:void 0,P=s?O` where ${s}`:void 0;return O`${l}update ${x} set ${m}${h}${E}${P}${C}`}buildSelection(e,{isSingleTable:t=!1}={}){let s=e.length,n=e.flatMap(({field:o},a)=>{let c=[];if(U(o,J.Aliased)&&o.isSelectionField)c.push(O.identifier(o.fieldAlias));else if(U(o,J.Aliased)||U(o,J)){let l=U(o,J.Aliased)?o.sql:o;t?c.push(new J(l.queryChunks.map(d=>U(d,V)?O.identifier(this.casing.getColumnCasing(d)):d))):c.push(l),U(o,J.Aliased)&&c.push(O` as ${O.identifier(o.fieldAlias)}`)}else U(o,ye)&&(t?c.push(O.identifier(this.casing.getColumnCasing(o))):c.push(o));return a<s-1&&c.push(O`, `),c});return O.join(n)}buildJoins(e){if(!e||e.length===0)return;let t=[];for(let[s,n]of e.entries()){s===0&&t.push(O` `);let o=n.table,a=n.lateral?O` lateral`:void 0,c=n.on?O` on ${n.on}`:void 0;if(U(o,De)){let l=o[De.Symbol.Name],d=o[De.Symbol.Schema],f=o[De.Symbol.OriginalName],v=l===f?void 0:n.alias;t.push(O`${O.raw(n.joinType)} join${a} ${d?O`${O.identifier(d)}.`:void 0}${O.identifier(f)}${v&&O` ${O.identifier(v)}`}${c}`)}else if(U(o,je)){let l=o[ve].name,d=o[ve].schema,f=o[ve].originalName,v=l===f?void 0:n.alias;t.push(O`${O.raw(n.joinType)} join${a} ${d?O`${O.identifier(d)}.`:void 0}${O.identifier(f)}${v&&O` ${O.identifier(v)}`}${c}`)}else t.push(O`${O.raw(n.joinType)} join${a} ${o}${c}`);s<e.length-1&&t.push(O` `)}return O.join(t)}buildFromTable(e){if(U(e,z)&&e[z.Symbol.IsAlias]){let t=O`${O.identifier(e[z.Symbol.OriginalName])}`;return e[z.Symbol.Schema]&&(t=O`${O.identifier(e[z.Symbol.Schema])}.${t}`),O`${t} ${O.identifier(e[z.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:s,where:n,having:o,table:a,joins:c,orderBy:l,groupBy:d,limit:f,offset:v,lockingClause:y,distinct:x,setOperators:m}){let h=s??et(t);for(let q of h)if(U(q.field,ye)&&Ve(q.field.table)!==(U(a,Ae)?a._.alias:U(a,Wt)?a[ve].name:U(a,J)?void 0:Ve(a))&&!(K=>c?.some(({alias:ee})=>ee===(K[z.Symbol.IsAlias]?Ve(K):K[z.Symbol.BaseName])))(q.field.table)){let K=Ve(q.field.table);throw new Error(`Your "${q.path.join("->")}" field references a column "${K}"."${q.field.name}", but the table "${K}" is not part of the query! Did you forget to join it?`)}let E=!c||c.length===0,C=this.buildWithCTE(e),P;x&&(P=x===!0?O` distinct`:O` distinct on (${O.join(x.on,O`, `)})`);let A=this.buildSelection(h,{isSingleTable:E}),B=this.buildFromTable(a),k=this.buildJoins(c),R=n?O` where ${n}`:void 0,L=o?O` having ${o}`:void 0,M;l&&l.length>0&&(M=O` order by ${O.join(l,O`, `)}`);let N;d&&d.length>0&&(N=O` group by ${O.join(d,O`, `)}`);let Q=typeof f=="object"||typeof f=="number"&&f>=0?O` limit ${f}`:void 0,F=v?O` offset ${v}`:void 0,G=O.empty();if(y){let q=O` for ${O.raw(y.strength)}`;y.config.of&&q.append(O` of ${O.join(Array.isArray(y.config.of)?y.config.of:[y.config.of],O`, `)}`),y.config.noWait?q.append(O` nowait`):y.config.skipLocked&&q.append(O` skip locked`),G.append(q)}let Y=O`${C}select${P} ${A} from ${B}${k}${R}${N}${L}${M}${Q}${F}${G}`;return m.length>0?this.buildSetOperations(Y,m):Y}buildSetOperations(e,t){let[s,...n]=t;if(!s)throw new Error("Cannot pass undefined values to any set operator");return n.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:s}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:s}),n)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:s,rightSelect:n,limit:o,orderBy:a,offset:c}}){let l=O`(${e.getSQL()}) `,d=O`(${n.getSQL()})`,f;if(a&&a.length>0){let m=[];for(let h of a)if(U(h,V))m.push(O.identifier(h.name));else if(U(h,J)){for(let E=0;E<h.queryChunks.length;E++){let C=h.queryChunks[E];U(C,V)&&(h.queryChunks[E]=O.identifier(C.name))}m.push(O`${h}`)}else m.push(O`${h}`);f=O` order by ${O.join(m,O`, `)} `}let v=typeof o=="object"||typeof o=="number"&&o>=0?O` limit ${o}`:void 0,y=O.raw(`${t} ${s?"all ":""}`),x=c?O` offset ${c}`:void 0;return O`${l}${y}${d}${f}${v}${x}`}buildInsertQuery({table:e,values:t,onConflict:s,returning:n,withList:o,select:a,overridingSystemValue_:c}){let l=[],d=e[z.Symbol.Columns],f=Object.entries(d).filter(([C,P])=>!P.shouldDisableInsert()),v=f.map(([,C])=>O.identifier(this.casing.getColumnCasing(C)));if(a){let C=t;U(C,J)?l.push(C):l.push(C.getSQL())}else{let C=t;l.push(O.raw("values "));for(let[P,A]of C.entries()){let B=[];for(let[k,R]of f){let L=A[k];if(L===void 0||U(L,Ke)&&L.value===void 0)if(R.defaultFn!==void 0){let M=R.defaultFn(),N=U(M,J)?M:O.param(M,R);B.push(N)}else if(!R.default&&R.onUpdateFn!==void 0){let M=R.onUpdateFn(),N=U(M,J)?M:O.param(M,R);B.push(N)}else B.push(O`default`);else B.push(L)}l.push(B),P<C.length-1&&l.push(O`, `)}}let y=this.buildWithCTE(o),x=O.join(l),m=n?O` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,h=s?O` on conflict ${s}`:void 0,E=c===!0?O`overriding system value `:void 0;return O`${y}insert into ${e} ${v} ${E}${x}${h}${m}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:s}){let n=t?O` concurrently`:void 0,o=s?O` with no data`:void 0;return O`refresh materialized view${n} ${e}${o}`}prepareTyping(e){return U(e,Mr)||U(e,Lr)?"json":U(e,Dr)?"decimal":U(e,Br)?"time":U(e,kr)||U(e,Fr)?"timestamp":U(e,Or)||U(e,Ir)?"date":U(e,qr)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:s,table:n,tableConfig:o,queryConfig:a,tableAlias:c,nestedQueryRelation:l,joinOn:d}){let f=[],v,y,x=[],m,h=[];if(a===!0)f=Object.entries(o.columns).map(([P,A])=>({dbKey:A.name,tsKey:P,field:lt(A,c),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let C=Object.fromEntries(Object.entries(o.columns).map(([L,M])=>[L,lt(M,c)]));if(a.where){let L=typeof a.where=="function"?a.where(C,lh()):a.where;m=L&&Rr(L,c)}let P=[],A=[];if(a.columns){let L=!1;for(let[M,N]of Object.entries(a.columns))N!==void 0&&M in o.columns&&(!L&&N===!0&&(L=!0),A.push(M));A.length>0&&(A=L?A.filter(M=>a.columns?.[M]===!0):Object.keys(o.columns).filter(M=>!A.includes(M)))}else A=Object.keys(o.columns);for(let L of A){let M=o.columns[L];P.push({tsKey:L,value:M})}let B=[];a.with&&(B=Object.entries(a.with).filter(L=>!!L[1]).map(([L,M])=>({tsKey:L,queryConfig:M,relation:o.relations[L]})));let k;if(a.extras){k=typeof a.extras=="function"?a.extras(C,{sql:O}):a.extras;for(let[L,M]of Object.entries(k))P.push({tsKey:L,value:Bi(M,c)})}for(let{tsKey:L,value:M}of P)f.push({dbKey:U(M,J.Aliased)?M.fieldAlias:o.columns[L].name,tsKey:L,field:U(M,ye)?lt(M,c):M,relationTableTsKey:void 0,isJson:!1,selection:[]});let R=typeof a.orderBy=="function"?a.orderBy(C,hh()):a.orderBy??[];Array.isArray(R)||(R=[R]),x=R.map(L=>U(L,ye)?lt(L,c):Rr(L,c)),v=a.limit,y=a.offset;for(let{tsKey:L,queryConfig:M,relation:N}of B){let Q=fh(t,s,N),F=Ot(N.referencedTable),G=s[F],Y=`${c}_${L}`,q=Ur(...Q.fields.map((oe,he)=>Ms(lt(Q.references[he],Y),lt(oe,c)))),K=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:s,table:e[G],tableConfig:t[G],queryConfig:U(N,_t)?M===!0?{limit:1}:{...M,limit:1}:M,tableAlias:Y,joinOn:q,nestedQueryRelation:N}),ee=O`${O.identifier(Y)}.${O.identifier("data")}`.as(L);h.push({on:O`true`,table:new Ae(K.sql,{},Y),alias:Y,joinType:"left",lateral:!0}),f.push({dbKey:L,tsKey:L,field:ee,relationTableTsKey:G,isJson:!0,selection:K.selection})}}if(f.length===0)throw new Qr({message:`No fields selected for table "${o.tsName}" ("${c}")`});let E;if(m=Ur(d,m),l){let C=O`json_build_array(${O.join(f.map(({field:B,tsKey:k,isJson:R})=>R?O`${O.identifier(`${c}_${k}`)}.${O.identifier("data")}`:U(B,J.Aliased)?B.sql:B),O`, `)})`;U(l,$r)&&(C=O`coalesce(json_agg(${C}${x.length>0?O` order by ${O.join(x,O`, `)}`:void 0}), '[]'::json)`);let P=[{dbKey:"data",tsKey:"data",field:C.as("data"),isJson:!0,relationTableTsKey:o.tsName,selection:f}];v!==void 0||y!==void 0||x.length>0?(E=this.buildSelectQuery({table:Ar(n,c),fields:{},fieldsFlat:[{path:[],field:O.raw("*")}],where:m,limit:v,offset:y,orderBy:x,setOperators:[]}),m=void 0,v=void 0,y=void 0,x=[]):E=Ar(n,c),E=this.buildSelectQuery({table:U(E,De)?E:new Ae(E,{},c),fields:{},fieldsFlat:P.map(({field:B})=>({path:[],field:U(B,ye)?lt(B,c):B})),joins:h,where:m,limit:v,offset:y,orderBy:x,setOperators:[]})}else E=this.buildSelectQuery({table:Ar(n,c),fields:{},fieldsFlat:f.map(({field:C})=>({path:[],field:U(C,ye)?lt(C,c):C})),joins:h,where:m,limit:v,offset:y,orderBy:x,setOperators:[]});return{tableTsKey:o.tsName,sql:E,selection:f}}};S();w();b();S();w();b();var qs=class{static{i(this,"TypedQueryBuilder")}static[T]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}};var $e=class{static{i(this,"PgSelectBuilder")}static[T]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(e){this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}authToken;setToken(e){return this.authToken=e,this}from(e){let t=!!this.fields,s=e,n;return this.fields?n=this.fields:U(s,Ae)?n=Object.fromEntries(Object.keys(s._.selectedFields).map(o=>[o,s[o]])):U(s,Wt)?n=s[ve].selectedFields:U(s,J)?n={}:n=ll(s),new Qs({table:s,fields:n,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}},aa=class extends qs{static{i(this,"PgSelectQueryBuilderBase")}static[T]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:e,fields:t,isPartialSelect:s,session:n,dialect:o,withList:a,distinct:c}){super(),this.config={withList:a,table:e,fields:{...t},distinct:c,setOperators:[]},this.isPartialSelect=s,this.session=n,this.dialect=o,this._={selectedFields:t,config:this.config},this.tableName=yt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{};for(let l of ct(e))this.usedTables.add(l)}getUsedTables(){return[...this.usedTables]}createJoin(e,t){return(s,n)=>{let o=this.tableName,a=yt(s);for(let c of ct(s))this.usedTables.add(c);if(typeof a=="string"&&this.config.joins?.some(c=>c.alias===a))throw new Error(`Alias "${a}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof o=="string"&&(this.config.fields={[o]:this.config.fields}),typeof a=="string"&&!U(s,J))){let c=U(s,Ae)?s._.selectedFields:U(s,je)?s[ve].selectedFields:s[z.Symbol.Columns];this.config.fields[a]=c}if(typeof n=="function"&&(n=n(new Proxy(this.config.fields,new Re({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:n,table:s,joinType:e,alias:a,lateral:t}),typeof a=="string")switch(e){case"left":{this.joinsNotNullableMap[a]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([c])=>[c,!1])),this.joinsNotNullableMap[a]=!0;break}case"cross":case"inner":{this.joinsNotNullableMap[a]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([c])=>[c,!1])),this.joinsNotNullableMap[a]=!1;break}}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);fullJoin=this.createJoin("full",!1);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(e,t){return s=>{let n=typeof s=="function"?s(iw()):s;if(!Nr(this.getSelectedFields(),n.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:e,isAll:t,rightSelect:n}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(e){return this.config.setOperators.push(...e),this}where(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Re({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=e,this}having(e){return typeof e=="function"&&(e=e(new Proxy(this.config.fields,new Re({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=e,this}groupBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new Re({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(t)?t:[t]}else this.config.groupBy=e;return this}orderBy(...e){if(typeof e[0]=="function"){let t=e[0](new Proxy(this.config.fields,new Re({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),s=Array.isArray(t)?t:[t];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=s:this.config.orderBy=s}else{let t=e;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=t:this.config.orderBy=t}return this}limit(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=e:this.config.limit=e,this}offset(e){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=e:this.config.offset=e,this}for(e,t={}){return this.config.lockingClause={strength:e,config:t},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}as(e){let t=[];if(t.push(...ct(this.config.table)),this.config.joins)for(let s of this.config.joins)t.push(...ct(s.table));return new Proxy(new Ae(this.getSQL(),this.config.fields,e,!1,[...new Set(t)]),new Re({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new Re({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(e){return this.cacheConfig=e===void 0?{config:{},enable:!0,autoInvalidate:!0}:e===!1?{enable:!1}:{enable:!0,autoInvalidate:!0,...e},this}},Qs=class extends aa{static{i(this,"PgSelectBase")}static[T]="PgSelect";_prepare(e){let{session:t,config:s,dialect:n,joinsNotNullableMap:o,authToken:a,cacheConfig:c,usedTables:l}=this;if(!t)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");let{fields:d}=s;return ge.startActiveSpan("drizzle.prepareQuery",()=>{let f=et(d),v=t.prepareQuery(n.sqlToQuery(this.getSQL()),f,e,!0,void 0,{type:"select",tables:[...l]},c);return v.joinsNotNullableMap=o,v.setToken(a)})}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=i(e=>ge.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken)),"execute")};ul(Qs,[Ue]);function Gt(r,e){return(t,s,...n)=>{let o=[s,...n].map(a=>({type:r,isAll:e,rightSelect:a}));for(let a of o)if(!Nr(t.getSelectedFields(),a.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(o)}}i(Gt,"createSetOperator");var iw=i(()=>({union:ow,unionAll:aw,intersect:cw,intersectAll:uw,except:lw,exceptAll:hw}),"getPgSetOperators"),ow=Gt("union",!1),aw=Gt("union",!0),cw=Gt("intersect",!1),uw=Gt("intersect",!0),lw=Gt("except",!1),hw=Gt("except",!0);var Yt=class{static{i(this,"QueryBuilder")}static[T]="PgQueryBuilder";dialect;dialectConfig;constructor(e){this.dialect=U(e,ft)?e:void 0,this.dialectConfig=U(e,ft)?void 0:e}$with=i((e,t)=>{let s=this;return{as:i(o=>(typeof o=="function"&&(o=o(s)),new Proxy(new Vt(o.getSQL(),t??("getSelectedFields"in o?o.getSelectedFields()??{}:{}),e,!0),new Re({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))),"as")}},"$with");with(...e){let t=this;function s(a){return new $e({fields:a??void 0,session:void 0,dialect:t.getDialect(),withList:e})}i(s,"select");function n(a){return new $e({fields:a??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}i(n,"selectDistinct");function o(a,c){return new $e({fields:c??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:a}})}return i(o,"selectDistinctOn"),{select:s,selectDistinct:n,selectDistinctOn:o}}select(e){return new $e({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new $e({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new $e({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new ft(this.dialectConfig)),this.dialect}};function ct(r){return U(r,De)?[r[Nt]?`${r[Nt]}.${r[z.Symbol.BaseName]}`:r[z.Symbol.BaseName]]:U(r,Ae)?r._.usedTables??[]:U(r,J)?r.usedTables??[]:[]}i(ct,"extractUsedTable");var jr=class extends Ue{static{i(this,"PgDeleteBase")}constructor(e,t,s,n){super(),this.session=t,this.dialect=s,this.config={table:e,withList:n}}static[T]="PgDelete";config;cacheConfig;where(e){return this.config.where=e,this}returning(e=this.config.table[z.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=et(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return ge.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"delete",tables:ct(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=i(e=>ge.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken)),"execute");getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Re({alias:Ve(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};S();w();b();var Hr=class{static{i(this,"PgInsertBuilder")}constructor(e,t,s,n,o){this.table=e,this.session=t,this.dialect=s,this.withList=n,this.overridingSystemValue_=o}static[T]="PgInsertBuilder";authToken;setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let t=e.map(s=>{let n={},o=this.table[z.Symbol.Columns];for(let a of Object.keys(s)){let c=s[a];n[a]=U(c,J)?c:new Ke(c,o[a])}return n});return new Us(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let t=typeof e=="function"?e(new Yt):e;if(!U(t,J)&&!Nr(this.table[Ts],t._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new Us(this.table,t,this.session,this.dialect,this.withList,!0)}},Us=class extends Ue{static{i(this,"PgInsertBase")}constructor(e,t,s,n,o,a,c){super(),this.session=s,this.dialect=n,this.config={table:e,values:t,withList:o,select:a,overridingSystemValue_:c}}static[T]="PgInsert";config;cacheConfig;returning(e=this.config.table[z.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=et(e),this}onConflictDoNothing(e={}){if(e.target===void 0)this.config.onConflict=O`do nothing`;else{let t="";t=Array.isArray(e.target)?e.target.map(n=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(n))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target));let s=e.where?O` where ${e.where}`:void 0;this.config.onConflict=O`(${O.raw(t)})${s} do nothing`}return this}onConflictDoUpdate(e){if(e.where&&(e.targetWhere||e.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let t=e.where?O` where ${e.where}`:void 0,s=e.targetWhere?O` where ${e.targetWhere}`:void 0,n=e.setWhere?O` where ${e.setWhere}`:void 0,o=this.dialect.buildUpdateSet(this.config.table,As(this.config.table,e.set)),a="";return a=Array.isArray(e.target)?e.target.map(c=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(c))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(e.target)),this.config.onConflict=O`(${O.raw(a)})${s} do update set ${o}${t}${n}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return ge.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:ct(this.config.table)},this.cacheConfig))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=i(e=>ge.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken)),"execute");getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Re({alias:Ve(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};S();w();b();var $s=class extends Ue{static{i(this,"PgRefreshMaterializedView")}constructor(e,t,s){super(),this.session=t,this.dialect=s,this.config={view:e}}static[T]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){return ge.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=i(e=>ge.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken)),"execute")};S();w();b();var Vr=class{static{i(this,"PgUpdateBuilder")}constructor(e,t,s,n){this.table=e,this.session=t,this.dialect=s,this.withList=n}static[T]="PgUpdateBuilder";authToken;setToken(e){return this.authToken=e,this}set(e){return new ca(this.table,As(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}},ca=class extends Ue{static{i(this,"PgUpdateBase")}constructor(e,t,s,n,o){super(),this.session=s,this.dialect=n,this.config={set:t,table:e,withList:o,joins:[]},this.tableName=yt(e),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}static[T]="PgUpdate";config;tableName;joinsNotNullableMap;cacheConfig;from(e){let t=e,s=yt(t);return typeof s=="string"&&(this.joinsNotNullableMap[s]=!0),this.config.from=t,this}getTableLikeFields(e){return U(e,De)?e[z.Symbol.Columns]:U(e,Ae)?e._.selectedFields:e[ve].selectedFields}createJoin(e){return(t,s)=>{let n=yt(t);if(typeof n=="string"&&this.config.joins.some(o=>o.alias===n))throw new Error(`Alias "${n}" is already used in this query`);if(typeof s=="function"){let o=this.config.from&&!U(this.config.from,J)?this.getTableLikeFields(this.config.from):void 0;s=s(new Proxy(this.config.table[z.Symbol.Columns],new Re({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),o&&new Proxy(o,new Re({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:s,table:t,joinType:e,alias:n}),typeof n=="string")switch(e){case"left":{this.joinsNotNullableMap[n]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[n]=!0;break}case"inner":{this.joinsNotNullableMap[n]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[n]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(e){return this.config.where=e,this}returning(e){if(!e&&(e=Object.assign({},this.config.table[z.Symbol.Columns]),this.config.from)){let t=yt(this.config.from);if(typeof t=="string"&&this.config.from&&!U(this.config.from,J)){let s=this.getTableLikeFields(this.config.from);e[t]=s}for(let s of this.config.joins){let n=yt(s.table);if(typeof n=="string"&&!U(s.table,J)){let o=this.getTableLikeFields(s.table);e[n]=o}}}return this.config.returningFields=e,this.config.returning=et(e),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:e,...t}=this.dialect.sqlToQuery(this.getSQL());return t}_prepare(e){let t=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0,void 0,{type:"insert",tables:ct(this.config.table)},this.cacheConfig);return t.joinsNotNullableMap=this.joinsNotNullableMap,t}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=i(e=>this._prepare().execute(e,this.authToken),"execute");getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Re({alias:Ve(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};S();w();b();var js=class r extends J{static{i(this,"PgCountBuilder")}constructor(e){super(r.buildEmbeddedCount(e.source,e.filters).queryChunks),this.params=e,this.mapWith(Number),this.session=e.session,this.sql=r.buildCount(e.source,e.filters)}sql;token;static[T]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(e,t){return O`(select count(*) from ${e}${O.raw(" where ").if(t)}${t})`}static buildCount(e,t){return O`select count(*) as count from ${e}${O.raw(" where ").if(t)}${t};`}setToken(e){return this.token=e,this}then(e,t){return Promise.resolve(this.session.count(this.sql,this.token)).then(e,t)}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}};S();w();b();var Hs=class{static{i(this,"RelationalQueryBuilder")}constructor(e,t,s,n,o,a,c){this.fullSchema=e,this.schema=t,this.tableNamesMap=s,this.table=n,this.tableConfig=o,this.dialect=a,this.session=c}static[T]="PgRelationalQueryBuilder";findMany(e){return new Vs(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Vs(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}},Vs=class extends Ue{static{i(this,"PgRelationalQuery")}constructor(e,t,s,n,o,a,c,l,d){super(),this.fullSchema=e,this.schema=t,this.tableNamesMap=s,this.table=n,this.tableConfig=o,this.dialect=a,this.session=c,this.config=l,this.mode=d}static[T]="PgRelationalQuery";_prepare(e){return ge.startActiveSpan("drizzle.prepareQuery",()=>{let{query:t,builtQuery:s}=this._toSQL();return this.session.prepareQuery(s,void 0,e,!0,(n,o)=>{let a=n.map(c=>Bs(this.schema,this.tableConfig,c,t.selection,o));return this.mode==="first"?a[0]:a})})}prepare(e){return this._prepare(e)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let e=this._getQuery(),t=this.dialect.sqlToQuery(e.sql);return{query:e,builtQuery:t}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(e){return this.authToken=e,this}execute(){return ge.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};S();w();b();var Ks=class extends Ue{static{i(this,"PgRaw")}constructor(e,t,s,n){super(),this.execute=e,this.sql=t,this.query=s,this.mapBatchResult=n}static[T]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};var Et=class{static{i(this,"PgDatabase")}constructor(e,t,s){if(this.dialect=e,this.session=t,this._=s?{schema:s.schema,fullSchema:s.fullSchema,tableNamesMap:s.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[n,o]of Object.entries(this._.schema))this.query[n]=new Hs(s.fullSchema,this._.schema,this._.tableNamesMap,s.fullSchema[n],o,e,t);this.$cache={invalidate:i(async n=>{},"invalidate")}}static[T]="PgDatabase";query;$with=i((e,t)=>{let s=this;return{as:i(o=>(typeof o=="function"&&(o=o(new Yt(s.dialect))),new Proxy(new Vt(o.getSQL(),t??("getSelectedFields"in o?o.getSelectedFields()??{}:{}),e,!0),new Re({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))),"as")}},"$with");$count(e,t){return new js({source:e,filters:t,session:this.session})}$cache;with(...e){let t=this;function s(d){return new $e({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e})}i(s,"select");function n(d){return new $e({fields:d??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}i(n,"selectDistinct");function o(d,f){return new $e({fields:f??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:d}})}i(o,"selectDistinctOn");function a(d){return new Vr(d,t.session,t.dialect,e)}i(a,"update");function c(d){return new Hr(d,t.session,t.dialect,e)}i(c,"insert");function l(d){return new jr(d,t.session,t.dialect,e)}return i(l,"delete_"),{select:s,selectDistinct:n,selectDistinctOn:o,update:a,insert:c,delete:l}}select(e){return new $e({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new $e({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new $e({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Vr(e,this.session,this.dialect)}insert(e){return new Hr(e,this.session,this.dialect)}delete(e){return new jr(e,this.session,this.dialect)}refreshMaterializedView(e){return new $s(e,this.session,this.dialect)}authToken;execute(e){let t=typeof e=="string"?O.raw(e):e.getSQL(),s=this.dialect.sqlToQuery(t),n=this.session.prepareQuery(s,void 0,void 0,!1);return new Ks(()=>n.execute(void 0,this.authToken),t,s,o=>n.mapResult(o,!0))}transaction(e,t){return this.session.transaction(e,t)}};S();w();b();S();w();b();var ua=class{static{i(this,"Cache")}static[T]="Cache"},xt=class extends ua{static{i(this,"NoopCache")}strategy(){return"all"}static[T]="NoopCache";async get(e){}async put(e,t,s,n){}async onMutate(e){}};async function la(r,e){let t=`${r}-${JSON.stringify(e)}`,n=new TextEncoder().encode(t),o=await crypto.subtle.digest("SHA-256",n);return[...new Uint8Array(o)].map(l=>l.toString(16).padStart(2,"0")).join("")}i(la,"hashQuery");S();w();b();var bt=class r extends Error{static{i(this,"DrizzleQueryError")}constructor(e,t,s){super(`Failed query: ${e}
params: ${t}`),this.query=e,this.params=t,this.cause=s,Error.captureStackTrace(this,r),s&&(this.cause=s)}};var Jt=class{static{i(this,"PgPreparedQuery")}constructor(e,t,s,n){this.query=e,this.cache=t,this.queryMetadata=s,this.cacheConfig=n,t&&t.strategy()==="all"&&n===void 0&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),this.cacheConfig?.enable||(this.cacheConfig=void 0)}authToken;getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}static[T]="PgPreparedQuery";joinsNotNullableMap;async queryWithCache(e,t,s){if(this.cache===void 0||U(this.cache,xt)||this.queryMetadata===void 0)try{return await s()}catch(n){throw new bt(e,t,n)}if(this.cacheConfig&&!this.cacheConfig.enable)try{return await s()}catch(n){throw new bt(e,t,n)}if((this.queryMetadata.type==="insert"||this.queryMetadata.type==="update"||this.queryMetadata.type==="delete")&&this.queryMetadata.tables.length>0)try{let[n]=await Promise.all([s(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return n}catch(n){throw new bt(e,t,n)}if(!this.cacheConfig)try{return await s()}catch(n){throw new bt(e,t,n)}if(this.queryMetadata.type==="select"){let n=await this.cache.get(this.cacheConfig.tag??await la(e,t),this.queryMetadata.tables,this.cacheConfig.tag!==void 0,this.cacheConfig.autoInvalidate);if(n===void 0){let o;try{o=await s()}catch(a){throw new bt(e,t,a)}return await this.cache.put(this.cacheConfig.tag??await la(e,t),o,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],this.cacheConfig.tag!==void 0,this.cacheConfig.config),o}return n}try{return await s()}catch(n){throw new bt(e,t,n)}}},Xt=class{static{i(this,"PgSession")}constructor(e){this.dialect=e}static[T]="PgSession";execute(e,t){return ge.startActiveSpan("drizzle.operation",()=>ge.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){let s=await this.execute(e,t);return Number(s[0].count)}},Zt=class extends Et{static{i(this,"PgTransaction")}constructor(e,t,s,n=0){super(e,t,s),this.schema=s,this.nestedIndex=n}static[T]="PgTransaction";rollback(){throw new Ls}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),typeof e.deferrable=="boolean"&&t.push(e.deferrable?"deferrable":"not deferrable"),O.raw(t.join(" "))}setTransaction(e){return this.session.execute(O`set transaction ${this.getTransactionConfigSQL(e)}`)}};S();w();b();S();w();b();S();w();b();var fw=Object.create,tr=Object.defineProperty,pw=Object.getOwnPropertyDescriptor,dw=Object.getOwnPropertyNames,mw=Object.getPrototypeOf,yw=Object.prototype.hasOwnProperty,gw=i((r,e,t)=>e in r?tr(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,"Io"),_=i((r,e)=>tr(r,"name",{value:e,configurable:!0}),"a"),We=i((r,e)=>()=>(r&&(e=r(r=0)),e),"G"),ue=i((r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),"T"),ut=i((r,e)=>{for(var t in e)tr(r,t,{get:e[t],enumerable:!0})},"ie"),wh=i((r,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of dw(e))!yw.call(r,n)&&n!==t&&tr(r,n,{get:i(()=>e[n],"get"),enumerable:!(s=pw(e,n))||s.enumerable});return r},"Dn"),Dt=i((r,e,t)=>(t=r!=null?fw(mw(r)):{},wh(e||!r||!r.__esModule?tr(t,"default",{value:r,enumerable:!0}):t,r)),"Se"),qe=i(r=>wh(tr({},"__esModule",{value:!0}),r),"O"),se=i((r,e,t)=>gw(r,typeof e!="symbol"?e+"":e,t),"E"),bw=ue(r=>{"use strict";X(),r.byteLength=l,r.toByteArray=f,r.fromByteArray=x;var e=[],t=[],s=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(o=0,a=n.length;o<a;++o)e[o]=n[o],t[n.charCodeAt(o)]=o;var o,a;t[45]=62,t[95]=63;function c(m){var h=m.length;if(h%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var E=m.indexOf("=");E===-1&&(E=h);var C=E===h?0:4-E%4;return[E,C]}i(c,"qn"),_(c,"getLens");function l(m){var h=c(m),E=h[0],C=h[1];return(E+C)*3/4-C}i(l,"Po"),_(l,"byteLength");function d(m,h,E){return(h+E)*3/4-E}i(d,"Bo"),_(d,"_byteLength");function f(m){var h,E=c(m),C=E[0],P=E[1],A=new s(d(m,C,P)),B=0,k=P>0?C-4:C,R;for(R=0;R<k;R+=4)h=t[m.charCodeAt(R)]<<18|t[m.charCodeAt(R+1)]<<12|t[m.charCodeAt(R+2)]<<6|t[m.charCodeAt(R+3)],A[B++]=h>>16&255,A[B++]=h>>8&255,A[B++]=h&255;return P===2&&(h=t[m.charCodeAt(R)]<<2|t[m.charCodeAt(R+1)]>>4,A[B++]=h&255),P===1&&(h=t[m.charCodeAt(R)]<<10|t[m.charCodeAt(R+1)]<<4|t[m.charCodeAt(R+2)]>>2,A[B++]=h>>8&255,A[B++]=h&255),A}i(f,"Ro"),_(f,"toByteArray");function v(m){return e[m>>18&63]+e[m>>12&63]+e[m>>6&63]+e[m&63]}i(v,"Lo"),_(v,"tripletToBase64");function y(m,h,E){for(var C,P=[],A=h;A<E;A+=3)C=(m[A]<<16&16711680)+(m[A+1]<<8&65280)+(m[A+2]&255),P.push(v(C));return P.join("")}i(y,"Fo"),_(y,"encodeChunk");function x(m){for(var h,E=m.length,C=E%3,P=[],A=16383,B=0,k=E-C;B<k;B+=A)P.push(y(m,B,B+A>k?k:B+A));return C===1?(h=m[E-1],P.push(e[h>>2]+e[h<<4&63]+"==")):C===2&&(h=(m[E-2]<<8)+m[E-1],P.push(e[h>>10]+e[h>>4&63]+e[h<<2&63]+"=")),P.join("")}i(x,"ko"),_(x,"fromByteArray")}),ww=ue(r=>{X(),r.read=function(e,t,s,n,o){var a,c,l=o*8-n-1,d=(1<<l)-1,f=d>>1,v=-7,y=s?o-1:0,x=s?-1:1,m=e[t+y];for(y+=x,a=m&(1<<-v)-1,m>>=-v,v+=l;v>0;a=a*256+e[t+y],y+=x,v-=8);for(c=a&(1<<-v)-1,a>>=-v,v+=n;v>0;c=c*256+e[t+y],y+=x,v-=8);if(a===0)a=1-f;else{if(a===d)return c?NaN:(m?-1:1)*(1/0);c=c+Math.pow(2,n),a=a-f}return(m?-1:1)*c*Math.pow(2,a-n)},r.write=function(e,t,s,n,o,a){var c,l,d,f=a*8-o-1,v=(1<<f)-1,y=v>>1,x=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:a-1,h=n?1:-1,E=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,c=v):(c=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-c))<1&&(c--,d*=2),c+y>=1?t+=x/d:t+=x*Math.pow(2,1-y),t*d>=2&&(c++,d/=2),c+y>=v?(l=0,c=v):c+y>=1?(l=(t*d-1)*Math.pow(2,o),c=c+y):(l=t*Math.pow(2,y-1)*Math.pow(2,o),c=0));o>=8;e[s+m]=l&255,m+=h,l/=256,o-=8);for(c=c<<o|l,f+=o;f>0;e[s+m]=c&255,m+=h,c/=256,f-=8);e[s+m-h]|=E*128}}),Sw=ue(r=>{"use strict";X();var e=bw(),t=ww(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=c,r.SlowBuffer=P,r.INSPECT_MAX_BYTES=50;var n=2147483647;r.kMaxLength=n,c.TYPED_ARRAY_SUPPORT=o(),!c.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{let u=new Uint8Array(1),p={foo:_(function(){return 42},"foo")};return Object.setPrototypeOf(p,Uint8Array.prototype),Object.setPrototypeOf(u,p),u.foo()===42}catch{return!1}}i(o,"Mo"),_(o,"typedArraySupport"),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:_(function(){if(c.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:_(function(){if(c.isBuffer(this))return this.byteOffset},"get")});function a(u){if(u>n)throw new RangeError('The value "'+u+'" is invalid for option "size"');let p=new Uint8Array(u);return Object.setPrototypeOf(p,c.prototype),p}i(a,"he"),_(a,"createBuffer");function c(u,p,g){if(typeof u=="number"){if(typeof p=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(u)}return l(u,p,g)}i(c,"h"),_(c,"Buffer"),c.poolSize=8192;function l(u,p,g){if(typeof u=="string")return y(u,p);if(ArrayBuffer.isView(u))return m(u);if(u==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u);if(nt(u,ArrayBuffer)||u&&nt(u.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(nt(u,SharedArrayBuffer)||u&&nt(u.buffer,SharedArrayBuffer)))return h(u,p,g);if(typeof u=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let I=u.valueOf&&u.valueOf();if(I!=null&&I!==u)return c.from(I,p,g);let D=E(u);if(D)return D;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof u[Symbol.toPrimitive]=="function")return c.from(u[Symbol.toPrimitive]("string"),p,g);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof u)}i(l,"Gn"),_(l,"from"),c.from=function(u,p,g){return l(u,p,g)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array);function d(u){if(typeof u!="number")throw new TypeError('"size" argument must be of type number');if(u<0)throw new RangeError('The value "'+u+'" is invalid for option "size"')}i(d,"Vn"),_(d,"assertSize");function f(u,p,g){return d(u),u<=0?a(u):p!==void 0?typeof g=="string"?a(u).fill(p,g):a(u).fill(p):a(u)}i(f,"Uo"),_(f,"alloc"),c.alloc=function(u,p,g){return f(u,p,g)};function v(u){return d(u),a(u<0?0:C(u)|0)}i(v,"$t"),_(v,"allocUnsafe"),c.allocUnsafe=function(u){return v(u)},c.allocUnsafeSlow=function(u){return v(u)};function y(u,p){if((typeof p!="string"||p==="")&&(p="utf8"),!c.isEncoding(p))throw new TypeError("Unknown encoding: "+p);let g=A(u,p)|0,I=a(g),D=I.write(u,p);return D!==g&&(I=I.slice(0,D)),I}i(y,"Do"),_(y,"fromString");function x(u){let p=u.length<0?0:C(u.length)|0,g=a(p);for(let I=0;I<p;I+=1)g[I]=u[I]&255;return g}i(x,"Wt"),_(x,"fromArrayLike");function m(u){if(nt(u,Uint8Array)){let p=new Uint8Array(u);return h(p.buffer,p.byteOffset,p.byteLength)}return x(u)}i(m,"Oo"),_(m,"fromArrayView");function h(u,p,g){if(p<0||u.byteLength<p)throw new RangeError('"offset" is outside of buffer bounds');if(u.byteLength<p+(g||0))throw new RangeError('"length" is outside of buffer bounds');let I;return p===void 0&&g===void 0?I=new Uint8Array(u):g===void 0?I=new Uint8Array(u,p):I=new Uint8Array(u,p,g),Object.setPrototypeOf(I,c.prototype),I}i(h,"jt"),_(h,"fromArrayBuffer");function E(u){if(c.isBuffer(u)){let p=C(u.length)|0,g=a(p);return g.length===0||u.copy(g,0,0,p),g}if(u.length!==void 0)return typeof u.length!="number"||gs(u.length)?a(0):x(u);if(u.type==="Buffer"&&Array.isArray(u.data))return x(u.data)}i(E,"qo"),_(E,"fromObject");function C(u){if(u>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return u|0}i(C,"Gt"),_(C,"checked");function P(u){return+u!=u&&(u=0),c.alloc(+u)}i(P,"Qo"),_(P,"SlowBuffer"),c.isBuffer=_(function(u){return u!=null&&u._isBuffer===!0&&u!==c.prototype},"isBuffer"),c.compare=_(function(u,p){if(nt(u,Uint8Array)&&(u=c.from(u,u.offset,u.byteLength)),nt(p,Uint8Array)&&(p=c.from(p,p.offset,p.byteLength)),!c.isBuffer(u)||!c.isBuffer(p))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(u===p)return 0;let g=u.length,I=p.length;for(let D=0,$=Math.min(g,I);D<$;++D)if(u[D]!==p[D]){g=u[D],I=p[D];break}return g<I?-1:I<g?1:0},"compare"),c.isEncoding=_(function(u){switch(String(u).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),c.concat=_(function(u,p){if(!Array.isArray(u))throw new TypeError('"list" argument must be an Array of Buffers');if(u.length===0)return c.alloc(0);let g;if(p===void 0)for(p=0,g=0;g<u.length;++g)p+=u[g].length;let I=c.allocUnsafe(p),D=0;for(g=0;g<u.length;++g){let $=u[g];if(nt($,Uint8Array))D+$.length>I.length?(c.isBuffer($)||($=c.from($)),$.copy(I,D)):Uint8Array.prototype.set.call(I,$,D);else if(c.isBuffer($))$.copy(I,D);else throw new TypeError('"list" argument must be an Array of Buffers');D+=$.length}return I},"concat");function A(u,p){if(c.isBuffer(u))return u.length;if(ArrayBuffer.isView(u)||nt(u,ArrayBuffer))return u.byteLength;if(typeof u!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof u);let g=u.length,I=arguments.length>2&&arguments[2]===!0;if(!I&&g===0)return 0;let D=!1;for(;;)switch(p){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":return ys(u).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g*2;case"hex":return g>>>1;case"base64":return mi(u).length;default:if(D)return I?-1:ys(u).length;p=(""+p).toLowerCase(),D=!0}}i(A,"zn"),_(A,"byteLength"),c.byteLength=A;function B(u,p,g){let I=!1;if((p===void 0||p<0)&&(p=0),p>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0,p>>>=0,g<=p))return"";for(u||(u="utf8");;)switch(u){case"hex":return ae(this,p,g);case"utf8":case"utf-8":return q(this,p,g);case"ascii":return oe(this,p,g);case"latin1":case"binary":return he(this,p,g);case"base64":return Y(this,p,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Xe(this,p,g);default:if(I)throw new TypeError("Unknown encoding: "+u);u=(u+"").toLowerCase(),I=!0}}i(B,"No"),_(B,"slowToString"),c.prototype._isBuffer=!0;function k(u,p,g){let I=u[p];u[p]=u[g],u[g]=I}i(k,"Ae"),_(k,"swap"),c.prototype.swap16=_(function(){let u=this.length;if(u%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let p=0;p<u;p+=2)k(this,p,p+1);return this},"swap16"),c.prototype.swap32=_(function(){let u=this.length;if(u%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let p=0;p<u;p+=4)k(this,p,p+3),k(this,p+1,p+2);return this},"swap32"),c.prototype.swap64=_(function(){let u=this.length;if(u%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let p=0;p<u;p+=8)k(this,p,p+7),k(this,p+1,p+6),k(this,p+2,p+5),k(this,p+3,p+4);return this},"swap64"),c.prototype.toString=_(function(){let u=this.length;return u===0?"":arguments.length===0?q(this,0,u):B.apply(this,arguments)},"toString"),c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=_(function(u){if(!c.isBuffer(u))throw new TypeError("Argument must be a Buffer");return this===u?!0:c.compare(this,u)===0},"equals"),c.prototype.inspect=_(function(){let u="",p=r.INSPECT_MAX_BYTES;return u=this.toString("hex",0,p).replace(/(.{2})/g,"$1 ").trim(),this.length>p&&(u+=" ... "),"<Buffer "+u+">"},"inspect"),s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=_(function(u,p,g,I,D){if(nt(u,Uint8Array)&&(u=c.from(u,u.offset,u.byteLength)),!c.isBuffer(u))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof u);if(p===void 0&&(p=0),g===void 0&&(g=u?u.length:0),I===void 0&&(I=0),D===void 0&&(D=this.length),p<0||g>u.length||I<0||D>this.length)throw new RangeError("out of range index");if(I>=D&&p>=g)return 0;if(I>=D)return-1;if(p>=g)return 1;if(p>>>=0,g>>>=0,I>>>=0,D>>>=0,this===u)return 0;let $=D-I,H=g-p,we=Math.min($,H),ke=this.slice(I,D),Ee=u.slice(p,g);for(let Se=0;Se<we;++Se)if(ke[Se]!==Ee[Se]){$=ke[Se],H=Ee[Se];break}return $<H?-1:H<$?1:0},"compare");function R(u,p,g,I,D){if(u.length===0)return-1;if(typeof g=="string"?(I=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,gs(g)&&(g=D?0:u.length-1),g<0&&(g=u.length+g),g>=u.length){if(D)return-1;g=u.length-1}else if(g<0)if(D)g=0;else return-1;if(typeof p=="string"&&(p=c.from(p,I)),c.isBuffer(p))return p.length===0?-1:L(u,p,g,I,D);if(typeof p=="number")return p=p&255,typeof Uint8Array.prototype.indexOf=="function"?D?Uint8Array.prototype.indexOf.call(u,p,g):Uint8Array.prototype.lastIndexOf.call(u,p,g):L(u,[p],g,I,D);throw new TypeError("val must be string, number or Buffer")}i(R,"Kn"),_(R,"bidirectionalIndexOf");function L(u,p,g,I,D){let $=1,H=u.length,we=p.length;if(I!==void 0&&(I=String(I).toLowerCase(),I==="ucs2"||I==="ucs-2"||I==="utf16le"||I==="utf-16le")){if(u.length<2||p.length<2)return-1;$=2,H/=2,we/=2,g/=2}function ke(Se,Le){return $===1?Se[Le]:Se.readUInt16BE(Le*$)}i(ke,"c"),_(ke,"read");let Ee;if(D){let Se=-1;for(Ee=g;Ee<H;Ee++)if(ke(u,Ee)===ke(p,Se===-1?0:Ee-Se)){if(Se===-1&&(Se=Ee),Ee-Se+1===we)return Se*$}else Se!==-1&&(Ee-=Ee-Se),Se=-1}else for(g+we>H&&(g=H-we),Ee=g;Ee>=0;Ee--){let Se=!0;for(let Le=0;Le<we;Le++)if(ke(u,Ee+Le)!==ke(p,Le)){Se=!1;break}if(Se)return Ee}return-1}i(L,"jn"),_(L,"arrayIndexOf"),c.prototype.includes=_(function(u,p,g){return this.indexOf(u,p,g)!==-1},"includes"),c.prototype.indexOf=_(function(u,p,g){return R(this,u,p,g,!0)},"indexOf"),c.prototype.lastIndexOf=_(function(u,p,g){return R(this,u,p,g,!1)},"lastIndexOf");function M(u,p,g,I){g=Number(g)||0;let D=u.length-g;I?(I=Number(I),I>D&&(I=D)):I=D;let $=p.length;I>$/2&&(I=$/2);let H;for(H=0;H<I;++H){let we=parseInt(p.substr(H*2,2),16);if(gs(we))return H;u[g+H]=we}return H}i(M,"Wo"),_(M,"hexWrite");function N(u,p,g,I){return vr(ys(p,u.length-g),u,g,I)}i(N,"jo"),_(N,"utf8Write");function Q(u,p,g,I){return vr(mu(p),u,g,I)}i(Q,"Ho"),_(Q,"asciiWrite");function F(u,p,g,I){return vr(mi(p),u,g,I)}i(F,"$o"),_(F,"base64Write");function G(u,p,g,I){return vr(yu(p,u.length-g),u,g,I)}i(G,"Go"),_(G,"ucs2Write"),c.prototype.write=_(function(u,p,g,I){if(p===void 0)I="utf8",g=this.length,p=0;else if(g===void 0&&typeof p=="string")I=p,g=this.length,p=0;else if(isFinite(p))p=p>>>0,isFinite(g)?(g=g>>>0,I===void 0&&(I="utf8")):(I=g,g=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let D=this.length-p;if((g===void 0||g>D)&&(g=D),u.length>0&&(g<0||p<0)||p>this.length)throw new RangeError("Attempt to write outside buffer bounds");I||(I="utf8");let $=!1;for(;;)switch(I){case"hex":return M(this,u,p,g);case"utf8":case"utf-8":return N(this,u,p,g);case"ascii":case"latin1":case"binary":return Q(this,u,p,g);case"base64":return F(this,u,p,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,u,p,g);default:if($)throw new TypeError("Unknown encoding: "+I);I=(""+I).toLowerCase(),$=!0}},"write"),c.prototype.toJSON=_(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function Y(u,p,g){return p===0&&g===u.length?e.fromByteArray(u):e.fromByteArray(u.slice(p,g))}i(Y,"Vo"),_(Y,"base64Slice");function q(u,p,g){g=Math.min(u.length,g);let I=[],D=p;for(;D<g;){let $=u[D],H=null,we=$>239?4:$>223?3:$>191?2:1;if(D+we<=g){let ke,Ee,Se,Le;switch(we){case 1:$<128&&(H=$);break;case 2:ke=u[D+1],(ke&192)===128&&(Le=($&31)<<6|ke&63,Le>127&&(H=Le));break;case 3:ke=u[D+1],Ee=u[D+2],(ke&192)===128&&(Ee&192)===128&&(Le=($&15)<<12|(ke&63)<<6|Ee&63,Le>2047&&(Le<55296||Le>57343)&&(H=Le));break;case 4:ke=u[D+1],Ee=u[D+2],Se=u[D+3],(ke&192)===128&&(Ee&192)===128&&(Se&192)===128&&(Le=($&15)<<18|(ke&63)<<12|(Ee&63)<<6|Se&63,Le>65535&&Le<1114112&&(H=Le))}}H===null?(H=65533,we=1):H>65535&&(H-=65536,I.push(H>>>10&1023|55296),H=56320|H&1023),I.push(H),D+=we}return ee(I)}i(q,"Yn"),_(q,"utf8Slice");var K=4096;function ee(u){let p=u.length;if(p<=K)return String.fromCharCode.apply(String,u);let g="",I=0;for(;I<p;)g+=String.fromCharCode.apply(String,u.slice(I,I+=K));return g}i(ee,"zo"),_(ee,"decodeCodePointsArray");function oe(u,p,g){let I="";g=Math.min(u.length,g);for(let D=p;D<g;++D)I+=String.fromCharCode(u[D]&127);return I}i(oe,"Ko"),_(oe,"asciiSlice");function he(u,p,g){let I="";g=Math.min(u.length,g);for(let D=p;D<g;++D)I+=String.fromCharCode(u[D]);return I}i(he,"Yo"),_(he,"latin1Slice");function ae(u,p,g){let I=u.length;(!p||p<0)&&(p=0),(!g||g<0||g>I)&&(g=I);let D="";for(let $=p;$<g;++$)D+=kg[u[$]];return D}i(ae,"Zo"),_(ae,"hexSlice");function Xe(u,p,g){let I=u.slice(p,g),D="";for(let $=0;$<I.length-1;$+=2)D+=String.fromCharCode(I[$]+I[$+1]*256);return D}i(Xe,"Jo"),_(Xe,"utf16leSlice"),c.prototype.slice=_(function(u,p){let g=this.length;u=~~u,p=p===void 0?g:~~p,u<0?(u+=g,u<0&&(u=0)):u>g&&(u=g),p<0?(p+=g,p<0&&(p=0)):p>g&&(p=g),p<u&&(p=u);let I=this.subarray(u,p);return Object.setPrototypeOf(I,c.prototype),I},"slice");function be(u,p,g){if(u%1!==0||u<0)throw new RangeError("offset is not uint");if(u+p>g)throw new RangeError("Trying to access beyond buffer length")}i(be,"q"),_(be,"checkOffset"),c.prototype.readUintLE=c.prototype.readUIntLE=_(function(u,p,g){u=u>>>0,p=p>>>0,g||be(u,p,this.length);let I=this[u],D=1,$=0;for(;++$<p&&(D*=256);)I+=this[u+$]*D;return I},"readUIntLE"),c.prototype.readUintBE=c.prototype.readUIntBE=_(function(u,p,g){u=u>>>0,p=p>>>0,g||be(u,p,this.length);let I=this[u+--p],D=1;for(;p>0&&(D*=256);)I+=this[u+--p]*D;return I},"readUIntBE"),c.prototype.readUint8=c.prototype.readUInt8=_(function(u,p){return u=u>>>0,p||be(u,1,this.length),this[u]},"readUInt8"),c.prototype.readUint16LE=c.prototype.readUInt16LE=_(function(u,p){return u=u>>>0,p||be(u,2,this.length),this[u]|this[u+1]<<8},"readUInt16LE"),c.prototype.readUint16BE=c.prototype.readUInt16BE=_(function(u,p){return u=u>>>0,p||be(u,2,this.length),this[u]<<8|this[u+1]},"readUInt16BE"),c.prototype.readUint32LE=c.prototype.readUInt32LE=_(function(u,p){return u=u>>>0,p||be(u,4,this.length),(this[u]|this[u+1]<<8|this[u+2]<<16)+this[u+3]*16777216},"readUInt32LE"),c.prototype.readUint32BE=c.prototype.readUInt32BE=_(function(u,p){return u=u>>>0,p||be(u,4,this.length),this[u]*16777216+(this[u+1]<<16|this[u+2]<<8|this[u+3])},"readUInt32BE"),c.prototype.readBigUInt64LE=dt(_(function(u){u=u>>>0,At(u,"offset");let p=this[u],g=this[u+7];(p===void 0||g===void 0)&&jt(u,this.length-8);let I=p+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24,D=this[++u]+this[++u]*2**8+this[++u]*2**16+g*2**24;return BigInt(I)+(BigInt(D)<<BigInt(32))},"readBigUInt64LE")),c.prototype.readBigUInt64BE=dt(_(function(u){u=u>>>0,At(u,"offset");let p=this[u],g=this[u+7];(p===void 0||g===void 0)&&jt(u,this.length-8);let I=p*2**24+this[++u]*2**16+this[++u]*2**8+this[++u],D=this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+g;return(BigInt(I)<<BigInt(32))+BigInt(D)},"readBigUInt64BE")),c.prototype.readIntLE=_(function(u,p,g){u=u>>>0,p=p>>>0,g||be(u,p,this.length);let I=this[u],D=1,$=0;for(;++$<p&&(D*=256);)I+=this[u+$]*D;return D*=128,I>=D&&(I-=Math.pow(2,8*p)),I},"readIntLE"),c.prototype.readIntBE=_(function(u,p,g){u=u>>>0,p=p>>>0,g||be(u,p,this.length);let I=p,D=1,$=this[u+--I];for(;I>0&&(D*=256);)$+=this[u+--I]*D;return D*=128,$>=D&&($-=Math.pow(2,8*p)),$},"readIntBE"),c.prototype.readInt8=_(function(u,p){return u=u>>>0,p||be(u,1,this.length),this[u]&128?(255-this[u]+1)*-1:this[u]},"readInt8"),c.prototype.readInt16LE=_(function(u,p){u=u>>>0,p||be(u,2,this.length);let g=this[u]|this[u+1]<<8;return g&32768?g|4294901760:g},"readInt16LE"),c.prototype.readInt16BE=_(function(u,p){u=u>>>0,p||be(u,2,this.length);let g=this[u+1]|this[u]<<8;return g&32768?g|4294901760:g},"readInt16BE"),c.prototype.readInt32LE=_(function(u,p){return u=u>>>0,p||be(u,4,this.length),this[u]|this[u+1]<<8|this[u+2]<<16|this[u+3]<<24},"readInt32LE"),c.prototype.readInt32BE=_(function(u,p){return u=u>>>0,p||be(u,4,this.length),this[u]<<24|this[u+1]<<16|this[u+2]<<8|this[u+3]},"readInt32BE"),c.prototype.readBigInt64LE=dt(_(function(u){u=u>>>0,At(u,"offset");let p=this[u],g=this[u+7];(p===void 0||g===void 0)&&jt(u,this.length-8);let I=this[u+4]+this[u+5]*2**8+this[u+6]*2**16+(g<<24);return(BigInt(I)<<BigInt(32))+BigInt(p+this[++u]*2**8+this[++u]*2**16+this[++u]*2**24)},"readBigInt64LE")),c.prototype.readBigInt64BE=dt(_(function(u){u=u>>>0,At(u,"offset");let p=this[u],g=this[u+7];(p===void 0||g===void 0)&&jt(u,this.length-8);let I=(p<<24)+this[++u]*2**16+this[++u]*2**8+this[++u];return(BigInt(I)<<BigInt(32))+BigInt(this[++u]*2**24+this[++u]*2**16+this[++u]*2**8+g)},"readBigInt64BE")),c.prototype.readFloatLE=_(function(u,p){return u=u>>>0,p||be(u,4,this.length),t.read(this,u,!0,23,4)},"readFloatLE"),c.prototype.readFloatBE=_(function(u,p){return u=u>>>0,p||be(u,4,this.length),t.read(this,u,!1,23,4)},"readFloatBE"),c.prototype.readDoubleLE=_(function(u,p){return u=u>>>0,p||be(u,8,this.length),t.read(this,u,!0,52,8)},"readDoubleLE"),c.prototype.readDoubleBE=_(function(u,p){return u=u>>>0,p||be(u,8,this.length),t.read(this,u,!1,52,8)},"readDoubleBE");function Be(u,p,g,I,D,$){if(!c.isBuffer(u))throw new TypeError('"buffer" argument must be a Buffer instance');if(p>D||p<$)throw new RangeError('"value" argument is out of bounds');if(g+I>u.length)throw new RangeError("Index out of range")}i(Be,"V"),_(Be,"checkInt"),c.prototype.writeUintLE=c.prototype.writeUIntLE=_(function(u,p,g,I){if(u=+u,p=p>>>0,g=g>>>0,!I){let H=Math.pow(2,8*g)-1;Be(this,u,p,g,H,0)}let D=1,$=0;for(this[p]=u&255;++$<g&&(D*=256);)this[p+$]=u/D&255;return p+g},"writeUIntLE"),c.prototype.writeUintBE=c.prototype.writeUIntBE=_(function(u,p,g,I){if(u=+u,p=p>>>0,g=g>>>0,!I){let H=Math.pow(2,8*g)-1;Be(this,u,p,g,H,0)}let D=g-1,$=1;for(this[p+D]=u&255;--D>=0&&($*=256);)this[p+D]=u/$&255;return p+g},"writeUIntBE"),c.prototype.writeUint8=c.prototype.writeUInt8=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,1,255,0),this[p]=u&255,p+1},"writeUInt8"),c.prototype.writeUint16LE=c.prototype.writeUInt16LE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,2,65535,0),this[p]=u&255,this[p+1]=u>>>8,p+2},"writeUInt16LE"),c.prototype.writeUint16BE=c.prototype.writeUInt16BE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,2,65535,0),this[p]=u>>>8,this[p+1]=u&255,p+2},"writeUInt16BE"),c.prototype.writeUint32LE=c.prototype.writeUInt32LE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,4,4294967295,0),this[p+3]=u>>>24,this[p+2]=u>>>16,this[p+1]=u>>>8,this[p]=u&255,p+4},"writeUInt32LE"),c.prototype.writeUint32BE=c.prototype.writeUInt32BE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,4,4294967295,0),this[p]=u>>>24,this[p+1]=u>>>16,this[p+2]=u>>>8,this[p+3]=u&255,p+4},"writeUInt32BE");function wr(u,p,g,I,D){di(p,I,D,u,g,7);let $=Number(p&BigInt(4294967295));u[g++]=$,$=$>>8,u[g++]=$,$=$>>8,u[g++]=$,$=$>>8,u[g++]=$;let H=Number(p>>BigInt(32)&BigInt(4294967295));return u[g++]=H,H=H>>8,u[g++]=H,H=H>>8,u[g++]=H,H=H>>8,u[g++]=H,g}i(wr,"Zn"),_(wr,"wrtBigUInt64LE");function Sr(u,p,g,I,D){di(p,I,D,u,g,7);let $=Number(p&BigInt(4294967295));u[g+7]=$,$=$>>8,u[g+6]=$,$=$>>8,u[g+5]=$,$=$>>8,u[g+4]=$;let H=Number(p>>BigInt(32)&BigInt(4294967295));return u[g+3]=H,H=H>>8,u[g+2]=H,H=H>>8,u[g+1]=H,H=H>>8,u[g]=H,g+8}i(Sr,"Jn"),_(Sr,"wrtBigUInt64BE"),c.prototype.writeBigUInt64LE=dt(_(function(u,p=0){return wr(this,u,p,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),c.prototype.writeBigUInt64BE=dt(_(function(u,p=0){return Sr(this,u,p,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),c.prototype.writeIntLE=_(function(u,p,g,I){if(u=+u,p=p>>>0,!I){let we=Math.pow(2,8*g-1);Be(this,u,p,g,we-1,-we)}let D=0,$=1,H=0;for(this[p]=u&255;++D<g&&($*=256);)u<0&&H===0&&this[p+D-1]!==0&&(H=1),this[p+D]=(u/$>>0)-H&255;return p+g},"writeIntLE"),c.prototype.writeIntBE=_(function(u,p,g,I){if(u=+u,p=p>>>0,!I){let we=Math.pow(2,8*g-1);Be(this,u,p,g,we-1,-we)}let D=g-1,$=1,H=0;for(this[p+D]=u&255;--D>=0&&($*=256);)u<0&&H===0&&this[p+D+1]!==0&&(H=1),this[p+D]=(u/$>>0)-H&255;return p+g},"writeIntBE"),c.prototype.writeInt8=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,1,127,-128),u<0&&(u=255+u+1),this[p]=u&255,p+1},"writeInt8"),c.prototype.writeInt16LE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,2,32767,-32768),this[p]=u&255,this[p+1]=u>>>8,p+2},"writeInt16LE"),c.prototype.writeInt16BE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,2,32767,-32768),this[p]=u>>>8,this[p+1]=u&255,p+2},"writeInt16BE"),c.prototype.writeInt32LE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,4,2147483647,-2147483648),this[p]=u&255,this[p+1]=u>>>8,this[p+2]=u>>>16,this[p+3]=u>>>24,p+4},"writeInt32LE"),c.prototype.writeInt32BE=_(function(u,p,g){return u=+u,p=p>>>0,g||Be(this,u,p,4,2147483647,-2147483648),u<0&&(u=4294967295+u+1),this[p]=u>>>24,this[p+1]=u>>>16,this[p+2]=u>>>8,this[p+3]=u&255,p+4},"writeInt32BE"),c.prototype.writeBigInt64LE=dt(_(function(u,p=0){return wr(this,u,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),c.prototype.writeBigInt64BE=dt(_(function(u,p=0){return Sr(this,u,p,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function li(u,p,g,I,D,$){if(g+I>u.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}i(li,"Xn"),_(li,"checkIEEE754");function hi(u,p,g,I,D){return p=+p,g=g>>>0,D||li(u,p,g,4,34028234663852886e22,-34028234663852886e22),t.write(u,p,g,I,23,4),g+4}i(hi,"ei"),_(hi,"writeFloat"),c.prototype.writeFloatLE=_(function(u,p,g){return hi(this,u,p,!0,g)},"writeFloatLE"),c.prototype.writeFloatBE=_(function(u,p,g){return hi(this,u,p,!1,g)},"writeFloatBE");function fi(u,p,g,I,D){return p=+p,g=g>>>0,D||li(u,p,g,8,17976931348623157e292,-17976931348623157e292),t.write(u,p,g,I,52,8),g+8}i(fi,"ti"),_(fi,"writeDouble"),c.prototype.writeDoubleLE=_(function(u,p,g){return fi(this,u,p,!0,g)},"writeDoubleLE"),c.prototype.writeDoubleBE=_(function(u,p,g){return fi(this,u,p,!1,g)},"writeDoubleBE"),c.prototype.copy=_(function(u,p,g,I){if(!c.isBuffer(u))throw new TypeError("argument should be a Buffer");if(g||(g=0),!I&&I!==0&&(I=this.length),p>=u.length&&(p=u.length),p||(p=0),I>0&&I<g&&(I=g),I===g||u.length===0||this.length===0)return 0;if(p<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("sourceEnd out of bounds");I>this.length&&(I=this.length),u.length-p<I-g&&(I=u.length-p+g);let D=I-g;return this===u&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(p,g,I):Uint8Array.prototype.set.call(u,this.subarray(g,I),p),D},"copy"),c.prototype.fill=_(function(u,p,g,I){if(typeof u=="string"){if(typeof p=="string"?(I=p,p=0,g=this.length):typeof g=="string"&&(I=g,g=this.length),I!==void 0&&typeof I!="string")throw new TypeError("encoding must be a string");if(typeof I=="string"&&!c.isEncoding(I))throw new TypeError("Unknown encoding: "+I);if(u.length===1){let $=u.charCodeAt(0);(I==="utf8"&&$<128||I==="latin1")&&(u=$)}}else typeof u=="number"?u=u&255:typeof u=="boolean"&&(u=Number(u));if(p<0||this.length<p||this.length<g)throw new RangeError("Out of range index");if(g<=p)return this;p=p>>>0,g=g===void 0?this.length:g>>>0,u||(u=0);let D;if(typeof u=="number")for(D=p;D<g;++D)this[D]=u;else{let $=c.isBuffer(u)?u:c.from(u,I),H=$.length;if(H===0)throw new TypeError('The value "'+u+'" is invalid for argument "value"');for(D=0;D<g-p;++D)this[D+p]=$[D%H]}return this},"fill");var $t={};function ms(u,p,g){var I;$t[u]=(I=class extends g{static{i(this,"n")}constructor(){super(),Object.defineProperty(this,"message",{value:p.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${u}]`,this.stack,delete this.name}get code(){return u}set code(D){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:D,writable:!0})}toString(){return`${this.name} [${u}]: ${this.message}`}},_(I,"NodeError"),I)}i(ms,"Vt"),_(ms,"E"),ms("ERR_BUFFER_OUT_OF_BOUNDS",function(u){return u?`${u} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ms("ERR_INVALID_ARG_TYPE",function(u,p){return`The "${u}" argument must be of type number. Received type ${typeof p}`},TypeError),ms("ERR_OUT_OF_RANGE",function(u,p,g){let I=`The value of "${u}" is out of range.`,D=g;return Number.isInteger(g)&&Math.abs(g)>2**32?D=pi(String(g)):typeof g=="bigint"&&(D=String(g),(g>BigInt(2)**BigInt(32)||g<-(BigInt(2)**BigInt(32)))&&(D=pi(D)),D+="n"),I+=` It must be ${p}. Received ${D}`,I},RangeError);function pi(u){let p="",g=u.length,I=u[0]==="-"?1:0;for(;g>=I+4;g-=3)p=`_${u.slice(g-3,g)}${p}`;return`${u.slice(0,g)}${p}`}i(pi,"$n"),_(pi,"addNumericalSeparator");function pu(u,p,g){At(p,"offset"),(u[p]===void 0||u[p+g]===void 0)&&jt(p,u.length-(g+1))}i(pu,"Xo"),_(pu,"checkBounds");function di(u,p,g,I,D,$){if(u>g||u<p){let H=typeof p=="bigint"?"n":"",we;throw $>3?p===0||p===BigInt(0)?we=`>= 0${H} and < 2${H} ** ${($+1)*8}${H}`:we=`>= -(2${H} ** ${($+1)*8-1}${H}) and < 2 ** ${($+1)*8-1}${H}`:we=`>= ${p}${H} and <= ${g}${H}`,new $t.ERR_OUT_OF_RANGE("value",we,u)}pu(I,D,$)}i(di,"ri"),_(di,"checkIntBI");function At(u,p){if(typeof u!="number")throw new $t.ERR_INVALID_ARG_TYPE(p,"number",u)}i(At,"Be"),_(At,"validateNumber");function jt(u,p,g){throw Math.floor(u)!==u?(At(u,g),new $t.ERR_OUT_OF_RANGE(g||"offset","an integer",u)):p<0?new $t.ERR_BUFFER_OUT_OF_BOUNDS:new $t.ERR_OUT_OF_RANGE(g||"offset",`>= ${g?1:0} and <= ${p}`,u)}i(jt,"je"),_(jt,"boundsError");var Bg=/[^+/0-9A-Za-z-_]/g;function du(u){if(u=u.split("=")[0],u=u.trim().replace(Bg,""),u.length<2)return"";for(;u.length%4!==0;)u=u+"=";return u}i(du,"ta"),_(du,"base64clean");function ys(u,p){p=p||1/0;let g,I=u.length,D=null,$=[];for(let H=0;H<I;++H){if(g=u.charCodeAt(H),g>55295&&g<57344){if(!D){if(g>56319){(p-=3)>-1&&$.push(239,191,189);continue}else if(H+1===I){(p-=3)>-1&&$.push(239,191,189);continue}D=g;continue}if(g<56320){(p-=3)>-1&&$.push(239,191,189),D=g;continue}g=(D-55296<<10|g-56320)+65536}else D&&(p-=3)>-1&&$.push(239,191,189);if(D=null,g<128){if((p-=1)<0)break;$.push(g)}else if(g<2048){if((p-=2)<0)break;$.push(g>>6|192,g&63|128)}else if(g<65536){if((p-=3)<0)break;$.push(g>>12|224,g>>6&63|128,g&63|128)}else if(g<1114112){if((p-=4)<0)break;$.push(g>>18|240,g>>12&63|128,g>>6&63|128,g&63|128)}else throw new Error("Invalid code point")}return $}i(ys,"Ht"),_(ys,"utf8ToBytes");function mu(u){let p=[];for(let g=0;g<u.length;++g)p.push(u.charCodeAt(g)&255);return p}i(mu,"ra"),_(mu,"asciiToBytes");function yu(u,p){let g,I,D,$=[];for(let H=0;H<u.length&&!((p-=2)<0);++H)g=u.charCodeAt(H),I=g>>8,D=g%256,$.push(D),$.push(I);return $}i(yu,"na"),_(yu,"utf16leToBytes");function mi(u){return e.toByteArray(du(u))}i(mi,"ni"),_(mi,"base64ToBytes");function vr(u,p,g,I){let D;for(D=0;D<I&&!(D+g>=p.length||D>=u.length);++D)p[D+g]=u[D];return D}i(vr,"ht"),_(vr,"blitBuffer");function nt(u,p){return u instanceof p||u!=null&&u.constructor!=null&&u.constructor.name!=null&&u.constructor.name===p.name}i(nt,"ue"),_(nt,"isInstance");function gs(u){return u!==u}i(gs,"zt"),_(gs,"numberIsNaN");var kg=function(){let u="0123456789abcdef",p=new Array(256);for(let g=0;g<16;++g){let I=g*16;for(let D=0;D<16;++D)p[I+D]=u[g]+u[D]}return p}();function dt(u){return typeof BigInt>"u"?gu:u}i(dt,"we"),_(dt,"defineBigIntMethod");function gu(){throw new Error("BigInt not supported")}i(gu,"sa"),_(gu,"BufferBigIntNotDefined")}),Js,ya,vw,re,ce,X=We(()=>{"use strict";Js=globalThis,ya=globalThis.setImmediate??(r=>setTimeout(r,0)),vw=globalThis.clearImmediate??(r=>clearTimeout(r)),re=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:Sw().Buffer,ce=globalThis.process??{},ce.env??(ce.env={});try{ce.nextTick(()=>{})}catch{let r=Promise.resolve();ce.nextTick=r.then.bind(r)}}),Bt=ue((r,e)=>{"use strict";X();var t=typeof Reflect=="object"?Reflect:null,s=t&&typeof t.apply=="function"?t.apply:_(function(R,L,M){return Function.prototype.apply.call(R,L,M)},"ReflectApply"),n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=_(function(R){return Object.getOwnPropertyNames(R).concat(Object.getOwnPropertySymbols(R))},"ReflectOwnKeys"):n=_(function(R){return Object.getOwnPropertyNames(R)},"ReflectOwnKeys");function o(R){console&&console.warn&&console.warn(R)}i(o,"oa"),_(o,"ProcessEmitWarning");var a=Number.isNaN||_(function(R){return R!==R},"NumberIsNaN");function c(){c.init.call(this)}i(c,"B"),_(c,"EventEmitter"),e.exports=c,e.exports.once=A,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var l=10;function d(R){if(typeof R!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof R)}i(d,"dt"),_(d,"checkListener"),Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:_(function(){return l},"get"),set:_(function(R){if(typeof R!="number"||R<0||a(R))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+R+".");l=R},"set")}),c.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=_(function(R){if(typeof R!="number"||R<0||a(R))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+R+".");return this._maxListeners=R,this},"setMaxListeners");function f(R){return R._maxListeners===void 0?c.defaultMaxListeners:R._maxListeners}i(f,"ui"),_(f,"_getMaxListeners"),c.prototype.getMaxListeners=_(function(){return f(this)},"getMaxListeners"),c.prototype.emit=_(function(R){for(var L=[],M=1;M<arguments.length;M++)L.push(arguments[M]);var N=R==="error",Q=this._events;if(Q!==void 0)N=N&&Q.error===void 0;else if(!N)return!1;if(N){var F;if(L.length>0&&(F=L[0]),F instanceof Error)throw F;var G=new Error("Unhandled error."+(F?" ("+F.message+")":""));throw G.context=F,G}var Y=Q[R];if(Y===void 0)return!1;if(typeof Y=="function")s(Y,this,L);else for(var q=Y.length,K=E(Y,q),M=0;M<q;++M)s(K[M],this,L);return!0},"emit");function v(R,L,M,N){var Q,F,G;if(d(M),F=R._events,F===void 0?(F=R._events=Object.create(null),R._eventsCount=0):(F.newListener!==void 0&&(R.emit("newListener",L,M.listener?M.listener:M),F=R._events),G=F[L]),G===void 0)G=F[L]=M,++R._eventsCount;else if(typeof G=="function"?G=F[L]=N?[M,G]:[G,M]:N?G.unshift(M):G.push(M),Q=f(R),Q>0&&G.length>Q&&!G.warned){G.warned=!0;var Y=new Error("Possible EventEmitter memory leak detected. "+G.length+" "+String(L)+" listeners added. Use emitter.setMaxListeners() to increase limit");Y.name="MaxListenersExceededWarning",Y.emitter=R,Y.type=L,Y.count=G.length,o(Y)}return R}i(v,"ci"),_(v,"_addListener"),c.prototype.addListener=_(function(R,L){return v(this,R,L,!1)},"addListener"),c.prototype.on=c.prototype.addListener,c.prototype.prependListener=_(function(R,L){return v(this,R,L,!0)},"prependListener");function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}i(y,"aa"),_(y,"onceWrapper");function x(R,L,M){var N={fired:!1,wrapFn:void 0,target:R,type:L,listener:M},Q=y.bind(N);return Q.listener=M,N.wrapFn=Q,Q}i(x,"li"),_(x,"_onceWrap"),c.prototype.once=_(function(R,L){return d(L),this.on(R,x(this,R,L)),this},"once"),c.prototype.prependOnceListener=_(function(R,L){return d(L),this.prependListener(R,x(this,R,L)),this},"prependOnceListener"),c.prototype.removeListener=_(function(R,L){var M,N,Q,F,G;if(d(L),N=this._events,N===void 0)return this;if(M=N[R],M===void 0)return this;if(M===L||M.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete N[R],N.removeListener&&this.emit("removeListener",R,M.listener||L));else if(typeof M!="function"){for(Q=-1,F=M.length-1;F>=0;F--)if(M[F]===L||M[F].listener===L){G=M[F].listener,Q=F;break}if(Q<0)return this;Q===0?M.shift():C(M,Q),M.length===1&&(N[R]=M[0]),N.removeListener!==void 0&&this.emit("removeListener",R,G||L)}return this},"removeListener"),c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=_(function(R){var L,M,N;if(M=this._events,M===void 0)return this;if(M.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):M[R]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete M[R]),this;if(arguments.length===0){var Q=Object.keys(M),F;for(N=0;N<Q.length;++N)F=Q[N],F!=="removeListener"&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=M[R],typeof L=="function")this.removeListener(R,L);else if(L!==void 0)for(N=L.length-1;N>=0;N--)this.removeListener(R,L[N]);return this},"removeAllListeners");function m(R,L,M){var N=R._events;if(N===void 0)return[];var Q=N[L];return Q===void 0?[]:typeof Q=="function"?M?[Q.listener||Q]:[Q]:M?P(Q):E(Q,Q.length)}i(m,"fi"),_(m,"_listeners"),c.prototype.listeners=_(function(R){return m(this,R,!0)},"listeners"),c.prototype.rawListeners=_(function(R){return m(this,R,!1)},"rawListeners"),c.listenerCount=function(R,L){return typeof R.listenerCount=="function"?R.listenerCount(L):h.call(R,L)},c.prototype.listenerCount=h;function h(R){var L=this._events;if(L!==void 0){var M=L[R];if(typeof M=="function")return 1;if(M!==void 0)return M.length}return 0}i(h,"hi"),_(h,"listenerCount"),c.prototype.eventNames=_(function(){return this._eventsCount>0?n(this._events):[]},"eventNames");function E(R,L){for(var M=new Array(L),N=0;N<L;++N)M[N]=R[N];return M}i(E,"pi"),_(E,"arrayClone");function C(R,L){for(;L+1<R.length;L++)R[L]=R[L+1];R.pop()}i(C,"ua"),_(C,"spliceOne");function P(R){for(var L=new Array(R.length),M=0;M<L.length;++M)L[M]=R[M].listener||R[M];return L}i(P,"ca"),_(P,"unwrapListeners");function A(R,L){return new Promise(function(M,N){function Q(G){R.removeListener(L,F),N(G)}i(Q,"i"),_(Q,"errorListener");function F(){typeof R.removeListener=="function"&&R.removeListener("error",Q),M([].slice.call(arguments))}i(F,"s"),_(F,"resolver"),k(R,L,F,{once:!0}),L!=="error"&&B(R,Q,{once:!0})})}i(A,"la"),_(A,"once");function B(R,L,M){typeof R.on=="function"&&k(R,"error",L,M)}i(B,"fa"),_(B,"addErrorHandlerIfEventEmitter");function k(R,L,M,N){if(typeof R.on=="function")N.once?R.once(L,M):R.on(L,M);else if(typeof R.addEventListener=="function")R.addEventListener(L,_(i(function Q(F){N.once&&R.removeEventListener(L,Q),M(F)},"i"),"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof R)}i(k,"di"),_(k,"eventTargetAgnosticAddListener")}),Sh={};ut(Sh,{Socket:i(()=>Gr,"Socket"),isIP:i(()=>vh,"isIP")});function vh(r){return 0}i(vh,"ha");var ph,ha,Kr,Gr,Yr=We(()=>{"use strict";X(),ph=Dt(Bt(),1),_(vh,"isIP"),ha=/^[^.]+\./,Kr=class Z extends ph.EventEmitter{static{i(this,"S")}constructor(){super(...arguments),se(this,"opts",{}),se(this,"connecting",!1),se(this,"pending",!0),se(this,"writable",!0),se(this,"encrypted",!1),se(this,"authorized",!1),se(this,"destroyed",!1),se(this,"ws",null),se(this,"writeBuffer"),se(this,"tlsState",0),se(this,"tlsRead"),se(this,"tlsWrite")}static get poolQueryViaFetch(){return Z.opts.poolQueryViaFetch??Z.defaults.poolQueryViaFetch}static set poolQueryViaFetch(e){Z.opts.poolQueryViaFetch=e}static get fetchEndpoint(){return Z.opts.fetchEndpoint??Z.defaults.fetchEndpoint}static set fetchEndpoint(e){Z.opts.fetchEndpoint=e}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return Z.opts.fetchFunction??Z.defaults.fetchFunction}static set fetchFunction(e){Z.opts.fetchFunction=e}static get webSocketConstructor(){return Z.opts.webSocketConstructor??Z.defaults.webSocketConstructor}static set webSocketConstructor(e){Z.opts.webSocketConstructor=e}get webSocketConstructor(){return this.opts.webSocketConstructor??Z.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return Z.opts.wsProxy??Z.defaults.wsProxy}static set wsProxy(e){Z.opts.wsProxy=e}get wsProxy(){return this.opts.wsProxy??Z.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return Z.opts.coalesceWrites??Z.defaults.coalesceWrites}static set coalesceWrites(e){Z.opts.coalesceWrites=e}get coalesceWrites(){return this.opts.coalesceWrites??Z.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return Z.opts.useSecureWebSocket??Z.defaults.useSecureWebSocket}static set useSecureWebSocket(e){Z.opts.useSecureWebSocket=e}get useSecureWebSocket(){return this.opts.useSecureWebSocket??Z.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return Z.opts.forceDisablePgSSL??Z.defaults.forceDisablePgSSL}static set forceDisablePgSSL(e){Z.opts.forceDisablePgSSL=e}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??Z.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return Z.opts.disableSNI??Z.defaults.disableSNI}static set disableSNI(e){Z.opts.disableSNI=e}get disableSNI(){return this.opts.disableSNI??Z.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get disableWarningInBrowsers(){return Z.opts.disableWarningInBrowsers??Z.defaults.disableWarningInBrowsers}static set disableWarningInBrowsers(e){Z.opts.disableWarningInBrowsers=e}get disableWarningInBrowsers(){return this.opts.disableWarningInBrowsers??Z.disableWarningInBrowsers}set disableWarningInBrowsers(e){this.opts.disableWarningInBrowsers=e}static get pipelineConnect(){return Z.opts.pipelineConnect??Z.defaults.pipelineConnect}static set pipelineConnect(e){Z.opts.pipelineConnect=e}get pipelineConnect(){return this.opts.pipelineConnect??Z.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return Z.opts.subtls??Z.defaults.subtls}static set subtls(e){Z.opts.subtls=e}get subtls(){return this.opts.subtls??Z.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return Z.opts.pipelineTLS??Z.defaults.pipelineTLS}static set pipelineTLS(e){Z.opts.pipelineTLS=e}get pipelineTLS(){return this.opts.pipelineTLS??Z.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return Z.opts.rootCerts??Z.defaults.rootCerts}static set rootCerts(e){Z.opts.rootCerts=e}get rootCerts(){return this.opts.rootCerts??Z.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,t){let s=this.wsProxy;if(s===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof s=="function"?s(e,t):`${s}?address=${e}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,t,s){this.connecting=!0,s&&this.once("connect",s);let n=_(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),o=_((c,l=!1)=>{c.binaryType="arraybuffer",c.addEventListener("error",d=>{this.emit("error",d),this.emit("close")}),c.addEventListener("message",d=>{if(this.tlsState===0){let f=re.from(d.data);this.emit("data",f)}}),c.addEventListener("close",()=>{this.emit("close")}),l?n():c.addEventListener("open",n)},"configureWebSocket"),a;try{a=this.wsProxyAddrForHost(t,typeof e=="string"?parseInt(e,10):e)}catch(c){this.emit("error",c),this.emit("close");return}try{let c=(this.useSecureWebSocket?"wss:":"ws:")+"//"+a;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(c),o(this.ws);else try{this.ws=new WebSocket(c),o(this.ws)}catch{this.ws=new __unstable_WebSocket(c),o(this.ws)}}catch(c){let l=(this.useSecureWebSocket?"https:":"http:")+"//"+a;fetch(l,{headers:{Upgrade:"websocket"}}).then(d=>{if(this.ws=d.webSocket,this.ws==null)throw c;this.ws.accept(),o(this.ws,!0)}).catch(d=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${d}`)),this.emit("close")})}}async startTls(e){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let t=await this.subtls.TrustedCert.databaseFromPEM(this.rootCerts),s=new this.subtls.WebSocketReadQueue(this.ws),n=s.read.bind(s),o=this.rawWrite.bind(this),{read:a,write:c}=await this.subtls.startTls(e,t,n,o,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=a,this.tlsWrite=c,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(e===void 0)break;{let t=re.from(e);this.emit("data",t)}}}rawWrite(e){if(!this.coalesceWrites){this.ws&&this.ws.send(e);return}if(this.writeBuffer===void 0)this.writeBuffer=e,setTimeout(()=>{this.ws&&this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+e.length);t.set(this.writeBuffer),t.set(e,this.writeBuffer.length),this.writeBuffer=t}}write(e,t="utf8",s=n=>{}){return e.length===0?(s(),!0):(typeof e=="string"&&(e=re.from(e,t)),this.tlsState===0?(this.rawWrite(e),s()):this.tlsState===1?this.once("secureConnection",()=>{this.write(e,t,s)}):(this.tlsWrite(e),s()),!0)}end(e=re.alloc(0),t="utf8",s=()=>{}){return this.write(e,t,()=>{this.ws.close(),s()}),this}destroy(){return this.destroyed=!0,this.end()}},_(Kr,"Socket"),se(Kr,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:_((r,e,t)=>{let s;return t?.jwtAuth?s=r.replace(ha,"apiauth."):s=r.replace(ha,"api."),"https://"+s+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:_(r=>r+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1,disableWarningInBrowsers:!1}),se(Kr,"opts",{}),Gr=Kr}),_h={};ut(_h,{parse:i(()=>ga,"parse")});function ga(r,e=!1){let{protocol:t}=new URL(r),s="http:"+r.substring(t.length),{username:n,password:o,host:a,hostname:c,port:l,pathname:d,search:f,searchParams:v,hash:y}=new URL(s);o=decodeURIComponent(o),n=decodeURIComponent(n),d=decodeURIComponent(d);let x=n+":"+o,m=e?Object.fromEntries(v.entries()):f;return{href:r,protocol:t,auth:x,username:n,password:o,host:a,hostname:c,port:l,pathname:d,search:f,query:m,hash:y}}i(ga,"Yt");var Eh=We(()=>{"use strict";X(),_(ga,"parse")}),xh=ue(r=>{"use strict";X(),r.parse=function(n,o){return new t(n,o).parse()};var e=class Ch{static{i(this,"vt")}constructor(o,a){this.source=o,this.transform=a||s,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var o=this.source[this.position++];return o==="\\"?{value:this.source[this.position++],escaped:!0}:{value:o,escaped:!1}}record(o){this.recorded.push(o)}newEntry(o){var a;(this.recorded.length>0||o)&&(a=this.recorded.join(""),a==="NULL"&&!o&&(a=null),a!==null&&(a=this.transform(a)),this.entries.push(a),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var o=this.nextCharacter();if(o.value==="=")break}}parse(o){var a,c,l;for(this.consumeDimensions();!this.isEof();)if(a=this.nextCharacter(),a.value==="{"&&!l)this.dimension++,this.dimension>1&&(c=new Ch(this.source.substr(this.position-1),this.transform),this.entries.push(c.parse(!0)),this.position+=c.position-2);else if(a.value==="}"&&!l){if(this.dimension--,!this.dimension&&(this.newEntry(),o))return this.entries}else a.value==='"'&&!a.escaped?(l&&this.newEntry(!0),l=!l):a.value===","&&!l?this.newEntry():this.record(a.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};_(e,"ArrayParser");var t=e;function s(n){return n}i(s,"Ca"),_(s,"identity")}),Th=ue((r,e)=>{X();var t=xh();e.exports={create:_(function(s,n){return{parse:_(function(){return t.parse(s,n)},"parse")}},"create")}}),_w=ue((r,e)=>{"use strict";X();var t=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,s=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,n=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,o=/^-?infinity$/;e.exports=_(function(f){if(o.test(f))return Number(f.replace("i","I"));var v=t.exec(f);if(!v)return a(f)||null;var y=!!v[8],x=parseInt(v[1],10);y&&(x=l(x));var m=parseInt(v[2],10)-1,h=v[3],E=parseInt(v[4],10),C=parseInt(v[5],10),P=parseInt(v[6],10),A=v[7];A=A?1e3*parseFloat(A):0;var B,k=c(f);return k!=null?(B=new Date(Date.UTC(x,m,h,E,C,P,A)),d(x)&&B.setUTCFullYear(x),k!==0&&B.setTime(B.getTime()-k)):(B=new Date(x,m,h,E,C,P,A),d(x)&&B.setFullYear(x)),B},"parseDate");function a(f){var v=s.exec(f);if(v){var y=parseInt(v[1],10),x=!!v[4];x&&(y=l(y));var m=parseInt(v[2],10)-1,h=v[3],E=new Date(y,m,h);return d(y)&&E.setFullYear(y),E}}i(a,"Ra"),_(a,"getDate");function c(f){if(f.endsWith("+00"))return 0;var v=n.exec(f.split(" ")[1]);if(v){var y=v[1];if(y==="Z")return 0;var x=y==="-"?-1:1,m=parseInt(v[2],10)*3600+parseInt(v[3]||0,10)*60+parseInt(v[4]||0,10);return m*x*1e3}}i(c,"La"),_(c,"timeZoneOffset");function l(f){return-(f-1)}i(l,"_i"),_(l,"bcYearToNegativeYear");function d(f){return f>=0&&f<100}i(d,"nr"),_(d,"is0To99")}),Ew=ue((r,e)=>{X(),e.exports=s;var t=Object.prototype.hasOwnProperty;function s(n){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var c in a)t.call(a,c)&&(n[c]=a[c])}return n}i(s,"ka"),_(s,"extend")}),xw=ue((r,e)=>{"use strict";X();var t=Ew();e.exports=s;function s(P){if(!(this instanceof s))return new s(P);t(this,C(P))}i(s,"ke"),_(s,"PostgresInterval");var n=["seconds","minutes","hours","days","months","years"];s.prototype.toPostgres=function(){var P=n.filter(this.hasOwnProperty,this);return this.milliseconds&&P.indexOf("seconds")<0&&P.push("seconds"),P.length===0?"0":P.map(function(A){var B=this[A]||0;return A==="seconds"&&this.milliseconds&&(B=(B+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),B+" "+A},this).join(" ")};var o={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},a=["years","months","days"],c=["hours","minutes","seconds"];s.prototype.toISOString=s.prototype.toISO=function(){var P=a.map(B,this).join(""),A=c.map(B,this).join("");return"P"+P+"T"+A;function B(k){var R=this[k]||0;return k==="seconds"&&this.milliseconds&&(R=(R+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),R+o[k]}};var l="([+-]?\\d+)",d=l+"\\s+years?",f=l+"\\s+mons?",v=l+"\\s+days?",y="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",x=new RegExp([d,f,v,y].map(function(P){return"("+P+")?"}).join("\\s*")),m={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},h=["hours","minutes","seconds","milliseconds"];function E(P){var A=P+"000000".slice(P.length);return parseInt(A,10)/1e3}i(E,"Ga"),_(E,"parseMilliseconds");function C(P){if(!P)return{};var A=x.exec(P),B=A[8]==="-";return Object.keys(m).reduce(function(k,R){var L=m[R],M=A[L];return!M||(M=R==="milliseconds"?E(M):parseInt(M,10),!M)||(B&&~h.indexOf(R)&&(M*=-1),k[R]=M),k},{})}i(C,"Va"),_(C,"parse")}),Cw=ue((r,e)=>{"use strict";X(),e.exports=_(function(t){if(/^\\x/.test(t))return new re(t.substr(2),"hex");for(var s="",n=0;n<t.length;)if(t[n]!=="\\")s+=t[n],++n;else if(/[0-7]{3}/.test(t.substr(n+1,3)))s+=String.fromCharCode(parseInt(t.substr(n+1,3),8)),n+=4;else{for(var o=1;n+o<t.length&&t[n+o]==="\\";)o++;for(var a=0;a<Math.floor(o/2);++a)s+="\\";n+=Math.floor(o/2)*2}return new re(s,"binary")},"parseBytea")}),Tw=ue((r,e)=>{X();var t=xh(),s=Th(),n=_w(),o=xw(),a=Cw();function c(N){return _(function(Q){return Q===null?Q:N(Q)},"nullAllowed")}i(c,"St"),_(c,"allowNull");function l(N){return N===null?N:N==="TRUE"||N==="t"||N==="true"||N==="y"||N==="yes"||N==="on"||N==="1"}i(l,"qi"),_(l,"parseBool");function d(N){return N?t.parse(N,l):null}i(d,"za"),_(d,"parseBoolArray");function f(N){return parseInt(N,10)}i(f,"Ka"),_(f,"parseBaseTenInt");function v(N){return N?t.parse(N,c(f)):null}i(v,"sr"),_(v,"parseIntegerArray");function y(N){return N?t.parse(N,c(function(Q){return B(Q).trim()})):null}i(y,"Ya"),_(y,"parseBigIntegerArray");var x=_(function(N){if(!N)return null;var Q=s.create(N,function(F){return F!==null&&(F=R(F)),F});return Q.parse()},"parsePointArray"),m=_(function(N){if(!N)return null;var Q=s.create(N,function(F){return F!==null&&(F=parseFloat(F)),F});return Q.parse()},"parseFloatArray"),h=_(function(N){if(!N)return null;var Q=s.create(N);return Q.parse()},"parseStringArray"),E=_(function(N){if(!N)return null;var Q=s.create(N,function(F){return F!==null&&(F=n(F)),F});return Q.parse()},"parseDateArray"),C=_(function(N){if(!N)return null;var Q=s.create(N,function(F){return F!==null&&(F=o(F)),F});return Q.parse()},"parseIntervalArray"),P=_(function(N){return N?t.parse(N,c(a)):null},"parseByteAArray"),A=_(function(N){return parseInt(N,10)},"parseInteger"),B=_(function(N){var Q=String(N);return/^\d+$/.test(Q)?Q:N},"parseBigInteger"),k=_(function(N){return N?t.parse(N,c(JSON.parse)):null},"parseJsonArray"),R=_(function(N){return N[0]!=="("?null:(N=N.substring(1,N.length-1).split(","),{x:parseFloat(N[0]),y:parseFloat(N[1])})},"parsePoint"),L=_(function(N){if(N[0]!=="<"&&N[1]!=="(")return null;for(var Q="(",F="",G=!1,Y=2;Y<N.length-1;Y++){if(G||(Q+=N[Y]),N[Y]===")"){G=!0;continue}else if(!G)continue;N[Y]!==","&&(F+=N[Y])}var q=R(Q);return q.radius=parseFloat(F),q},"parseCircle"),M=_(function(N){N(20,B),N(21,A),N(23,A),N(26,A),N(700,parseFloat),N(701,parseFloat),N(16,l),N(1082,n),N(1114,n),N(1184,n),N(600,R),N(651,h),N(718,L),N(1e3,d),N(1001,P),N(1005,v),N(1007,v),N(1028,v),N(1016,y),N(1017,x),N(1021,m),N(1022,m),N(1231,m),N(1014,h),N(1015,h),N(1008,h),N(1009,h),N(1040,h),N(1041,h),N(1115,E),N(1182,E),N(1185,E),N(1186,o),N(1187,C),N(17,a),N(114,JSON.parse.bind(JSON)),N(3802,JSON.parse.bind(JSON)),N(199,k),N(3807,k),N(3907,h),N(2951,h),N(791,h),N(1183,h),N(1270,h)},"init");e.exports={init:M}}),Pw=ue((r,e)=>{"use strict";X();var t=1e6;function s(n){var o=n.readInt32BE(0),a=n.readUInt32BE(4),c="";o<0&&(o=~o+(a===0),a=~a+1>>>0,c="-");var l="",d,f,v,y,x,m;{if(d=o%t,o=o/t>>>0,f=4294967296*d+a,a=f/t>>>0,v=""+(f-t*a),a===0&&o===0)return c+v+l;for(y="",x=6-v.length,m=0;m<x;m++)y+="0";l=y+v+l}{if(d=o%t,o=o/t>>>0,f=4294967296*d+a,a=f/t>>>0,v=""+(f-t*a),a===0&&o===0)return c+v+l;for(y="",x=6-v.length,m=0;m<x;m++)y+="0";l=y+v+l}{if(d=o%t,o=o/t>>>0,f=4294967296*d+a,a=f/t>>>0,v=""+(f-t*a),a===0&&o===0)return c+v+l;for(y="",x=6-v.length,m=0;m<x;m++)y+="0";l=y+v+l}return d=o%t,f=4294967296*d+a,v=""+f%t,c+v+l}i(s,"ru"),_(s,"readInt8"),e.exports=s}),Aw=ue((r,e)=>{X();var t=Pw(),s=_(function(h,E,C,P,A){C=C||0,P=P||!1,A=A||function(G,Y,q){return G*Math.pow(2,q)+Y};var B=C>>3,k=_(function(G){return P?~G&255:G},"inv"),R=255,L=8-C%8;E<L&&(R=255<<8-E&255,L=E),C&&(R=R>>C%8);var M=0;C%8+E>=8&&(M=A(0,k(h[B])&R,L));for(var N=E+C>>3,Q=B+1;Q<N;Q++)M=A(M,k(h[Q]),8);var F=(E+C)%8;return F>0&&(M=A(M,k(h[N])>>8-F,F)),M},"parseBits"),n=_(function(h,E,C){var P=Math.pow(2,C-1)-1,A=s(h,1),B=s(h,C,1);if(B===0)return 0;var k=1,R=_(function(M,N,Q){M===0&&(M=1);for(var F=1;F<=Q;F++)k/=2,(N&1<<Q-F)>0&&(M+=k);return M},"parsePrecisionBits"),L=s(h,E,C+1,!1,R);return B==Math.pow(2,C+1)-1?L===0?A===0?1/0:-1/0:NaN:(A===0?1:-1)*Math.pow(2,B-P)*L},"parseFloatFromBits"),o=_(function(h){return s(h,1)==1?-1*(s(h,15,1,!0)+1):s(h,15,1)},"parseInt16"),a=_(function(h){return s(h,1)==1?-1*(s(h,31,1,!0)+1):s(h,31,1)},"parseInt32"),c=_(function(h){return n(h,23,8)},"parseFloat32"),l=_(function(h){return n(h,52,11)},"parseFloat64"),d=_(function(h){var E=s(h,16,32);if(E==49152)return NaN;for(var C=Math.pow(1e4,s(h,16,16)),P=0,A=[],B=s(h,16),k=0;k<B;k++)P+=s(h,16,64+16*k)*C,C/=1e4;var R=Math.pow(10,s(h,16,48));return(E===0?1:-1)*Math.round(P*R)/R},"parseNumeric"),f=_(function(h,E){var C=s(E,1),P=s(E,63,1),A=new Date((C===0?1:-1)*P/1e3+9466848e5);return h||A.setTime(A.getTime()+A.getTimezoneOffset()*6e4),A.usec=P%1e3,A.getMicroSeconds=function(){return this.usec},A.setMicroSeconds=function(B){this.usec=B},A.getUTCMicroSeconds=function(){return this.usec},A},"parseDate"),v=_(function(h){for(var E=s(h,32),C=s(h,32,32),P=s(h,32,64),A=96,B=[],k=0;k<E;k++)B[k]=s(h,32,A),A+=32,A+=32;var R=_(function(M){var N=s(h,32,A);if(A+=32,N==4294967295)return null;var Q;if(M==23||M==20)return Q=s(h,N*8,A),A+=N*8,Q;if(M==25)return Q=h.toString(this.encoding,A>>3,(A+=N<<3)>>3),Q;console.log("ERROR: ElementType not implemented: "+M)},"parseElement"),L=_(function(M,N){var Q=[],F;if(M.length>1){var G=M.shift();for(F=0;F<G;F++)Q[F]=L(M,N);M.unshift(G)}else for(F=0;F<M[0];F++)Q[F]=R(N);return Q},"parse");return L(B,P)},"parseArray"),y=_(function(h){return h.toString("utf8")},"parseText"),x=_(function(h){return h===null?null:s(h,8)>0},"parseBool"),m=_(function(h){h(20,t),h(21,o),h(23,a),h(26,a),h(1700,d),h(700,c),h(701,l),h(16,x),h(1114,f.bind(null,!1)),h(1184,f.bind(null,!0)),h(1e3,v),h(1007,v),h(1016,v),h(1008,v),h(1009,v),h(25,y)},"init");e.exports={init:m}}),Rw=ue((r,e)=>{X(),e.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),Xs=ue(r=>{X();var e=Tw(),t=Aw(),s=Th(),n=Rw();r.getTypeParser=c,r.setTypeParser=l,r.arrayParser=s,r.builtins=n;var o={text:{},binary:{}};function a(d){return String(d)}i(a,"Ji"),_(a,"noParse");function c(d,f){return f=f||"text",o[f]&&o[f][d]||a}i(c,"yu"),_(c,"getTypeParser");function l(d,f,v){typeof f=="function"&&(v=f,f="text"),o[f][d]=v}i(l,"mu"),_(l,"setTypeParser"),e.init(function(d,f){o.text[d]=f}),t.init(function(d,f){o.binary[d]=f})}),ba=ue((r,e)=>{"use strict";X();var t=Xs();function s(n){this._types=n||t,this.text={},this.binary={}}i(s,"Et"),_(s,"TypeOverrides"),s.prototype.getOverrides=function(n){switch(n){case"text":return this.text;case"binary":return this.binary;default:return{}}},s.prototype.setTypeParser=function(n,o,a){typeof o=="function"&&(a=o,o="text"),this.getOverrides(o)[n]=a},s.prototype.getTypeParser=function(n,o){return o=o||"text",this.getOverrides(o)[n]||this._types.getTypeParser(n,o)},e.exports=s});function Wr(r){let e=1779033703,t=3144134277,s=1013904242,n=2773480762,o=1359893119,a=2600822924,c=528734635,l=1541459225,d=0,f=0,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],y=_((P,A)=>P>>>A|P<<32-A,"rrot"),x=new Uint32Array(64),m=new Uint8Array(64),h=_(()=>{for(let Q=0,F=0;Q<16;Q++,F+=4)x[Q]=m[F]<<24|m[F+1]<<16|m[F+2]<<8|m[F+3];for(let Q=16;Q<64;Q++){let F=y(x[Q-15],7)^y(x[Q-15],18)^x[Q-15]>>>3,G=y(x[Q-2],17)^y(x[Q-2],19)^x[Q-2]>>>10;x[Q]=x[Q-16]+F+x[Q-7]+G|0}let P=e,A=t,B=s,k=n,R=o,L=a,M=c,N=l;for(let Q=0;Q<64;Q++){let F=y(R,6)^y(R,11)^y(R,25),G=R&L^~R&M,Y=N+F+G+v[Q]+x[Q]|0,q=y(P,2)^y(P,13)^y(P,22),K=P&A^P&B^A&B,ee=q+K|0;N=M,M=L,L=R,R=k+Y|0,k=B,B=A,A=P,P=Y+ee|0}e=e+P|0,t=t+A|0,s=s+B|0,n=n+k|0,o=o+R|0,a=a+L|0,c=c+M|0,l=l+N|0,f=0},"process"),E=_(P=>{typeof P=="string"&&(P=new TextEncoder().encode(P));for(let A=0;A<P.length;A++)m[f++]=P[A],f===64&&h();d+=P.length},"add"),C=_(()=>{if(m[f++]=128,f==64&&h(),f+8>64){for(;f<64;)m[f++]=0;h()}for(;f<58;)m[f++]=0;let P=d*8;m[f++]=P/1099511627776&255,m[f++]=P/4294967296&255,m[f++]=P>>>24,m[f++]=P>>>16&255,m[f++]=P>>>8&255,m[f++]=P&255,h();let A=new Uint8Array(32);return A[0]=e>>>24,A[1]=e>>>16&255,A[2]=e>>>8&255,A[3]=e&255,A[4]=t>>>24,A[5]=t>>>16&255,A[6]=t>>>8&255,A[7]=t&255,A[8]=s>>>24,A[9]=s>>>16&255,A[10]=s>>>8&255,A[11]=s&255,A[12]=n>>>24,A[13]=n>>>16&255,A[14]=n>>>8&255,A[15]=n&255,A[16]=o>>>24,A[17]=o>>>16&255,A[18]=o>>>8&255,A[19]=o&255,A[20]=a>>>24,A[21]=a>>>16&255,A[22]=a>>>8&255,A[23]=a&255,A[24]=c>>>24,A[25]=c>>>16&255,A[26]=c>>>8&255,A[27]=c&255,A[28]=l>>>24,A[29]=l>>>16&255,A[30]=l>>>8&255,A[31]=l&255,A},"digest");return r===void 0?{add:E,digest:C}:(E(r),C())}i(Wr,"Xe");var Nw=We(()=>{"use strict";X(),_(Wr,"sha256")}),wt,pa,Ow=We(()=>{"use strict";X(),wt=class tt{static{i(this,"U")}constructor(){se(this,"_dataLength",0),se(this,"_bufferLength",0),se(this,"_state",new Int32Array(4)),se(this,"_buffer",new ArrayBuffer(68)),se(this,"_buffer8"),se(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,t=!1){return this.onePassHasher.start().appendByteArray(e).end(t)}static hashStr(e,t=!1){return this.onePassHasher.start().appendStr(e).end(t)}static hashAsciiStr(e,t=!1){return this.onePassHasher.start().appendAsciiStr(e).end(t)}static _hex(e){let t=tt.hexChars,s=tt.hexOut,n,o,a,c;for(c=0;c<4;c+=1)for(o=c*8,n=e[c],a=0;a<8;a+=2)s[o+1+a]=t.charAt(n&15),n>>>=4,s[o+0+a]=t.charAt(n&15),n>>>=4;return s.join("")}static _md5cycle(e,t){let s=e[0],n=e[1],o=e[2],a=e[3];s+=(n&o|~n&a)+t[0]-680876936|0,s=(s<<7|s>>>25)+n|0,a+=(s&n|~s&o)+t[1]-389564586|0,a=(a<<12|a>>>20)+s|0,o+=(a&s|~a&n)+t[2]+606105819|0,o=(o<<17|o>>>15)+a|0,n+=(o&a|~o&s)+t[3]-1044525330|0,n=(n<<22|n>>>10)+o|0,s+=(n&o|~n&a)+t[4]-176418897|0,s=(s<<7|s>>>25)+n|0,a+=(s&n|~s&o)+t[5]+1200080426|0,a=(a<<12|a>>>20)+s|0,o+=(a&s|~a&n)+t[6]-1473231341|0,o=(o<<17|o>>>15)+a|0,n+=(o&a|~o&s)+t[7]-45705983|0,n=(n<<22|n>>>10)+o|0,s+=(n&o|~n&a)+t[8]+1770035416|0,s=(s<<7|s>>>25)+n|0,a+=(s&n|~s&o)+t[9]-1958414417|0,a=(a<<12|a>>>20)+s|0,o+=(a&s|~a&n)+t[10]-42063|0,o=(o<<17|o>>>15)+a|0,n+=(o&a|~o&s)+t[11]-1990404162|0,n=(n<<22|n>>>10)+o|0,s+=(n&o|~n&a)+t[12]+1804603682|0,s=(s<<7|s>>>25)+n|0,a+=(s&n|~s&o)+t[13]-40341101|0,a=(a<<12|a>>>20)+s|0,o+=(a&s|~a&n)+t[14]-1502002290|0,o=(o<<17|o>>>15)+a|0,n+=(o&a|~o&s)+t[15]+1236535329|0,n=(n<<22|n>>>10)+o|0,s+=(n&a|o&~a)+t[1]-165796510|0,s=(s<<5|s>>>27)+n|0,a+=(s&o|n&~o)+t[6]-1069501632|0,a=(a<<9|a>>>23)+s|0,o+=(a&n|s&~n)+t[11]+643717713|0,o=(o<<14|o>>>18)+a|0,n+=(o&s|a&~s)+t[0]-373897302|0,n=(n<<20|n>>>12)+o|0,s+=(n&a|o&~a)+t[5]-701558691|0,s=(s<<5|s>>>27)+n|0,a+=(s&o|n&~o)+t[10]+38016083|0,a=(a<<9|a>>>23)+s|0,o+=(a&n|s&~n)+t[15]-660478335|0,o=(o<<14|o>>>18)+a|0,n+=(o&s|a&~s)+t[4]-405537848|0,n=(n<<20|n>>>12)+o|0,s+=(n&a|o&~a)+t[9]+568446438|0,s=(s<<5|s>>>27)+n|0,a+=(s&o|n&~o)+t[14]-1019803690|0,a=(a<<9|a>>>23)+s|0,o+=(a&n|s&~n)+t[3]-187363961|0,o=(o<<14|o>>>18)+a|0,n+=(o&s|a&~s)+t[8]+1163531501|0,n=(n<<20|n>>>12)+o|0,s+=(n&a|o&~a)+t[13]-1444681467|0,s=(s<<5|s>>>27)+n|0,a+=(s&o|n&~o)+t[2]-51403784|0,a=(a<<9|a>>>23)+s|0,o+=(a&n|s&~n)+t[7]+1735328473|0,o=(o<<14|o>>>18)+a|0,n+=(o&s|a&~s)+t[12]-1926607734|0,n=(n<<20|n>>>12)+o|0,s+=(n^o^a)+t[5]-378558|0,s=(s<<4|s>>>28)+n|0,a+=(s^n^o)+t[8]-2022574463|0,a=(a<<11|a>>>21)+s|0,o+=(a^s^n)+t[11]+1839030562|0,o=(o<<16|o>>>16)+a|0,n+=(o^a^s)+t[14]-35309556|0,n=(n<<23|n>>>9)+o|0,s+=(n^o^a)+t[1]-1530992060|0,s=(s<<4|s>>>28)+n|0,a+=(s^n^o)+t[4]+1272893353|0,a=(a<<11|a>>>21)+s|0,o+=(a^s^n)+t[7]-155497632|0,o=(o<<16|o>>>16)+a|0,n+=(o^a^s)+t[10]-1094730640|0,n=(n<<23|n>>>9)+o|0,s+=(n^o^a)+t[13]+681279174|0,s=(s<<4|s>>>28)+n|0,a+=(s^n^o)+t[0]-358537222|0,a=(a<<11|a>>>21)+s|0,o+=(a^s^n)+t[3]-722521979|0,o=(o<<16|o>>>16)+a|0,n+=(o^a^s)+t[6]+76029189|0,n=(n<<23|n>>>9)+o|0,s+=(n^o^a)+t[9]-640364487|0,s=(s<<4|s>>>28)+n|0,a+=(s^n^o)+t[12]-421815835|0,a=(a<<11|a>>>21)+s|0,o+=(a^s^n)+t[15]+530742520|0,o=(o<<16|o>>>16)+a|0,n+=(o^a^s)+t[2]-995338651|0,n=(n<<23|n>>>9)+o|0,s+=(o^(n|~a))+t[0]-198630844|0,s=(s<<6|s>>>26)+n|0,a+=(n^(s|~o))+t[7]+1126891415|0,a=(a<<10|a>>>22)+s|0,o+=(s^(a|~n))+t[14]-1416354905|0,o=(o<<15|o>>>17)+a|0,n+=(a^(o|~s))+t[5]-57434055|0,n=(n<<21|n>>>11)+o|0,s+=(o^(n|~a))+t[12]+1700485571|0,s=(s<<6|s>>>26)+n|0,a+=(n^(s|~o))+t[3]-1894986606|0,a=(a<<10|a>>>22)+s|0,o+=(s^(a|~n))+t[10]-1051523|0,o=(o<<15|o>>>17)+a|0,n+=(a^(o|~s))+t[1]-2054922799|0,n=(n<<21|n>>>11)+o|0,s+=(o^(n|~a))+t[8]+1873313359|0,s=(s<<6|s>>>26)+n|0,a+=(n^(s|~o))+t[15]-30611744|0,a=(a<<10|a>>>22)+s|0,o+=(s^(a|~n))+t[6]-1560198380|0,o=(o<<15|o>>>17)+a|0,n+=(a^(o|~s))+t[13]+1309151649|0,n=(n<<21|n>>>11)+o|0,s+=(o^(n|~a))+t[4]-145523070|0,s=(s<<6|s>>>26)+n|0,a+=(n^(s|~o))+t[11]-1120210379|0,a=(a<<10|a>>>22)+s|0,o+=(s^(a|~n))+t[2]+718787259|0,o=(o<<15|o>>>17)+a|0,n+=(a^(o|~s))+t[9]-343485551|0,n=(n<<21|n>>>11)+o|0,e[0]=s+e[0]|0,e[1]=n+e[1]|0,e[2]=o+e[2]|0,e[3]=a+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(tt.stateIdentity),this}appendStr(e){let t=this._buffer8,s=this._buffer32,n=this._bufferLength,o,a;for(a=0;a<e.length;a+=1){if(o=e.charCodeAt(a),o<128)t[n++]=o;else if(o<2048)t[n++]=(o>>>6)+192,t[n++]=o&63|128;else if(o<55296||o>56319)t[n++]=(o>>>12)+224,t[n++]=o>>>6&63|128,t[n++]=o&63|128;else{if(o=(o-55296)*1024+(e.charCodeAt(++a)-56320)+65536,o>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");t[n++]=(o>>>18)+240,t[n++]=o>>>12&63|128,t[n++]=o>>>6&63|128,t[n++]=o&63|128}n>=64&&(this._dataLength+=64,tt._md5cycle(this._state,s),n-=64,s[0]=s[16])}return this._bufferLength=n,this}appendAsciiStr(e){let t=this._buffer8,s=this._buffer32,n=this._bufferLength,o,a=0;for(;;){for(o=Math.min(e.length-a,64-n);o--;)t[n++]=e.charCodeAt(a++);if(n<64)break;this._dataLength+=64,tt._md5cycle(this._state,s),n=0}return this._bufferLength=n,this}appendByteArray(e){let t=this._buffer8,s=this._buffer32,n=this._bufferLength,o,a=0;for(;;){for(o=Math.min(e.length-a,64-n);o--;)t[n++]=e[a++];if(n<64)break;this._dataLength+=64,tt._md5cycle(this._state,s),n=0}return this._bufferLength=n,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let t=e.buffer,s=e.state,n=this._state,o;for(this._dataLength=e.length,this._bufferLength=e.buflen,n[0]=s[0],n[1]=s[1],n[2]=s[2],n[3]=s[3],o=0;o<t.length;o+=1)this._buffer8[o]=t.charCodeAt(o)}end(e=!1){let t=this._bufferLength,s=this._buffer8,n=this._buffer32,o=(t>>2)+1;this._dataLength+=t;let a=this._dataLength*8;if(s[t]=128,s[t+1]=s[t+2]=s[t+3]=0,n.set(tt.buffer32Identity.subarray(o),o),t>55&&(tt._md5cycle(this._state,n),n.set(tt.buffer32Identity)),a<=4294967295)n[14]=a;else{let c=a.toString(16).match(/(.*?)(.{0,8})$/);if(c===null)return;let l=parseInt(c[2],16),d=parseInt(c[1],16)||0;n[14]=l,n[15]=d}return tt._md5cycle(this._state,n),e?this._state:tt._hex(this._state)}},_(wt,"Md5"),se(wt,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),se(wt,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),se(wt,"hexChars","0123456789abcdef"),se(wt,"hexOut",[]),se(wt,"onePassHasher",new wt),pa=wt}),wa={};ut(wa,{createHash:i(()=>Ah,"createHash"),createHmac:i(()=>Rh,"createHmac"),randomBytes:i(()=>Ph,"randomBytes")});function Ph(r){return crypto.getRandomValues(re.alloc(r))}i(Ph,"gu");function Ah(r){if(r==="sha256")return{update:_(function(e){return{digest:_(function(){return re.from(Wr(e))},"digest")}},"update")};if(r==="md5")return{update:_(function(e){return{digest:_(function(){return typeof e=="string"?pa.hashStr(e):pa.hashByteArray(e)},"digest")}},"update")};throw new Error(`Hash type '${r}' not supported`)}i(Ah,"bu");function Rh(r,e){if(r!=="sha256")throw new Error(`Only sha256 is supported (requested: '${r}')`);return{update:_(function(t){return{digest:_(function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));let s=e.length;if(s>64)e=Wr(e);else if(s<64){let l=new Uint8Array(64);l.set(e),e=l}let n=new Uint8Array(64),o=new Uint8Array(64);for(let l=0;l<64;l++)n[l]=54^e[l],o[l]=92^e[l];let a=new Uint8Array(t.length+64);a.set(n,0),a.set(t,64);let c=new Uint8Array(96);return c.set(o,0),c.set(Wr(a),64),re.from(Wr(c))},"digest")}},"update")}}i(Rh,"vu");var Nh=We(()=>{"use strict";X(),Nw(),Ow(),_(Ph,"randomBytes"),_(Ah,"createHash"),_(Rh,"createHmac")}),Zs=ue((r,e)=>{"use strict";X(),e.exports={host:"localhost",user:ce.platform==="win32"?ce.env.USERNAME:ce.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var t=Xs(),s=t.getTypeParser(20,"text"),n=t.getTypeParser(1016,"text");e.exports.__defineSetter__("parseInt8",function(o){t.setTypeParser(20,"text",o?t.getTypeParser(23,"text"):s),t.setTypeParser(1016,"text",o?t.getTypeParser(1007,"text"):n)})}),en=ue((r,e)=>{"use strict";X();var t=(Nh(),qe(wa)),s=Zs();function n(m){var h=m.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+h+'"'}i(n,"Cu"),_(n,"escapeElement");function o(m){for(var h="{",E=0;E<m.length;E++)E>0&&(h=h+","),m[E]===null||typeof m[E]>"u"?h=h+"NULL":Array.isArray(m[E])?h=h+o(m[E]):m[E]instanceof re?h+="\\\\x"+m[E].toString("hex"):h+=n(a(m[E]));return h=h+"}",h}i(o,"rs"),_(o,"arrayString");var a=_(function(m,h){if(m==null)return null;if(m instanceof re)return m;if(ArrayBuffer.isView(m)){var E=re.from(m.buffer,m.byteOffset,m.byteLength);return E.length===m.byteLength?E:E.slice(m.byteOffset,m.byteOffset+m.byteLength)}return m instanceof Date?s.parseInputDatesAsUTC?f(m):d(m):Array.isArray(m)?o(m):typeof m=="object"?c(m,h):m.toString()},"prepareValue");function c(m,h){if(m&&typeof m.toPostgres=="function"){if(h=h||[],h.indexOf(m)!==-1)throw new Error('circular reference detected while preparing "'+m+'" for query');return h.push(m),a(m.toPostgres(a),h)}return JSON.stringify(m)}i(c,"_u"),_(c,"prepareObject");function l(m,h){for(m=""+m;m.length<h;)m="0"+m;return m}i(l,"N"),_(l,"pad");function d(m){var h=-m.getTimezoneOffset(),E=m.getFullYear(),C=E<1;C&&(E=Math.abs(E)+1);var P=l(E,4)+"-"+l(m.getMonth()+1,2)+"-"+l(m.getDate(),2)+"T"+l(m.getHours(),2)+":"+l(m.getMinutes(),2)+":"+l(m.getSeconds(),2)+"."+l(m.getMilliseconds(),3);return h<0?(P+="-",h*=-1):P+="+",P+=l(Math.floor(h/60),2)+":"+l(h%60,2),C&&(P+=" BC"),P}i(d,"Iu"),_(d,"dateToString");function f(m){var h=m.getUTCFullYear(),E=h<1;E&&(h=Math.abs(h)+1);var C=l(h,4)+"-"+l(m.getUTCMonth()+1,2)+"-"+l(m.getUTCDate(),2)+"T"+l(m.getUTCHours(),2)+":"+l(m.getUTCMinutes(),2)+":"+l(m.getUTCSeconds(),2)+"."+l(m.getUTCMilliseconds(),3);return C+="+00:00",E&&(C+=" BC"),C}i(f,"Tu"),_(f,"dateToStringUTC");function v(m,h,E){return m=typeof m=="string"?{text:m}:m,h&&(typeof h=="function"?m.callback=h:m.values=h),E&&(m.callback=E),m}i(v,"Pu"),_(v,"normalizeQueryConfig");var y=_(function(m){return t.createHash("md5").update(m,"utf-8").digest("hex")},"md5"),x=_(function(m,h,E){var C=y(h+m),P=y(re.concat([re.from(C),E]));return"md5"+P},"postgresMd5PasswordHash");e.exports={prepareValue:_(function(m){return a(m)},"prepareValueWrapper"),normalizeQueryConfig:v,postgresMd5PasswordHash:x,md5:y}}),Jr={};ut(Jr,{default:i(()=>Oh,"default")});var Oh,tn=We(()=>{"use strict";X(),Oh={}}),Iw=ue((r,e)=>{"use strict";X();var t=(Nh(),qe(wa));function s(h){if(h.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let E=t.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:E,response:"n,,n=*,r="+E,message:"SASLInitialResponse"}}i(s,"Mu"),_(s,"startSession");function n(h,E,C){if(h.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof E!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof C!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let P=d(C);if(P.nonce.startsWith(h.clientNonce)){if(P.nonce.length===h.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var A=re.from(P.salt,"base64"),B=m(E,A,P.iteration),k=x(B,"Client Key"),R=y(k),L="n=*,r="+h.clientNonce,M="r="+P.nonce+",s="+P.salt+",i="+P.iteration,N="c=biws,r="+P.nonce,Q=L+","+M+","+N,F=x(R,Q),G=v(k,F),Y=G.toString("base64"),q=x(B,"Server Key"),K=x(q,Q);h.message="SASLResponse",h.serverSignature=K.toString("base64"),h.response=N+",p="+Y}i(n,"Uu"),_(n,"continueSession");function o(h,E){if(h.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof E!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:C}=f(E);if(C!==h.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}i(o,"Du"),_(o,"finalizeSession");function a(h){if(typeof h!="string")throw new TypeError("SASL: text must be a string");return h.split("").map((E,C)=>h.charCodeAt(C)).every(E=>E>=33&&E<=43||E>=45&&E<=126)}i(a,"Ou"),_(a,"isPrintableChars");function c(h){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(h)}i(c,"ls"),_(c,"isBase64");function l(h){if(typeof h!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(h.split(",").map(E=>{if(!/^.=/.test(E))throw new Error("SASL: Invalid attribute pair entry");let C=E[0],P=E.substring(2);return[C,P]}))}i(l,"fs"),_(l,"parseAttributePairs");function d(h){let E=l(h),C=E.get("r");if(C){if(!a(C))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let P=E.get("s");if(P){if(!c(P))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let A=E.get("i");if(A){if(!/^[1-9][0-9]*$/.test(A))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let B=parseInt(A,10);return{nonce:C,salt:P,iteration:B}}i(d,"qu"),_(d,"parseServerFirstMessage");function f(h){let E=l(h).get("v");if(E){if(!c(E))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:E}}i(f,"Qu"),_(f,"parseServerFinalMessage");function v(h,E){if(!re.isBuffer(h))throw new TypeError("first argument must be a Buffer");if(!re.isBuffer(E))throw new TypeError("second argument must be a Buffer");if(h.length!==E.length)throw new Error("Buffer lengths must match");if(h.length===0)throw new Error("Buffers cannot be empty");return re.from(h.map((C,P)=>h[P]^E[P]))}i(v,"hs"),_(v,"xorBuffers");function y(h){return t.createHash("sha256").update(h).digest()}i(y,"Nu"),_(y,"sha256");function x(h,E){return t.createHmac("sha256",h).update(E).digest()}i(x,"Ue"),_(x,"hmacSha256");function m(h,E,C){for(var P=x(h,re.concat([E,re.from([0,0,0,1])])),A=P,B=0;B<C-1;B++)P=x(h,P),A=v(A,P);return A}i(m,"Wu"),_(m,"Hi"),e.exports={startSession:s,continueSession:n,finalizeSession:o}}),Sa={};ut(Sa,{join:i(()=>Ih,"join")});function Ih(...r){return r.join("/")}i(Ih,"ju");var Lh=We(()=>{"use strict";X(),_(Ih,"join")}),va={};ut(va,{stat:i(()=>Mh,"stat")});function Mh(r,e){e(new Error("No filesystem"))}i(Mh,"Hu");var Dh=We(()=>{"use strict";X(),_(Mh,"stat")}),_a={};ut(_a,{default:i(()=>Bh,"default")});var Bh,kh=We(()=>{"use strict";X(),Bh={}}),Fh={};ut(Fh,{StringDecoder:i(()=>qh,"StringDecoder")});var fa,qh,Lw=We(()=>{"use strict";X(),fa=class{static{i(this,"Er")}constructor(e){se(this,"td"),this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}},_(fa,"StringDecoder"),qh=fa}),Mw=ue((r,e)=>{"use strict";X();var{Transform:t}=(kh(),qe(_a)),{StringDecoder:s}=(Lw(),qe(Fh)),n=Symbol("last"),o=Symbol("decoder");function a(v,y,x){let m;if(this.overflow){if(m=this[o].write(v).split(this.matcher),m.length===1)return x();m.shift(),this.overflow=!1}else this[n]+=this[o].write(v),m=this[n].split(this.matcher);this[n]=m.pop();for(let h=0;h<m.length;h++)try{l(this,this.mapper(m[h]))}catch(E){return x(E)}if(this.overflow=this[n].length>this.maxLength,this.overflow&&!this.skipOverflow){x(new Error("maximum buffer reached"));return}x()}i(a,"zu"),_(a,"transform");function c(v){if(this[n]+=this[o].end(),this[n])try{l(this,this.mapper(this[n]))}catch(y){return v(y)}v()}i(c,"Ku"),_(c,"flush");function l(v,y){y!==void 0&&v.push(y)}i(l,"gs"),_(l,"push");function d(v){return v}i(d,"ws"),_(d,"noop");function f(v,y,x){switch(v=v||/\r?\n/,y=y||d,x=x||{},arguments.length){case 1:typeof v=="function"?(y=v,v=/\r?\n/):typeof v=="object"&&!(v instanceof RegExp)&&!v[Symbol.split]&&(x=v,v=/\r?\n/);break;case 2:typeof v=="function"?(x=y,y=v,v=/\r?\n/):typeof y=="object"&&(x=y,y=d)}x=Object.assign({},x),x.autoDestroy=!0,x.transform=a,x.flush=c,x.readableObjectMode=!0;let m=new t(x);return m[n]="",m[o]=new s("utf8"),m.matcher=v,m.mapper=y,m.maxLength=x.maxLength,m.skipOverflow=x.skipOverflow||!1,m.overflow=!1,m._destroy=function(h,E){this._writableState.errorEmitted=!1,E(h)},m}i(f,"Yu"),_(f,"split"),e.exports=f}),Dw=ue((r,e)=>{"use strict";X();var t=(Lh(),qe(Sa)),s=(kh(),qe(_a)).Stream,n=Mw(),o=(tn(),qe(Jr)),a=5432,c=ce.platform==="win32",l=ce.stderr,d=56,f=7,v=61440,y=32768;function x(k){return(k&v)==y}i(x,"ic"),_(x,"isRegFile");var m=["host","port","database","user","password"],h=m.length,E=m[h-1];function C(){var k=l instanceof s&&l.writable===!0;if(k){var R=Array.prototype.slice.call(arguments).concat(`
`);l.write(o.format.apply(o,R))}}i(C,"Cr"),_(C,"warn"),Object.defineProperty(e.exports,"isWin",{get:_(function(){return c},"get"),set:_(function(k){c=k},"set")}),e.exports.warnTo=function(k){var R=l;return l=k,R},e.exports.getFileName=function(k){var R=k||ce.env,L=R.PGPASSFILE||(c?t.join(R.APPDATA||"./","postgresql","pgpass.conf"):t.join(R.HOME||"./",".pgpass"));return L},e.exports.usePgPass=function(k,R){return Object.prototype.hasOwnProperty.call(ce.env,"PGPASSWORD")?!1:c?!0:(R=R||"<unkn>",x(k.mode)?k.mode&(d|f)?(C('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',R),!1):!0:(C('WARNING: password file "%s" is not a plain file',R),!1))};var P=e.exports.match=function(k,R){return m.slice(0,-1).reduce(function(L,M,N){return N==1&&Number(k[M]||a)===Number(R[M])?L&&!0:L&&(R[M]==="*"||R[M]===k[M])},!0)};e.exports.getPassword=function(k,R,L){var M,N=R.pipe(n());function Q(Y){var q=A(Y);q&&B(q)&&P(k,q)&&(M=q[E],N.end())}i(Q,"s"),_(Q,"onLine");var F=_(function(){R.destroy(),L(M)},"onEnd"),G=_(function(Y){R.destroy(),C("WARNING: error on reading file: %s",Y),L(void 0)},"onErr");R.on("error",G),N.on("data",Q).on("end",F).on("error",G)};var A=e.exports.parseLine=function(k){if(k.length<11||k.match(/^\s+#/))return null;for(var R="",L="",M=0,N=0,Q=0,F={},G=!1,Y=_(function(K,ee,oe){var he=k.substring(ee,oe);Object.hasOwnProperty.call(ce.env,"PGPASS_NO_DEESCAPE")||(he=he.replace(/\\([:\\])/g,"$1")),F[m[K]]=he},"addToObj"),q=0;q<k.length-1;q+=1){if(R=k.charAt(q+1),L=k.charAt(q),G=M==h-1,G){Y(M,N);break}q>=0&&R==":"&&L!=="\\"&&(Y(M,N,q+1),N=q+2,M+=1)}return F=Object.keys(F).length===h?F:null,F},B=e.exports.isValidEntry=function(k){for(var R={0:function(F){return F.length>0},1:function(F){return F==="*"?!0:(F=Number(F),isFinite(F)&&F>0&&F<9007199254740992&&Math.floor(F)===F)},2:function(F){return F.length>0},3:function(F){return F.length>0},4:function(F){return F.length>0}},L=0;L<m.length;L+=1){var M=R[L],N=k[m[L]]||"",Q=M(N);if(!Q)return!1}return!0}}),Bw=ue((r,e)=>{"use strict";X();var t=(Lh(),qe(Sa)),s=(Dh(),qe(va)),n=Dw();e.exports=function(o,a){var c=n.getFileName();s.stat(c,function(l,d){if(l||!n.usePgPass(d,c))return a(void 0);var f=s.createReadStream(c);n.getPassword(o,f,a)})},e.exports.warnTo=n.warnTo}),Qh={};ut(Qh,{default:i(()=>Uh,"default")});var Uh,kw=We(()=>{"use strict";X(),Uh={}}),Fw=ue((r,e)=>{"use strict";X();var t=(Eh(),qe(_h)),s=(Dh(),qe(va));function n(o){if(o.charAt(0)==="/"){var c=o.split(" ");return{host:c[0],database:c[1]}}var a=t.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(o)?encodeURI(o).replace(/\%25(\d\d)/g,"%$1"):o,!0),c=a.query;for(var l in c)Array.isArray(c[l])&&(c[l]=c[l][c[l].length-1]);var d=(a.auth||":").split(":");if(c.user=d[0],c.password=d.splice(1).join(":"),c.port=a.port,a.protocol=="socket:")return c.host=decodeURI(a.pathname),c.database=a.query.db,c.client_encoding=a.query.encoding,c;c.host||(c.host=a.hostname);var f=a.pathname;if(!c.host&&f&&/^%2f/i.test(f)){var v=f.split("/");c.host=decodeURIComponent(v[0]),f=v.splice(1).join("/")}switch(f&&f.charAt(0)==="/"&&(f=f.slice(1)||null),c.database=f&&decodeURI(f),(c.ssl==="true"||c.ssl==="1")&&(c.ssl=!0),c.ssl==="0"&&(c.ssl=!1),(c.sslcert||c.sslkey||c.sslrootcert||c.sslmode)&&(c.ssl={}),c.sslcert&&(c.ssl.cert=s.readFileSync(c.sslcert).toString()),c.sslkey&&(c.ssl.key=s.readFileSync(c.sslkey).toString()),c.sslrootcert&&(c.ssl.ca=s.readFileSync(c.sslrootcert).toString()),c.sslmode){case"disable":{c.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{c.ssl.rejectUnauthorized=!1;break}}return c}i(n,"Tr"),_(n,"parse"),e.exports=n,n.parse=n}),Ea=ue((r,e)=>{"use strict";X();var t=(kw(),qe(Qh)),s=Zs(),n=Fw().parse,o=_(function(v,y,x){return x===void 0?x=ce.env["PG"+v.toUpperCase()]:x===!1||(x=ce.env[x]),y[v]||x||s[v]},"val"),a=_(function(){switch(ce.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return s.ssl},"readSSLConfigFromEnvironment"),c=_(function(v){return"'"+(""+v).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),l=_(function(v,y,x){var m=y[x];m!=null&&v.push(x+"="+c(m))},"add"),d=class{static{i(this,"Br")}constructor(y){y=typeof y=="string"?n(y):y||{},y.connectionString&&(y=Object.assign({},y,n(y.connectionString))),this.user=o("user",y),this.database=o("database",y),this.database===void 0&&(this.database=this.user),this.port=parseInt(o("port",y),10),this.host=o("host",y),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:o("password",y)}),this.binary=o("binary",y),this.options=o("options",y),this.ssl=typeof y.ssl>"u"?a():y.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=o("client_encoding",y),this.replication=o("replication",y),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=o("application_name",y,"PGAPPNAME"),this.fallback_application_name=o("fallback_application_name",y,!1),this.statement_timeout=o("statement_timeout",y,!1),this.lock_timeout=o("lock_timeout",y,!1),this.idle_in_transaction_session_timeout=o("idle_in_transaction_session_timeout",y,!1),this.query_timeout=o("query_timeout",y,!1),y.connectionTimeoutMillis===void 0?this.connect_timeout=ce.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(y.connectionTimeoutMillis/1e3),y.keepAlive===!1?this.keepalives=0:y.keepAlive===!0&&(this.keepalives=1),typeof y.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(y.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(y){var x=[];l(x,this,"user"),l(x,this,"password"),l(x,this,"port"),l(x,this,"application_name"),l(x,this,"fallback_application_name"),l(x,this,"connect_timeout"),l(x,this,"options");var m=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(l(x,m,"sslmode"),l(x,m,"sslca"),l(x,m,"sslkey"),l(x,m,"sslcert"),l(x,m,"sslrootcert"),this.database&&x.push("dbname="+c(this.database)),this.replication&&x.push("replication="+c(this.replication)),this.host&&x.push("host="+c(this.host)),this.isDomainSocket)return y(null,x.join(" "));this.client_encoding&&x.push("client_encoding="+c(this.client_encoding)),t.lookup(this.host,function(h,E){return h?y(h,null):(x.push("hostaddr="+c(E)),y(null,x.join(" ")))})}};_(d,"ConnectionParameters");var f=d;e.exports=f}),qw=ue((r,e)=>{"use strict";X();var t=Xs(),s=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,n=class{static{i(this,"Lr")}constructor(c,l){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=l,this.RowCtor=null,this.rowAsArray=c==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(c){var l;c.text?l=s.exec(c.text):l=s.exec(c.command),l&&(this.command=l[1],l[3]?(this.oid=parseInt(l[2],10),this.rowCount=parseInt(l[3],10)):l[2]&&(this.rowCount=parseInt(l[2],10)))}_parseRowAsArray(c){for(var l=new Array(c.length),d=0,f=c.length;d<f;d++){var v=c[d];v!==null?l[d]=this._parsers[d](v):l[d]=null}return l}parseRow(c){for(var l={},d=0,f=c.length;d<f;d++){var v=c[d],y=this.fields[d].name;v!==null?l[y]=this._parsers[d](v):l[y]=null}return l}addRow(c){this.rows.push(c)}addFields(c){this.fields=c,this.fields.length&&(this._parsers=new Array(c.length));for(var l=0;l<c.length;l++){var d=c[l];this._types?this._parsers[l]=this._types.getTypeParser(d.dataTypeID,d.format||"text"):this._parsers[l]=t.getTypeParser(d.dataTypeID,d.format||"text")}}};_(n,"Result");var o=n;e.exports=o}),Qw=ue((r,e)=>{"use strict";X();var{EventEmitter:t}=Bt(),s=qw(),n=en(),o=class extends t{static{i(this,"kr")}constructor(l,d,f){super(),l=n.normalizeQueryConfig(l,d,f),this.text=l.text,this.values=l.values,this.rows=l.rows,this.types=l.types,this.name=l.name,this.binary=l.binary,this.portal=l.portal||"",this.callback=l.callback,this._rowMode=l.rowMode,ce.domain&&l.callback&&(this.callback=ce.domain.bind(l.callback)),this._result=new s(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new s(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(l){this._checkForMultirow(),this._result.addFields(l.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(l){let d;if(!this._canceledDueToError){try{d=this._result.parseRow(l.fields)}catch(f){this._canceledDueToError=f;return}this.emit("row",d,this._result),this._accumulateRows&&this._result.addRow(d)}}handleCommandComplete(l,d){this._checkForMultirow(),this._result.addCommandComplete(l),this.rows&&d.sync()}handleEmptyQuery(l){this.rows&&l.sync()}handleError(l,d){if(this._canceledDueToError&&(l=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(l);this.emit("error",l)}handleReadyForQuery(l){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,l);if(this.callback)try{this.callback(null,this._results)}catch(d){ce.nextTick(()=>{throw d})}this.emit("end",this._results)}submit(l){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let d=l.parsedStatements[this.name];return this.text&&d&&this.text!==d?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(l):l.query(this.text),null)}hasBeenParsed(l){return this.name&&l.parsedStatements[this.name]}handlePortalSuspended(l){this._getRows(l,this.rows)}_getRows(l,d){l.execute({portal:this.portal,rows:d}),d?l.flush():l.sync()}prepare(l){this.isPreparedStatement=!0,this.hasBeenParsed(l)||l.parse({text:this.text,name:this.name,types:this.types});try{l.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:n.prepareValue})}catch(d){this.handleError(d,l);return}l.describe({type:"P",name:this.portal||""}),this._getRows(l,this.rows)}handleCopyInResponse(l){l.sendCopyFail("No source stream defined")}handleCopyData(l,d){}};_(o,"Query");var a=o;e.exports=a}),$h=ue(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.NoticeMessage=r.DataRowMessage=r.CommandCompleteMessage=r.ReadyForQueryMessage=r.NotificationResponseMessage=r.BackendKeyDataMessage=r.AuthenticationMD5Password=r.ParameterStatusMessage=r.ParameterDescriptionMessage=r.RowDescriptionMessage=r.Field=r.CopyResponse=r.CopyDataMessage=r.DatabaseError=r.copyDone=r.emptyQuery=r.replicationStart=r.portalSuspended=r.noData=r.closeComplete=r.bindComplete=r.parseComplete=void 0,r.parseComplete={name:"parseComplete",length:5},r.bindComplete={name:"bindComplete",length:5},r.closeComplete={name:"closeComplete",length:5},r.noData={name:"noData",length:5},r.portalSuspended={name:"portalSuspended",length:5},r.replicationStart={name:"replicationStart",length:4},r.emptyQuery={name:"emptyQuery",length:4},r.copyDone={name:"copyDone",length:4};var e=class extends Error{static{i(this,"Kr")}constructor(q,K,ee){super(q),this.length=K,this.name=ee}};_(e,"DatabaseError");var t=e;r.DatabaseError=t;var s=class{static{i(this,"Yr")}constructor(q,K){this.length=q,this.chunk=K,this.name="copyData"}};_(s,"CopyDataMessage");var n=s;r.CopyDataMessage=n;var o=class{static{i(this,"Zr")}constructor(q,K,ee,oe){this.length=q,this.name=K,this.binary=ee,this.columnTypes=new Array(oe)}};_(o,"CopyResponse");var a=o;r.CopyResponse=a;var c=class{static{i(this,"Jr")}constructor(q,K,ee,oe,he,ae,Xe){this.name=q,this.tableID=K,this.columnID=ee,this.dataTypeID=oe,this.dataTypeSize=he,this.dataTypeModifier=ae,this.format=Xe}};_(c,"Field");var l=c;r.Field=l;var d=class{static{i(this,"Xr")}constructor(q,K){this.length=q,this.fieldCount=K,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};_(d,"RowDescriptionMessage");var f=d;r.RowDescriptionMessage=f;var v=class{static{i(this,"en")}constructor(q,K){this.length=q,this.parameterCount=K,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};_(v,"ParameterDescriptionMessage");var y=v;r.ParameterDescriptionMessage=y;var x=class{static{i(this,"tn")}constructor(q,K,ee){this.length=q,this.parameterName=K,this.parameterValue=ee,this.name="parameterStatus"}};_(x,"ParameterStatusMessage");var m=x;r.ParameterStatusMessage=m;var h=class{static{i(this,"rn")}constructor(q,K){this.length=q,this.salt=K,this.name="authenticationMD5Password"}};_(h,"AuthenticationMD5Password");var E=h;r.AuthenticationMD5Password=E;var C=class{static{i(this,"nn")}constructor(q,K,ee){this.length=q,this.processID=K,this.secretKey=ee,this.name="backendKeyData"}};_(C,"BackendKeyDataMessage");var P=C;r.BackendKeyDataMessage=P;var A=class{static{i(this,"sn")}constructor(q,K,ee,oe){this.length=q,this.processId=K,this.channel=ee,this.payload=oe,this.name="notification"}};_(A,"NotificationResponseMessage");var B=A;r.NotificationResponseMessage=B;var k=class{static{i(this,"on")}constructor(q,K){this.length=q,this.status=K,this.name="readyForQuery"}};_(k,"ReadyForQueryMessage");var R=k;r.ReadyForQueryMessage=R;var L=class{static{i(this,"an")}constructor(q,K){this.length=q,this.text=K,this.name="commandComplete"}};_(L,"CommandCompleteMessage");var M=L;r.CommandCompleteMessage=M;var N=class{static{i(this,"un")}constructor(q,K){this.length=q,this.fields=K,this.name="dataRow",this.fieldCount=K.length}};_(N,"DataRowMessage");var Q=N;r.DataRowMessage=Q;var F=class{static{i(this,"cn")}constructor(q,K){this.length=q,this.message=K,this.name="notice"}};_(F,"NoticeMessage");var G=F;r.NoticeMessage=G}),Uw=ue(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.Writer=void 0;var e=class{static{i(this,"hn")}constructor(n=256){this.size=n,this.offset=5,this.headerPosition=0,this.buffer=re.allocUnsafe(n)}ensure(n){if(this.buffer.length-this.offset<n){let o=this.buffer,a=o.length+(o.length>>1)+n;this.buffer=re.allocUnsafe(a),o.copy(this.buffer)}}addInt32(n){return this.ensure(4),this.buffer[this.offset++]=n>>>24&255,this.buffer[this.offset++]=n>>>16&255,this.buffer[this.offset++]=n>>>8&255,this.buffer[this.offset++]=n>>>0&255,this}addInt16(n){return this.ensure(2),this.buffer[this.offset++]=n>>>8&255,this.buffer[this.offset++]=n>>>0&255,this}addCString(n){if(!n)this.ensure(1);else{let o=re.byteLength(n);this.ensure(o+1),this.buffer.write(n,this.offset,"utf-8"),this.offset+=o}return this.buffer[this.offset++]=0,this}addString(n=""){let o=re.byteLength(n);return this.ensure(o),this.buffer.write(n,this.offset),this.offset+=o,this}add(n){return this.ensure(n.length),n.copy(this.buffer,this.offset),this.offset+=n.length,this}join(n){if(n){this.buffer[this.headerPosition]=n;let o=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(o,this.headerPosition+1)}return this.buffer.slice(n?0:5,this.offset)}flush(n){let o=this.join(n);return this.offset=5,this.headerPosition=0,this.buffer=re.allocUnsafe(this.size),o}};_(e,"Writer");var t=e;r.Writer=t}),$w=ue(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.serialize=void 0;var e=Uw(),t=new e.Writer,s=_(q=>{t.addInt16(3).addInt16(0);for(let oe of Object.keys(q))t.addCString(oe).addCString(q[oe]);t.addCString("client_encoding").addCString("UTF8");let K=t.addCString("").flush(),ee=K.length+4;return new e.Writer().addInt32(ee).add(K).flush()},"startup"),n=_(()=>{let q=re.allocUnsafe(8);return q.writeInt32BE(8,0),q.writeInt32BE(80877103,4),q},"requestSsl"),o=_(q=>t.addCString(q).flush(112),"password"),a=_(function(q,K){return t.addCString(q).addInt32(re.byteLength(K)).addString(K),t.flush(112)},"sendSASLInitialResponseMessage"),c=_(function(q){return t.addString(q).flush(112)},"sendSCRAMClientFinalMessage"),l=_(q=>t.addCString(q).flush(81),"query"),d=[],f=_(q=>{let K=q.name||"";K.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",K,K.length),console.error("This can cause conflicts and silent errors executing queries"));let ee=q.types||d,oe=ee.length,he=t.addCString(K).addCString(q.text).addInt16(oe);for(let ae=0;ae<oe;ae++)he.addInt32(ee[ae]);return t.flush(80)},"parse"),v=new e.Writer,y=_(function(q,K){for(let ee=0;ee<q.length;ee++){let oe=K?K(q[ee],ee):q[ee];oe==null?(t.addInt16(0),v.addInt32(-1)):oe instanceof re?(t.addInt16(1),v.addInt32(oe.length),v.add(oe)):(t.addInt16(0),v.addInt32(re.byteLength(oe)),v.addString(oe))}},"writeValues"),x=_((q={})=>{let K=q.portal||"",ee=q.statement||"",oe=q.binary||!1,he=q.values||d,ae=he.length;return t.addCString(K).addCString(ee),t.addInt16(ae),y(he,q.valueMapper),t.addInt16(ae),t.add(v.flush()),t.addInt16(oe?1:0),t.flush(66)},"bind"),m=re.from([69,0,0,0,9,0,0,0,0,0]),h=_(q=>{if(!q||!q.portal&&!q.rows)return m;let K=q.portal||"",ee=q.rows||0,oe=re.byteLength(K),he=4+oe+1+4,ae=re.allocUnsafe(1+he);return ae[0]=69,ae.writeInt32BE(he,1),ae.write(K,5,"utf-8"),ae[oe+5]=0,ae.writeUInt32BE(ee,ae.length-4),ae},"execute"),E=_((q,K)=>{let ee=re.allocUnsafe(16);return ee.writeInt32BE(16,0),ee.writeInt16BE(1234,4),ee.writeInt16BE(5678,6),ee.writeInt32BE(q,8),ee.writeInt32BE(K,12),ee},"cancel"),C=_((q,K)=>{let ee=4+re.byteLength(K)+1,oe=re.allocUnsafe(1+ee);return oe[0]=q,oe.writeInt32BE(ee,1),oe.write(K,5,"utf-8"),oe[ee]=0,oe},"cstringMessage"),P=t.addCString("P").flush(68),A=t.addCString("S").flush(68),B=_(q=>q.name?C(68,`${q.type}${q.name||""}`):q.type==="P"?P:A,"describe"),k=_(q=>{let K=`${q.type}${q.name||""}`;return C(67,K)},"close"),R=_(q=>t.add(q).flush(100),"copyData"),L=_(q=>C(102,q),"copyFail"),M=_(q=>re.from([q,0,0,0,4]),"codeOnlyBuffer"),N=M(72),Q=M(83),F=M(88),G=M(99),Y={startup:s,password:o,requestSsl:n,sendSASLInitialResponseMessage:a,sendSCRAMClientFinalMessage:c,query:l,parse:f,bind:x,execute:h,describe:B,close:k,flush:_(()=>N,"flush"),sync:_(()=>Q,"sync"),end:_(()=>F,"end"),copyData:R,copyDone:_(()=>G,"copyDone"),copyFail:L,cancel:E};r.serialize=Y}),jw=ue(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.BufferReader=void 0;var e=re.allocUnsafe(0),t=class{static{i(this,"mn")}constructor(o=0){this.offset=o,this.buffer=e,this.encoding="utf-8"}setBuffer(o,a){this.offset=o,this.buffer=a}int16(){let o=this.buffer.readInt16BE(this.offset);return this.offset+=2,o}byte(){let o=this.buffer[this.offset];return this.offset++,o}int32(){let o=this.buffer.readInt32BE(this.offset);return this.offset+=4,o}uint32(){let o=this.buffer.readUInt32BE(this.offset);return this.offset+=4,o}string(o){let a=this.buffer.toString(this.encoding,this.offset,this.offset+o);return this.offset+=o,a}cstring(){let o=this.offset,a=o;for(;this.buffer[a++]!==0;);return this.offset=a,this.buffer.toString(this.encoding,o,a-1)}bytes(o){let a=this.buffer.slice(this.offset,this.offset+o);return this.offset+=o,a}};_(t,"BufferReader");var s=t;r.BufferReader=s}),Hw=ue(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var e=$h(),t=jw(),s=1,n=4,o=s+n,a=re.allocUnsafe(0),c=class{static{i(this,"bn")}constructor(f){if(this.buffer=a,this.bufferLength=0,this.bufferOffset=0,this.reader=new t.BufferReader,f?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=f?.mode||"text"}parse(f,v){this.mergeBuffer(f);let y=this.bufferOffset+this.bufferLength,x=this.bufferOffset;for(;x+o<=y;){let m=this.buffer[x],h=this.buffer.readUInt32BE(x+s),E=s+h;if(E+x<=y){let C=this.handlePacket(x+o,m,h,this.buffer);v(C),x+=E}else break}x===y?(this.buffer=a,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=y-x,this.bufferOffset=x)}mergeBuffer(f){if(this.bufferLength>0){let v=this.bufferLength+f.byteLength;if(v+this.bufferOffset>this.buffer.byteLength){let y;if(v<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)y=this.buffer;else{let x=this.buffer.byteLength*2;for(;v>=x;)x*=2;y=re.allocUnsafe(x)}this.buffer.copy(y,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=y,this.bufferOffset=0}f.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=v}else this.buffer=f,this.bufferOffset=0,this.bufferLength=f.byteLength}handlePacket(f,v,y,x){switch(v){case 50:return e.bindComplete;case 49:return e.parseComplete;case 51:return e.closeComplete;case 110:return e.noData;case 115:return e.portalSuspended;case 99:return e.copyDone;case 87:return e.replicationStart;case 73:return e.emptyQuery;case 68:return this.parseDataRowMessage(f,y,x);case 67:return this.parseCommandCompleteMessage(f,y,x);case 90:return this.parseReadyForQueryMessage(f,y,x);case 65:return this.parseNotificationMessage(f,y,x);case 82:return this.parseAuthenticationResponse(f,y,x);case 83:return this.parseParameterStatusMessage(f,y,x);case 75:return this.parseBackendKeyData(f,y,x);case 69:return this.parseErrorMessage(f,y,x,"error");case 78:return this.parseErrorMessage(f,y,x,"notice");case 84:return this.parseRowDescriptionMessage(f,y,x);case 116:return this.parseParameterDescriptionMessage(f,y,x);case 71:return this.parseCopyInMessage(f,y,x);case 72:return this.parseCopyOutMessage(f,y,x);case 100:return this.parseCopyData(f,y,x);default:return new e.DatabaseError("received invalid response: "+v.toString(16),y,"error")}}parseReadyForQueryMessage(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.string(1);return new e.ReadyForQueryMessage(v,x)}parseCommandCompleteMessage(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.cstring();return new e.CommandCompleteMessage(v,x)}parseCopyData(f,v,y){let x=y.slice(f,f+(v-4));return new e.CopyDataMessage(v,x)}parseCopyInMessage(f,v,y){return this.parseCopyMessage(f,v,y,"copyInResponse")}parseCopyOutMessage(f,v,y){return this.parseCopyMessage(f,v,y,"copyOutResponse")}parseCopyMessage(f,v,y,x){this.reader.setBuffer(f,y);let m=this.reader.byte()!==0,h=this.reader.int16(),E=new e.CopyResponse(v,x,m,h);for(let C=0;C<h;C++)E.columnTypes[C]=this.reader.int16();return E}parseNotificationMessage(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.int32(),m=this.reader.cstring(),h=this.reader.cstring();return new e.NotificationResponseMessage(v,x,m,h)}parseRowDescriptionMessage(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.int16(),m=new e.RowDescriptionMessage(v,x);for(let h=0;h<x;h++)m.fields[h]=this.parseField();return m}parseField(){let f=this.reader.cstring(),v=this.reader.uint32(),y=this.reader.int16(),x=this.reader.uint32(),m=this.reader.int16(),h=this.reader.int32(),E=this.reader.int16()===0?"text":"binary";return new e.Field(f,v,y,x,m,h,E)}parseParameterDescriptionMessage(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.int16(),m=new e.ParameterDescriptionMessage(v,x);for(let h=0;h<x;h++)m.dataTypeIDs[h]=this.reader.int32();return m}parseDataRowMessage(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.int16(),m=new Array(x);for(let h=0;h<x;h++){let E=this.reader.int32();m[h]=E===-1?null:this.reader.string(E)}return new e.DataRowMessage(v,m)}parseParameterStatusMessage(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.cstring(),m=this.reader.cstring();return new e.ParameterStatusMessage(v,x,m)}parseBackendKeyData(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.int32(),m=this.reader.int32();return new e.BackendKeyDataMessage(v,x,m)}parseAuthenticationResponse(f,v,y){this.reader.setBuffer(f,y);let x=this.reader.int32(),m={name:"authenticationOk",length:v};switch(x){case 0:break;case 3:m.length===8&&(m.name="authenticationCleartextPassword");break;case 5:if(m.length===12){m.name="authenticationMD5Password";let h=this.reader.bytes(4);return new e.AuthenticationMD5Password(v,h)}break;case 10:{m.name="authenticationSASL",m.mechanisms=[];let h;do h=this.reader.cstring(),h&&m.mechanisms.push(h);while(h)}break;case 11:m.name="authenticationSASLContinue",m.data=this.reader.string(v-8);break;case 12:m.name="authenticationSASLFinal",m.data=this.reader.string(v-8);break;default:throw new Error("Unknown authenticationOk message type "+x)}return m}parseErrorMessage(f,v,y,x){this.reader.setBuffer(f,y);let m={},h=this.reader.string(1);for(;h!=="\0";)m[h]=this.reader.cstring(),h=this.reader.string(1);let E=m.M,C=x==="notice"?new e.NoticeMessage(v,E):new e.DatabaseError(E,v,x);return C.severity=m.S,C.code=m.C,C.detail=m.D,C.hint=m.H,C.position=m.P,C.internalPosition=m.p,C.internalQuery=m.q,C.where=m.W,C.schema=m.s,C.table=m.t,C.column=m.c,C.dataType=m.d,C.constraint=m.n,C.file=m.F,C.line=m.L,C.routine=m.R,C}};_(c,"Parser");var l=c;r.Parser=l}),jh=ue(r=>{"use strict";X(),Object.defineProperty(r,"__esModule",{value:!0}),r.DatabaseError=r.serialize=r.parse=void 0;var e=$h();Object.defineProperty(r,"DatabaseError",{enumerable:!0,get:_(function(){return e.DatabaseError},"get")});var t=$w();Object.defineProperty(r,"serialize",{enumerable:!0,get:_(function(){return t.serialize},"get")});var s=Hw();function n(o,a){let c=new s.Parser;return o.on("data",l=>c.parse(l,a)),new Promise(l=>o.on("end",()=>l()))}i(n,"Hc"),_(n,"parse"),r.parse=n}),Hh={};ut(Hh,{connect:i(()=>Vh,"connect")});function Vh({socket:r,servername:e}){return r.startTls(e),r}i(Vh,"$c");var Vw=We(()=>{"use strict";X(),_(Vh,"connect")}),Kh=ue((r,e)=>{"use strict";X();var t=(Yr(),qe(Sh)),s=Bt().EventEmitter,{parse:n,serialize:o}=jh(),a=o.flush(),c=o.sync(),l=o.end(),d=class extends s{static{i(this,"Sn")}constructor(y){super(),y=y||{},this.stream=y.stream||new t.Socket,this._keepAlive=y.keepAlive,this._keepAliveInitialDelayMillis=y.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=y.ssl||!1,this._ending=!1,this._emitMessage=!1;var x=this;this.on("newListener",function(m){m==="message"&&(x._emitMessage=!0)})}connect(y,x){var m=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(y,x),this.stream.once("connect",function(){m._keepAlive&&m.stream.setKeepAlive(!0,m._keepAliveInitialDelayMillis),m.emit("connect")});let h=_(function(E){m._ending&&(E.code==="ECONNRESET"||E.code==="EPIPE")||m.emit("error",E)},"reportStreamError");if(this.stream.on("error",h),this.stream.on("close",function(){m.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(E){var C=E.toString("utf8");switch(C){case"S":break;case"N":return m.stream.end(),m.emit("error",new Error("The server does not support SSL connections"));default:return m.stream.end(),m.emit("error",new Error("There was an error establishing an SSL connection"))}var P=(Vw(),qe(Hh));let A={socket:m.stream};m.ssl!==!0&&(Object.assign(A,m.ssl),"key"in m.ssl&&(A.key=m.ssl.key)),t.isIP(x)===0&&(A.servername=x);try{m.stream=P.connect(A)}catch(B){return m.emit("error",B)}m.attachListeners(m.stream),m.stream.on("error",h),m.emit("sslconnect")})}attachListeners(y){y.on("end",()=>{this.emit("end")}),n(y,x=>{var m=x.name==="error"?"errorMessage":x.name;this._emitMessage&&this.emit("message",x),this.emit(m,x)})}requestSsl(){this.stream.write(o.requestSsl())}startup(y){this.stream.write(o.startup(y))}cancel(y,x){this._send(o.cancel(y,x))}password(y){this._send(o.password(y))}sendSASLInitialResponseMessage(y,x){this._send(o.sendSASLInitialResponseMessage(y,x))}sendSCRAMClientFinalMessage(y){this._send(o.sendSCRAMClientFinalMessage(y))}_send(y){return this.stream.writable?this.stream.write(y):!1}query(y){this._send(o.query(y))}parse(y){this._send(o.parse(y))}bind(y){this._send(o.bind(y))}execute(y){this._send(o.execute(y))}flush(){this.stream.writable&&this.stream.write(a)}sync(){this._ending=!0,this._send(a),this._send(c)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(l,()=>{this.stream.end()})}close(y){this._send(o.close(y))}describe(y){this._send(o.describe(y))}sendCopyFromChunk(y){this._send(o.copyData(y))}endCopyFrom(){this._send(o.copyDone())}sendCopyFail(y){this._send(o.copyFail(y))}};_(d,"Connection");var f=d;e.exports=f}),Kw=ue((r,e)=>{"use strict";X();var t=Bt().EventEmitter,s=(tn(),qe(Jr)),n=en(),o=Iw(),a=Bw(),c=ba(),l=Ea(),d=Qw(),f=Zs(),v=Kh(),y=class extends t{static{i(this,"Cn")}constructor(h){super(),this.connectionParameters=new l(h),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var E=h||{};this._Promise=E.Promise||Js.Promise,this._types=new c(E.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=E.connection||new v({stream:E.stream,ssl:this.connectionParameters.ssl,keepAlive:E.keepAlive||!1,keepAliveInitialDelayMillis:E.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=E.binary||f.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=E.connectionTimeoutMillis||0}_errorAllQueries(h){let E=_(C=>{ce.nextTick(()=>{C.handleError(h,this.connection)})},"enqueueError");this.activeQuery&&(E(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(E),this.queryQueue.length=0}_connect(h){var E=this,C=this.connection;if(this._connectionCallback=h,this._connecting||this._connected){let P=new Error("Client has already been connected. You cannot reuse a client.");ce.nextTick(()=>{h(P)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{C._ending=!0,C.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?C.connect(this.host+"/.s.PGSQL."+this.port):C.connect(this.port,this.host),C.on("connect",function(){E.ssl?C.requestSsl():C.startup(E.getStartupConf())}),C.on("sslconnect",function(){C.startup(E.getStartupConf())}),this._attachListeners(C),C.once("end",()=>{let P=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(P),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(P):this._handleErrorEvent(P):this._connectionError||this._handleErrorEvent(P)),ce.nextTick(()=>{this.emit("end")})})}connect(h){if(h){this._connect(h);return}return new this._Promise((E,C)=>{this._connect(P=>{P?C(P):E()})})}_attachListeners(h){h.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),h.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),h.on("authenticationSASL",this._handleAuthSASL.bind(this)),h.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),h.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),h.on("backendKeyData",this._handleBackendKeyData.bind(this)),h.on("error",this._handleErrorEvent.bind(this)),h.on("errorMessage",this._handleErrorMessage.bind(this)),h.on("readyForQuery",this._handleReadyForQuery.bind(this)),h.on("notice",this._handleNotice.bind(this)),h.on("rowDescription",this._handleRowDescription.bind(this)),h.on("dataRow",this._handleDataRow.bind(this)),h.on("portalSuspended",this._handlePortalSuspended.bind(this)),h.on("emptyQuery",this._handleEmptyQuery.bind(this)),h.on("commandComplete",this._handleCommandComplete.bind(this)),h.on("parseComplete",this._handleParseComplete.bind(this)),h.on("copyInResponse",this._handleCopyInResponse.bind(this)),h.on("copyData",this._handleCopyData.bind(this)),h.on("notification",this._handleNotification.bind(this))}_checkPgPass(h){let E=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(C=>{if(C!==void 0){if(typeof C!="string"){E.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=C}else this.connectionParameters.password=this.password=null;h()}).catch(C=>{E.emit("error",C)}):this.password!==null?h():a(this.connectionParameters,C=>{C!==void 0&&(this.connectionParameters.password=this.password=C),h()})}_handleAuthCleartextPassword(h){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(h){this._checkPgPass(()=>{let E=n.postgresMd5PasswordHash(this.user,this.password,h.salt);this.connection.password(E)})}_handleAuthSASL(h){this._checkPgPass(()=>{this.saslSession=o.startSession(h.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(h){o.continueSession(this.saslSession,this.password,h.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(h){o.finalizeSession(this.saslSession,h.data),this.saslSession=null}_handleBackendKeyData(h){this.processID=h.processID,this.secretKey=h.secretKey}_handleReadyForQuery(h){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:E}=this;this.activeQuery=null,this.readyForQuery=!0,E&&E.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(h){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(h);this.emit("error",h)}}_handleErrorEvent(h){if(this._connecting)return this._handleErrorWhileConnecting(h);this._queryable=!1,this._errorAllQueries(h),this.emit("error",h)}_handleErrorMessage(h){if(this._connecting)return this._handleErrorWhileConnecting(h);let E=this.activeQuery;if(!E){this._handleErrorEvent(h);return}this.activeQuery=null,E.handleError(h,this.connection)}_handleRowDescription(h){this.activeQuery.handleRowDescription(h)}_handleDataRow(h){this.activeQuery.handleDataRow(h)}_handlePortalSuspended(h){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(h){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(h){this.activeQuery.handleCommandComplete(h,this.connection)}_handleParseComplete(h){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(h){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(h){this.activeQuery.handleCopyData(h,this.connection)}_handleNotification(h){this.emit("notification",h)}_handleNotice(h){this.emit("notice",h)}getStartupConf(){var h=this.connectionParameters,E={user:h.user,database:h.database},C=h.application_name||h.fallback_application_name;return C&&(E.application_name=C),h.replication&&(E.replication=""+h.replication),h.statement_timeout&&(E.statement_timeout=String(parseInt(h.statement_timeout,10))),h.lock_timeout&&(E.lock_timeout=String(parseInt(h.lock_timeout,10))),h.idle_in_transaction_session_timeout&&(E.idle_in_transaction_session_timeout=String(parseInt(h.idle_in_transaction_session_timeout,10))),h.options&&(E.options=h.options),E}cancel(h,E){if(h.activeQuery===E){var C=this.connection;this.host&&this.host.indexOf("/")===0?C.connect(this.host+"/.s.PGSQL."+this.port):C.connect(this.port,this.host),C.on("connect",function(){C.cancel(h.processID,h.secretKey)})}else h.queryQueue.indexOf(E)!==-1&&h.queryQueue.splice(h.queryQueue.indexOf(E),1)}setTypeParser(h,E,C){return this._types.setTypeParser(h,E,C)}getTypeParser(h,E){return this._types.getTypeParser(h,E)}escapeIdentifier(h){return'"'+h.replace(/"/g,'""')+'"'}escapeLiteral(h){for(var E=!1,C="'",P=0;P<h.length;P++){var A=h[P];A==="'"?C+=A+A:A==="\\"?(C+=A+A,E=!0):C+=A}return C+="'",E===!0&&(C=" E"+C),C}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let h=this.activeQuery.submit(this.connection);h&&ce.nextTick(()=>{this.activeQuery.handleError(h,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(h,E,C){var P,A,B,k,R;if(h==null)throw new TypeError("Client was passed a null or undefined query");return typeof h.submit=="function"?(B=h.query_timeout||this.connectionParameters.query_timeout,A=P=h,typeof E=="function"&&(P.callback=P.callback||E)):(B=this.connectionParameters.query_timeout,P=new d(h,E,C),P.callback||(A=new this._Promise((L,M)=>{P.callback=(N,Q)=>N?M(N):L(Q)}))),B&&(R=P.callback,k=setTimeout(()=>{var L=new Error("Query read timeout");ce.nextTick(()=>{P.handleError(L,this.connection)}),R(L),P.callback=()=>{};var M=this.queryQueue.indexOf(P);M>-1&&this.queryQueue.splice(M,1),this._pulseQueryQueue()},B),P.callback=(L,M)=>{clearTimeout(k),R(L,M)}),this.binary&&!P.binary&&(P.binary=!0),P._result&&!P._result._types&&(P._result._types=this._types),this._queryable?this._ending?(ce.nextTick(()=>{P.handleError(new Error("Client was closed and is not queryable"),this.connection)}),A):(this.queryQueue.push(P),this._pulseQueryQueue(),A):(ce.nextTick(()=>{P.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),A)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(h){if(this._ending=!0,!this.connection._connecting)if(h)h();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),h)this.connection.once("end",h);else return new this._Promise(E=>{this.connection.once("end",E)})}};_(y,"Client");var x=y;x.Query=d,e.exports=x}),zw=ue((r,e)=>{"use strict";X();var t=Bt().EventEmitter,s=_(function(){},"NOOP"),n=_((m,h)=>{let E=m.findIndex(h);return E===-1?void 0:m.splice(E,1)[0]},"removeWhere"),o=class{static{i(this,"Tn")}constructor(h,E,C){this.client=h,this.idleListener=E,this.timeoutId=C}};_(o,"IdleItem");var a=o,c=class{static{i(this,"Pn")}constructor(h){this.callback=h}};_(c,"PendingItem");var l=c;function d(){throw new Error("Release called on client which has already been released to the pool.")}i(d,"il"),_(d,"throwOnDoubleRelease");function f(m,h){if(h)return{callback:h,result:void 0};let E,C,P=_(function(B,k){B?E(B):C(k)},"cb"),A=new m(function(B,k){C=B,E=k}).catch(B=>{throw Error.captureStackTrace(B),B});return{callback:P,result:A}}i(f,"Dt"),_(f,"promisify");function v(m,h){return _(i(function E(C){C.client=h,h.removeListener("error",E),h.on("error",()=>{m.log("additional client error after disconnection due to error",C)}),m._remove(h),m.emit("error",C,h)},"t"),"idleListener")}i(v,"sl"),_(v,"makeIdleListener");var y=class extends t{static{i(this,"Bn")}constructor(h,E){super(),this.options=Object.assign({},h),h!=null&&"password"in h&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:h.password}),h!=null&&h.ssl&&h.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||E||rn().Client,this.Promise=this.options.Promise||Js.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(E=>{this._remove(E.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let h=this._pendingQueue.shift();if(this._idle.length){let E=this._idle.pop();clearTimeout(E.timeoutId);let C=E.client;C.ref&&C.ref();let P=E.idleListener;return this._acquireClient(C,h,P,!1)}if(!this._isFull())return this.newClient(h);throw new Error("unexpected condition")}_remove(h){let E=n(this._idle,C=>C.client===h);E!==void 0&&clearTimeout(E.timeoutId),this._clients=this._clients.filter(C=>C!==h),h.end(),this.emit("remove",h)}connect(h){if(this.ending){let P=new Error("Cannot use a pool after calling end on the pool");return h?h(P):this.Promise.reject(P)}let E=f(this.Promise,h),C=E.result;if(this._isFull()||this._idle.length){if(this._idle.length&&ce.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new l(E.callback)),C;let P=_((k,R,L)=>{clearTimeout(B),E.callback(k,R,L)},"queueCallback"),A=new l(P),B=setTimeout(()=>{n(this._pendingQueue,k=>k.callback===P),A.timedOut=!0,E.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return B.unref&&B.unref(),this._pendingQueue.push(A),C}return this.newClient(new l(E.callback)),C}newClient(h){let E=new this.Client(this.options);this._clients.push(E);let C=v(this,E);this.log("checking client timeout");let P,A=!1;this.options.connectionTimeoutMillis&&(P=setTimeout(()=>{this.log("ending client due to timeout"),A=!0,E.connection?E.connection.stream.destroy():E.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),E.connect(B=>{if(P&&clearTimeout(P),E.on("error",C),B)this.log("client failed to connect",B),this._clients=this._clients.filter(k=>k!==E),A&&(B=new Error("Connection terminated due to connection timeout",{cause:B})),this._pulseQueue(),h.timedOut||h.callback(B,void 0,s);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let k=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(E),this._idle.findIndex(R=>R.client===E)!==-1&&this._acquireClient(E,new l((R,L,M)=>M()),C,!1)},this.options.maxLifetimeSeconds*1e3);k.unref(),E.once("end",()=>clearTimeout(k))}return this._acquireClient(E,h,C,!0)}})}_acquireClient(h,E,C,P){P&&this.emit("connect",h),this.emit("acquire",h),h.release=this._releaseOnce(h,C),h.removeListener("error",C),E.timedOut?P&&this.options.verify?this.options.verify(h,h.release):h.release():P&&this.options.verify?this.options.verify(h,A=>{if(A)return h.release(A),E.callback(A,void 0,s);E.callback(void 0,h,h.release)}):E.callback(void 0,h,h.release)}_releaseOnce(h,E){let C=!1;return P=>{C&&d(),C=!0,this._release(h,E,P)}}_release(h,E,C){if(h.on("error",E),h._poolUseCount=(h._poolUseCount||0)+1,this.emit("release",C,h),C||this.ending||!h._queryable||h._ending||h._poolUseCount>=this.options.maxUses){h._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(h),this._pulseQueue();return}if(this._expired.has(h)){this.log("remove expired client"),this._expired.delete(h),this._remove(h),this._pulseQueue();return}let P;this.options.idleTimeoutMillis&&this._isAboveMin()&&(P=setTimeout(()=>{this.log("remove idle client"),this._remove(h)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&P.unref()),this.options.allowExitOnIdle&&h.unref(),this._idle.push(new a(h,E,P)),this._pulseQueue()}query(h,E,C){if(typeof h=="function"){let A=f(this.Promise,h);return ya(function(){return A.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),A.result}typeof E=="function"&&(C=E,E=void 0);let P=f(this.Promise,C);return C=P.callback,this.connect((A,B)=>{if(A)return C(A);let k=!1,R=_(L=>{k||(k=!0,B.release(L),C(L))},"onError");B.once("error",R),this.log("dispatching query");try{B.query(h,E,(L,M)=>{if(this.log("query dispatched"),B.removeListener("error",R),!k)return k=!0,B.release(L),L?C(L):C(void 0,M)})}catch(L){return B.release(L),C(L)}}),P.result}end(h){if(this.log("ending"),this.ending){let C=new Error("Called end on pool more than once");return h?h(C):this.Promise.reject(C)}this.ending=!0;let E=f(this.Promise,h);return this._endCallback=E.callback,this._pulseQueue(),E.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((h,E)=>h+(this._expired.has(E)?1:0),0)}get totalCount(){return this._clients.length}};_(y,"Pool");var x=y;e.exports=x}),zh={};ut(zh,{default:i(()=>Wh,"default")});var Wh,Ww=We(()=>{"use strict";X(),Wh={}}),Gw=ue((r,e)=>{e.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),Yw=ue((r,e)=>{"use strict";X();var t=Bt().EventEmitter,s=(tn(),qe(Jr)),n=en(),o=e.exports=function(c,l,d){t.call(this),c=n.normalizeQueryConfig(c,l,d),this.text=c.text,this.values=c.values,this.name=c.name,this.callback=c.callback,this.state="new",this._arrayMode=c.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(f){f==="row"&&(this._emitRowEvents=!0)}.bind(this))};s.inherits(o,t);var a={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};o.prototype.handleError=function(c){var l=this.native.pq.resultErrorFields();if(l)for(var d in l){var f=a[d]||d;c[f]=l[d]}this.callback?this.callback(c):this.emit("error",c),this.state="error"},o.prototype.then=function(c,l){return this._getPromise().then(c,l)},o.prototype.catch=function(c){return this._getPromise().catch(c)},o.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(c,l){this._once("end",c),this._once("error",l)}.bind(this)),this._promise)},o.prototype.submit=function(c){this.state="running";var l=this;this.native=c.native,c.native.arrayMode=this._arrayMode;var d=_(function(y,x,m){if(c.native.arrayMode=!1,ya(function(){l.emit("_done")}),y)return l.handleError(y);l._emitRowEvents&&(m.length>1?x.forEach((h,E)=>{h.forEach(C=>{l.emit("row",C,m[E])})}):x.forEach(function(h){l.emit("row",h,m)})),l.state="end",l.emit("end",m),l.callback&&l.callback(null,m)},"after");if(ce.domain&&(d=ce.domain.bind(d)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var f=(this.values||[]).map(n.prepareValue);if(c.namedQueries[this.name]){if(this.text&&c.namedQueries[this.name]!==this.text){let y=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return d(y)}return c.native.execute(this.name,f,d)}return c.native.prepare(this.name,this.text,f.length,function(y){return y?d(y):(c.namedQueries[l.name]=l.text,l.native.execute(l.name,f,d))})}else if(this.values){if(!Array.isArray(this.values)){let y=new Error("Query values must be an array");return d(y)}var v=this.values.map(n.prepareValue);c.native.query(this.text,v,d)}else c.native.query(this.text,d)}}),Jw=ue((r,e)=>{"use strict";X();var t=(Ww(),qe(zh)),s=ba(),n=Gw(),o=Bt().EventEmitter,a=(tn(),qe(Jr)),c=Ea(),l=Yw(),d=e.exports=function(f){o.call(this),f=f||{},this._Promise=f.Promise||Js.Promise,this._types=new s(f.types),this.native=new t({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var v=this.connectionParameters=new c(f);this.user=v.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:v.password}),this.database=v.database,this.host=v.host,this.port=v.port,this.namedQueries={}};d.Query=l,a.inherits(d,o),d.prototype._errorAllQueries=function(f){let v=_(y=>{ce.nextTick(()=>{y.native=this.native,y.handleError(f)})},"enqueueError");this._hasActiveQuery()&&(v(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(v),this._queryQueue.length=0},d.prototype._connect=function(f){var v=this;if(this._connecting){ce.nextTick(()=>f(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(y,x){if(y)return f(y);v.native.connect(x,function(m){if(m)return v.native.end(),f(m);v._connected=!0,v.native.on("error",function(h){v._queryable=!1,v._errorAllQueries(h),v.emit("error",h)}),v.native.on("notification",function(h){v.emit("notification",{channel:h.relname,payload:h.extra})}),v.emit("connect"),v._pulseQueryQueue(!0),f()})})},d.prototype.connect=function(f){if(f){this._connect(f);return}return new this._Promise((v,y)=>{this._connect(x=>{x?y(x):v()})})},d.prototype.query=function(f,v,y){var x,m,h,E,C;if(f==null)throw new TypeError("Client was passed a null or undefined query");if(typeof f.submit=="function")h=f.query_timeout||this.connectionParameters.query_timeout,m=x=f,typeof v=="function"&&(f.callback=v);else if(h=this.connectionParameters.query_timeout,x=new l(f,v,y),!x.callback){let P,A;m=new this._Promise((B,k)=>{P=B,A=k}),x.callback=(B,k)=>B?A(B):P(k)}return h&&(C=x.callback,E=setTimeout(()=>{var P=new Error("Query read timeout");ce.nextTick(()=>{x.handleError(P,this.connection)}),C(P),x.callback=()=>{};var A=this._queryQueue.indexOf(x);A>-1&&this._queryQueue.splice(A,1),this._pulseQueryQueue()},h),x.callback=(P,A)=>{clearTimeout(E),C(P,A)}),this._queryable?this._ending?(x.native=this.native,ce.nextTick(()=>{x.handleError(new Error("Client was closed and is not queryable"))}),m):(this._queryQueue.push(x),this._pulseQueryQueue(),m):(x.native=this.native,ce.nextTick(()=>{x.handleError(new Error("Client has encountered a connection error and is not queryable"))}),m)},d.prototype.end=function(f){var v=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,f));var y;return f||(y=new this._Promise(function(x,m){f=_(h=>h?m(h):x(),"cb")})),this.native.end(function(){v._errorAllQueries(new Error("Connection terminated")),ce.nextTick(()=>{v.emit("end"),f&&f()})}),y},d.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},d.prototype._pulseQueryQueue=function(f){if(this._connected&&!this._hasActiveQuery()){var v=this._queryQueue.shift();if(!v){f||this.emit("drain");return}this._activeQuery=v,v.submit(this);var y=this;v.once("_done",function(){y._pulseQueryQueue()})}},d.prototype.cancel=function(f){this._activeQuery===f?this.native.cancel(function(){}):this._queryQueue.indexOf(f)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(f),1)},d.prototype.ref=function(){},d.prototype.unref=function(){},d.prototype.setTypeParser=function(f,v,y){return this._types.setTypeParser(f,v,y)},d.prototype.getTypeParser=function(f,v){return this._types.getTypeParser(f,v)}}),dh=ue((r,e)=>{"use strict";X(),e.exports=Jw()}),rn=ue((r,e)=>{"use strict";X();var t=Kw(),s=Zs(),n=Kh(),o=zw(),{DatabaseError:a}=jh(),c=_(d=>{var f;return f=class extends o{static{i(this,"e")}constructor(v){super(v,d)}},_(f,"BoundPool"),f},"poolFactory"),l=_(function(d){this.defaults=s,this.Client=d,this.Query=this.Client.Query,this.Pool=c(this.Client),this._pools=[],this.Connection=n,this.types=Xs(),this.DatabaseError=a},"PG");typeof ce.env.NODE_PG_FORCE_NATIVE<"u"?e.exports=new l(dh()):(e.exports=new l(t),Object.defineProperty(e.exports,"native",{configurable:!0,enumerable:!1,get(){var d=null;try{d=new l(dh())}catch(f){if(f.code!=="MODULE_NOT_FOUND")throw f}return Object.defineProperty(e.exports,"native",{value:d}),d}}))});X();X();Yr();Eh();X();var Xw=Object.defineProperty,Zw=Object.defineProperties,eS=Object.getOwnPropertyDescriptors,mh=Object.getOwnPropertySymbols,tS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,yh=_((r,e,t)=>e in r?Xw(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,"__defNormalProp"),sS=_((r,e)=>{for(var t in e||(e={}))tS.call(e,t)&&yh(r,t,e[t]);if(mh)for(var t of mh(e))rS.call(e,t)&&yh(r,t,e[t]);return r},"__spreadValues"),nS=_((r,e)=>Zw(r,eS(e)),"__spreadProps"),iS=1008e3,gh=new Uint8Array(new Uint16Array([258]).buffer)[0]===2,oS=new TextDecoder,xa=new TextEncoder,zs=xa.encode("0123456789abcdef"),Ws=xa.encode("0123456789ABCDEF"),aS=xa.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Gh=aS.slice();Gh[62]=45;Gh[63]=95;var zr,Gs;function Yh(r,{alphabet:e,scratchArr:t}={}){if(!zr)if(zr=new Uint16Array(256),Gs=new Uint16Array(256),gh)for(let x=0;x<256;x++)zr[x]=zs[x&15]<<8|zs[x>>>4],Gs[x]=Ws[x&15]<<8|Ws[x>>>4];else for(let x=0;x<256;x++)zr[x]=zs[x&15]|zs[x>>>4]<<8,Gs[x]=Ws[x&15]|Ws[x>>>4]<<8;r.byteOffset%4!==0&&(r=new Uint8Array(r));let s=r.length,n=s>>>1,o=s>>>2,a=t||new Uint16Array(s),c=new Uint32Array(r.buffer,r.byteOffset,o),l=new Uint32Array(a.buffer,a.byteOffset,n),d=e==="upper"?Gs:zr,f=0,v=0,y;if(gh)for(;f<o;)y=c[f++],l[v++]=d[y>>>8&255]<<16|d[y&255],l[v++]=d[y>>>24]<<16|d[y>>>16&255];else for(;f<o;)y=c[f++],l[v++]=d[y>>>24]<<16|d[y>>>16&255],l[v++]=d[y>>>8&255]<<16|d[y&255];for(f<<=2;f<s;)a[f]=d[r[f++]];return oS.decode(a.subarray(0,s))}i(Yh,"Ea");_(Yh,"_toHex");function Jh(r,e={}){let t="",s=r.length,n=iS>>>1,o=Math.ceil(s/n),a=new Uint16Array(o>1?n:s);for(let c=0;c<o;c++){let l=c*n,d=l+n;t+=Yh(r.subarray(l,d),nS(sS({},e),{scratchArr:a}))}return t}i(Jh,"Aa");_(Jh,"_toHexChunked");function Xh(r,e={}){return e.alphabet!=="upper"&&typeof r.toHex=="function"?r.toHex():Jh(r,e)}i(Xh,"Ei");_(Xh,"toHex");X();var Zh=class ef{static{i(this,"gt")}constructor(e,t){this.strings=e,this.values=t}toParameterizedQuery(e={query:"",params:[]}){let{strings:t,values:s}=this;for(let n=0,o=t.length;n<o;n++)if(e.query+=t[n],n<s.length){let a=s[n];if(a instanceof sf)e.query+=a.sql;else if(a instanceof Ys)if(a.queryData instanceof ef)a.queryData.toParameterizedQuery(e);else{if(a.queryData.params?.length)throw new Error("This query is not composable");e.query+=a.queryData.query}else{let{params:c}=e;c.push(a),e.query+="$"+c.length,(a instanceof re||ArrayBuffer.isView(a))&&(e.query+="::bytea")}}return e}};_(Zh,"SqlTemplate");var tf=Zh,rf=class{static{i(this,"Xt")}constructor(e){this.sql=e}};_(rf,"UnsafeRawSql");var sf=rf;X();function Ca(){typeof window<"u"&&typeof document<"u"&&typeof console<"u"&&typeof console.warn=="function"&&console.warn(`          
        ************************************************************
        *                                                          *
        *  WARNING: Running SQL directly from the browser can have *
        *  security implications. Even if your database is         *
        *  protected by Row-Level Security (RLS), use it at your   *
        *  own risk. This approach is great for fast prototyping,  *
        *  but ensure proper safeguards are in place to prevent    *
        *  misuse or execution of expensive SQL queries by your    *
        *  end users.                                              *
        *                                                          *
        *  If you've assessed the risks, suppress this message     *
        *  using the disableWarningInBrowsers configuration        *
        *  parameter.                                              *
        *                                                          *
        ************************************************************`)}i(Ca,"bt");_(Ca,"warnIfBrowser");Yr();var cS=Dt(ba()),uS=Dt(en()),nf=class of extends Error{static{i(this,"_t")}constructor(e){super(e),se(this,"name","NeonDbError"),se(this,"severity"),se(this,"code"),se(this,"detail"),se(this,"hint"),se(this,"position"),se(this,"internalPosition"),se(this,"internalQuery"),se(this,"where"),se(this,"schema"),se(this,"table"),se(this,"column"),se(this,"dataType"),se(this,"constraint"),se(this,"file"),se(this,"line"),se(this,"routine"),se(this,"sourceError"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,of)}};_(nf,"NeonDbError");var er=nf,bh="transaction() expects an array of queries, or a function returning an array of queries",lS=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function af(r){return r instanceof re?"\\x"+Xh(r):r}i(af,"Lu");_(af,"encodeBuffersAsBytea");function da(r){let{query:e,params:t}=r instanceof tf?r.toParameterizedQuery():r;return{query:e,params:t.map(s=>af((0,uS.prepareValue)(s)))}}i(da,"ss");_(da,"prepareQuery");function rr(r,{arrayMode:e,fullResults:t,fetchOptions:s,isolationLevel:n,readOnly:o,deferrable:a,authToken:c,disableWarningInBrowsers:l}={}){if(!r)throw new Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");let d;try{d=ga(r)}catch{throw new Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(r))}let{protocol:f,username:v,hostname:y,port:x,pathname:m}=d;if(f!=="postgres:"&&f!=="postgresql:"||!v||!y||!m)throw new Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function h(C,...P){if(!(Array.isArray(C)&&Array.isArray(C.raw)&&Array.isArray(P)))throw new Error('This function can now be called only as a tagged-template function: sql`SELECT ${value}`, not sql("SELECT $1", [value], options). For a conventional function call with value placeholders ($1, $2, etc.), use sql.query("SELECT $1", [value], options).');return new Ys(E,new tf(C,P))}i(h,"D"),_(h,"templateFn"),h.query=(C,P,A)=>new Ys(E,{query:C,params:P??[]},A),h.unsafe=C=>new sf(C),h.transaction=async(C,P)=>{if(typeof C=="function"&&(C=C(h)),!Array.isArray(C))throw new Error(bh);C.forEach(k=>{if(!(k instanceof Ys))throw new Error(bh)});let A=C.map(k=>k.queryData),B=C.map(k=>k.opts??{});return E(A,B,P)};async function E(C,P,A){let{fetchEndpoint:B,fetchFunction:k}=Gr,R=Array.isArray(C)?{queries:C.map(he=>da(he))}:da(C),L=s??{},M=e??!1,N=t??!1,Q=n,F=o,G=a;A!==void 0&&(A.fetchOptions!==void 0&&(L={...L,...A.fetchOptions}),A.arrayMode!==void 0&&(M=A.arrayMode),A.fullResults!==void 0&&(N=A.fullResults),A.isolationLevel!==void 0&&(Q=A.isolationLevel),A.readOnly!==void 0&&(F=A.readOnly),A.deferrable!==void 0&&(G=A.deferrable)),P!==void 0&&!Array.isArray(P)&&P.fetchOptions!==void 0&&(L={...L,...P.fetchOptions});let Y=c;!Array.isArray(P)&&P?.authToken!==void 0&&(Y=P.authToken);let q=typeof B=="function"?B(y,x,{jwtAuth:Y!==void 0}):B,K={"Neon-Connection-String":r,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},ee=await uf(Y);ee&&(K.Authorization=`Bearer ${ee}`),Array.isArray(C)&&(Q!==void 0&&(K["Neon-Batch-Isolation-Level"]=Q),F!==void 0&&(K["Neon-Batch-Read-Only"]=String(F)),G!==void 0&&(K["Neon-Batch-Deferrable"]=String(G))),l||Gr.disableWarningInBrowsers||Ca();let oe;try{oe=await(k??fetch)(q,{method:"POST",body:JSON.stringify(R),headers:K,...L})}catch(he){let ae=new er(`Error connecting to database: ${he}`);throw ae.sourceError=he,ae}if(oe.ok){let he=await oe.json();if(Array.isArray(C)){let ae=he.results;if(!Array.isArray(ae))throw new er("Neon internal error: unexpected result format");return ae.map((Xe,be)=>{let Be=P[be]??{},wr=Be.arrayMode??M,Sr=Be.fullResults??N;return ma(Xe,{arrayMode:wr,fullResults:Sr,types:Be.types})})}else{let ae=P??{},Xe=ae.arrayMode??M,be=ae.fullResults??N;return ma(he,{arrayMode:Xe,fullResults:be,types:ae.types})}}else{let{status:he}=oe;if(he===400){let ae=await oe.json(),Xe=new er(ae.message);for(let be of lS)Xe[be]=ae[be]??void 0;throw Xe}else{let ae=await oe.text();throw new er(`Server error (HTTP status ${he}): ${ae}`)}}}return i(E,"Y"),_(E,"execute"),h}i(rr,"cs");_(rr,"neon");var cf=class{static{i(this,"dr")}constructor(e,t,s){this.execute=e,this.queryData=t,this.opts=s}then(e,t){return this.execute(this.queryData,this.opts).then(e,t)}catch(e){return this.execute(this.queryData,this.opts).catch(e)}finally(e){return this.execute(this.queryData,this.opts).finally(e)}};_(cf,"NeonQueryPromise");var Ys=cf;function ma(r,{arrayMode:e,fullResults:t,types:s}){let n=new cS.default(s),o=r.fields.map(l=>l.name),a=r.fields.map(l=>n.getTypeParser(l.dataTypeID)),c=e===!0?r.rows.map(l=>l.map((d,f)=>d===null?null:a[f](d))):r.rows.map(l=>Object.fromEntries(l.map((d,f)=>[o[f],d===null?null:a[f](d)])));return t?(r.viaNeonFetch=!0,r.rowAsArray=e,r.rows=c,r._parsers=a,r._types=n,r):c}i(ma,"os");_(ma,"processQueryResult");async function uf(r){if(typeof r=="string")return r;if(typeof r=="function")try{return await Promise.resolve(r())}catch(e){let t=new er("Error getting auth token.");throw e instanceof Error&&(t=new er(`Error getting auth token: ${e.message}`)),t}}i(uf,"Fu");_(uf,"getAuthToken");X();var hS=Dt(rn());X();var fS=Dt(rn()),lf=class extends fS.Client{static{i(this,"kn")}constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let s=typeof this.config!="string"&&this.config?.host!==void 0||typeof this.config!="string"&&this.config?.connectionString!==void 0||ce.env.PGHOST!==void 0,n=ce.env.USER??ce.env.USERNAME;if(!s&&this.host==="localhost"&&this.user===n&&this.database===n&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${n}, db: ${n}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let o=super.connect(e),a=t.pipelineTLS&&this.ssl,c=t.pipelineConnect==="password";if(!a&&!t.pipelineConnect)return o;let l=this.connection;if(a&&l.on("connect",()=>l.stream.emit("data","S")),c){l.removeAllListeners("authenticationCleartextPassword"),l.removeAllListeners("readyForQuery"),l.once("readyForQuery",()=>l.on("readyForQuery",this._handleReadyForQuery.bind(this)));let d=this.ssl?"sslconnect":"connect";l.on(d,()=>{this.neonConfig.disableWarningInBrowsers||Ca(),this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return o}async _handleAuthSASLContinue(e){if(typeof crypto>"u"||crypto.subtle===void 0||crypto.subtle.importKey===void 0)throw new Error("Cannot use SASL auth when `crypto.subtle` is not defined");let t=crypto.subtle,s=this.saslSession,n=this.password,o=e.data;if(s.message!=="SASLInitialResponse"||typeof n!="string"||typeof o!="string")throw new Error("SASL: protocol error");let a=Object.fromEntries(o.split(",").map(he=>{if(!/^.=/.test(he))throw new Error("SASL: Invalid attribute pair entry");let ae=he[0],Xe=he.substring(2);return[ae,Xe]})),c=a.r,l=a.s,d=a.i;if(!c||!/^[!-+--~]+$/.test(c))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!l||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(l))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!d||!/^[1-9][0-9]*$/.test(d))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!c.startsWith(s.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(c.length===s.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let f=parseInt(d,10),v=re.from(l,"base64"),y=new TextEncoder,x=y.encode(n),m=await t.importKey("raw",x,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),h=new Uint8Array(await t.sign("HMAC",m,re.concat([v,re.from([0,0,0,1])]))),E=h;for(var C=0;C<f-1;C++)h=new Uint8Array(await t.sign("HMAC",m,h)),E=re.from(E.map((he,ae)=>E[ae]^h[ae]));let P=E,A=await t.importKey("raw",P,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),B=new Uint8Array(await t.sign("HMAC",A,y.encode("Client Key"))),k=await t.digest("SHA-256",B),R="n=*,r="+s.clientNonce,L="r="+c+",s="+l+",i="+f,M="c=biws,r="+c,N=R+","+L+","+M,Q=await t.importKey("raw",k,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var F=new Uint8Array(await t.sign("HMAC",Q,y.encode(N))),G=re.from(B.map((he,ae)=>B[ae]^F[ae])),Y=G.toString("base64");let q=await t.importKey("raw",P,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),K=await t.sign("HMAC",q,y.encode("Server Key")),ee=await t.importKey("raw",K,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var oe=re.from(await t.sign("HMAC",ee,y.encode(N)));s.message="SASLResponse",s.serverSignature=oe.toString("base64"),s.response=M+",p="+Y,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};_(lf,"NeonClient");var pS=lf;Yr();var dS=Dt(Ea());function hf(r,e){if(e)return{callback:e,result:void 0};let t,s,n=_(function(a,c){a?t(a):s(c)},"cb"),o=new r(function(a,c){s=a,t=c});return{callback:n,result:o}}i(hf,"vl");_(hf,"promisify");var mS=class extends hS.Pool{static{i(this,"Un")}constructor(){super(...arguments),se(this,"Client",pS),se(this,"hasFetchUnsupportedListeners",!1),se(this,"addListener",this.on)}on(e,t){return e!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(e,t)}query(e,t,s){if(!Gr.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof e=="function")return super.query(e,t,s);typeof t=="function"&&(s=t,t=void 0);let n=hf(this.Promise,s);s=n.callback;try{let o=new dS.default(this.options),a=encodeURIComponent,c=encodeURI,l=`postgresql://${a(o.user)}:${a(o.password)}@${a(o.host)}/${c(o.database)}`,d=typeof e=="string"?e:e.text,f=t??e.values??[];rr(l,{fullResults:!0,arrayMode:e.rowMode==="array"}).query(d,f,{types:e.types??this.options?.types}).then(v=>s(void 0,v)).catch(v=>s(v))}catch(o){s(o)}return n.result}};_(mS,"NeonPool");Yr();var Xr=Dt(rn());var Q5=Xr.DatabaseError,U5=Xr.defaults,$5=Xr.escapeIdentifier,j5=Xr.escapeLiteral,Ge=Xr.types;S();w();b();var Ta=class{static{i(this,"ConsoleLogWriter")}static[T]="ConsoleLogWriter";write(e){console.log(e)}},sr=class{static{i(this,"DefaultLogger")}static[T]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new Ta}logQuery(e,t){let s=t.map(o=>{try{return JSON.stringify(o)}catch{return String(o)}}),n=s.length?` -- params: [${s.join(", ")}]`:"";this.writer.write(`Query: ${e}${n}`)}},nr=class{static{i(this,"NoopLogger")}static[T]="NoopLogger";logQuery(){}};S();w();b();var sn={arrayMode:!1,fullResults:!0},Pa={arrayMode:!0,fullResults:!0},Aa=class extends Jt{static{i(this,"NeonHttpPreparedQuery")}constructor(e,t,s,n,o,a,c,l,d){super(t,n,o,a),this.client=e,this.logger=s,this.fields=c,this._isResponseInArrayMode=l,this.customResultMapper=d,this.clientQuery=e.query??e}static[T]="NeonHttpPreparedQuery";clientQuery;async execute(e={},t=this.authToken){let s=It(this.query.params,e);this.logger.logQuery(this.query.sql,s);let{fields:n,clientQuery:o,query:a,customResultMapper:c}=this;if(!n&&!c)return this.queryWithCache(a.sql,s,async()=>o(a.sql,s,t===void 0?sn:{...sn,authToken:t}));let l=await this.queryWithCache(a.sql,s,async()=>await o(a.sql,s,t===void 0?Pa:{...Pa,authToken:t}));return this.mapResult(l)}mapResult(e){if(!this.fields&&!this.customResultMapper)return e;let t=e.rows;return this.customResultMapper?this.customResultMapper(t):t.map(s=>Ps(this.fields,s,this.joinsNotNullableMap))}all(e={}){let t=It(this.query.params,e);return this.logger.logQuery(this.query.sql,t),this.clientQuery(this.query.sql,t,this.authToken===void 0?sn:{...sn,authToken:this.authToken}).then(s=>s.rows)}values(e={},t){let s=It(this.query.params,e);return this.logger.logQuery(this.query.sql,s),this.clientQuery(this.query.sql,s,{arrayMode:!0,fullResults:!0,authToken:t}).then(n=>n.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}},nn=class extends Xt{static{i(this,"NeonHttpSession")}constructor(e,t,s,n={}){super(t),this.client=e,this.schema=s,this.options=n,this.clientQuery=e.query??e,this.logger=n.logger??new nr,this.cache=n.cache??new xt}static[T]="NeonHttpSession";clientQuery;logger;cache;prepareQuery(e,t,s,n,o,a,c){return new Aa(this.client,e,this.logger,this.cache,a,c,t,n,o)}async batch(e){let t=[],s=[];for(let o of e){let a=o._prepare(),c=a.getQuery();t.push(a),s.push(this.clientQuery(c.sql,c.params,{fullResults:!0,arrayMode:a.isResponseInArrayMode()}))}return(await this.client.transaction(s,Pa)).map((o,a)=>t[a].mapResult(o,!0))}async query(e,t){return this.logger.logQuery(e,t),await this.clientQuery(e,t,{arrayMode:!0,fullResults:!0})}async queryObjects(e,t){return this.clientQuery(e,t,{arrayMode:!1,fullResults:!0})}async count(e,t){let s=await this.execute(e,t);return Number(s.rows[0].count)}async transaction(e,t={}){throw new Error("No transactions support in neon-http driver")}},ff=class extends Zt{static{i(this,"NeonTransaction")}static[T]="NeonHttpTransaction";async transaction(e){throw new Error("No transactions support in neon-http driver")}};var Ra=class{static{i(this,"NeonHttpDriver")}constructor(e,t,s={}){this.client=e,this.dialect=t,this.options=s,this.initMappers()}static[T]="NeonHttpDriver";createSession(e){return new nn(this.client,this.dialect,e,{logger:this.options.logger,cache:this.options.cache})}initMappers(){Ge.setTypeParser(Ge.builtins.TIMESTAMPTZ,e=>e),Ge.setTypeParser(Ge.builtins.TIMESTAMP,e=>e),Ge.setTypeParser(Ge.builtins.DATE,e=>e),Ge.setTypeParser(Ge.builtins.INTERVAL,e=>e),Ge.setTypeParser(1231,e=>e),Ge.setTypeParser(1115,e=>e),Ge.setTypeParser(1185,e=>e),Ge.setTypeParser(1187,e=>e),Ge.setTypeParser(1182,e=>e)}};function on(r,e,t,s){return new Proxy(r,{get(n,o){let a=n[o];return typeof a!="function"&&(typeof a!="object"||a===null)?a:s?on(a,e,t):o==="query"?on(a,e,t,!0):new Proxy(a,{apply(c,l,d){let f=c.call(l,...d);return typeof f=="object"&&f!==null&&"setToken"in f&&typeof f.setToken=="function"&&f.setToken(e),t(c,o,f)}})}})}i(on,"wrap");var Na=class extends Et{static{i(this,"NeonHttpDatabase")}static[T]="NeonHttpDatabase";$withAuth(e){return this.authToken=e,on(this,e,(t,s,n)=>s==="with"?on(n,e,(o,a,c)=>c):n)}async batch(e){return this.session.batch(e)}};function ir(r,e={}){let t=new ft({casing:e.casing}),s;e.logger===!0?s=new sr:e.logger!==!1&&(s=e.logger);let n;if(e.schema){let l=ks(e.schema,Fs);n={fullSchema:e.schema,schema:l.tables,tableNamesMap:l.tableNamesMap}}let a=new Ra(r,t,{logger:s,cache:e.cache}).createSession(n),c=new Na(t,a,n);return c.$client=r,c.$cache=e.cache,c.$cache&&(c.$cache.invalidate=e.cache?.onMutate),c}i(ir,"construct");function an(...r){if(typeof r[0]=="string"){let e=rr(r[0]);return ir(e,r[1])}if(Rs(r[0])){let{connection:e,client:t,...s}=r[0];if(t)return ir(t,s);if(typeof e=="object"){let{connectionString:o,...a}=e,c=rr(o,a);return ir(c,s)}let n=rr(e);return ir(n,s)}return ir(r[0],r[1])}i(an,"drizzle");(r=>{function e(t){return ir({},t)}i(e,"mock"),r.mock=e})(an||(an={}));S();w();b();S();w();b();var Ze=Kg(Uc(),1),h9=Ze.default.Client,f9=Ze.default.Pool,p9=Ze.default.Connection,d9=Ze.default.types,m9=Ze.default.Query,y9=Ze.default.DatabaseError,g9=Ze.default.escapeIdentifier,b9=Ze.default.escapeLiteral,w9=Ze.default.Result,S9=Ze.default.TypeOverrides,v9=Ze.default.defaults,yr=Ze.default;S();w();b();var{Pool:hg,types:pt}=yr,Vc=class extends Jt{static{i(this,"NodePgPreparedQuery")}constructor(e,t,s,n,o,a,c,l,d,f,v){super({sql:t,params:s},o,a,c),this.client=e,this.queryString=t,this.params=s,this.logger=n,this.fields=l,this._isResponseInArrayMode=f,this.customResultMapper=v,this.rawQueryConfig={name:d,text:t,types:{getTypeParser:i((y,x)=>y===pt.builtins.TIMESTAMPTZ?m=>m:y===pt.builtins.TIMESTAMP?m=>m:y===pt.builtins.DATE?m=>m:y===pt.builtins.INTERVAL?m=>m:y===1231?m=>m:y===1115?m=>m:y===1185?m=>m:y===1187?m=>m:y===1182?m=>m:pt.getTypeParser(y,x),"getTypeParser")}},this.queryConfig={name:d,text:t,rowMode:"array",types:{getTypeParser:i((y,x)=>y===pt.builtins.TIMESTAMPTZ?m=>m:y===pt.builtins.TIMESTAMP?m=>m:y===pt.builtins.DATE?m=>m:y===pt.builtins.INTERVAL?m=>m:y===1231?m=>m:y===1115?m=>m:y===1185?m=>m:y===1187?m=>m:y===1182?m=>m:pt.getTypeParser(y,x),"getTypeParser")}}}static[T]="NodePgPreparedQuery";rawQueryConfig;queryConfig;async execute(e={}){return ge.startActiveSpan("drizzle.execute",async()=>{let t=It(this.params,e);this.logger.logQuery(this.rawQueryConfig.text,t);let{fields:s,rawQueryConfig:n,client:o,queryConfig:a,joinsNotNullableMap:c,customResultMapper:l}=this;if(!s&&!l)return ge.startActiveSpan("drizzle.driver.execute",async f=>(f?.setAttributes({"drizzle.query.name":n.name,"drizzle.query.text":n.text,"drizzle.query.params":JSON.stringify(t)}),this.queryWithCache(n.text,t,async()=>await o.query(n,t))));let d=await ge.startActiveSpan("drizzle.driver.execute",f=>(f?.setAttributes({"drizzle.query.name":a.name,"drizzle.query.text":a.text,"drizzle.query.params":JSON.stringify(t)}),this.queryWithCache(a.text,t,async()=>await o.query(a,t))));return ge.startActiveSpan("drizzle.mapResponse",()=>l?l(d.rows):d.rows.map(f=>Ps(s,f,c)))})}all(e={}){return ge.startActiveSpan("drizzle.execute",()=>{let t=It(this.params,e);return this.logger.logQuery(this.rawQueryConfig.text,t),ge.startActiveSpan("drizzle.driver.execute",s=>(s?.setAttributes({"drizzle.query.name":this.rawQueryConfig.name,"drizzle.query.text":this.rawQueryConfig.text,"drizzle.query.params":JSON.stringify(t)}),this.queryWithCache(this.rawQueryConfig.text,t,async()=>this.client.query(this.rawQueryConfig,t)).then(n=>n.rows)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}},Zn=class r extends Xt{static{i(this,"NodePgSession")}constructor(e,t,s,n={}){super(t),this.client=e,this.schema=s,this.options=n,this.logger=n.logger??new nr,this.cache=n.cache??new xt}static[T]="NodePgSession";logger;cache;prepareQuery(e,t,s,n,o,a,c){return new Vc(this.client,e.sql,e.params,this.logger,this.cache,a,c,t,s,n,o)}async transaction(e,t){let s=this.client instanceof hg?new r(await this.client.connect(),this.dialect,this.schema,this.options):this,n=new Kc(this.dialect,s,this.schema);await n.execute(O`begin${t?O` ${n.getTransactionConfigSQL(t)}`:void 0}`);try{let o=await e(n);return await n.execute(O`commit`),o}catch(o){throw await n.execute(O`rollback`),o}finally{this.client instanceof hg&&s.client.release()}}async count(e){let t=await this.execute(e);return Number(t.rows[0].count)}},Kc=class r extends Zt{static{i(this,"NodePgTransaction")}static[T]="NodePgTransaction";async transaction(e){let t=`sp${this.nestedIndex+1}`,s=new r(this.dialect,this.session,this.schema,this.nestedIndex+1);await s.execute(O.raw(`savepoint ${t}`));try{let n=await e(s);return await s.execute(O.raw(`release savepoint ${t}`)),n}catch(n){throw await s.execute(O.raw(`rollback to savepoint ${t}`)),n}}};var zc=class{static{i(this,"NodePgDriver")}constructor(e,t,s={}){this.client=e,this.dialect=t,this.options=s}static[T]="NodePgDriver";createSession(e){return new Zn(this.client,this.dialect,e,{logger:this.options.logger,cache:this.options.cache})}},Wc=class extends Et{static{i(this,"NodePgDatabase")}static[T]="NodePgDatabase"};function hs(r,e={}){let t=new ft({casing:e.casing}),s;e.logger===!0?s=new sr:e.logger!==!1&&(s=e.logger);let n;if(e.schema){let l=ks(e.schema,Fs);n={fullSchema:e.schema,schema:l.tables,tableNamesMap:l.tableNamesMap}}let a=new zc(r,t,{logger:s,cache:e.cache}).createSession(n),c=new Wc(t,a,n);return c.$client=r,c.$cache=e.cache,c.$cache&&(c.$cache.invalidate=e.cache?.onMutate),c}i(hs,"construct");function ei(...r){if(typeof r[0]=="string"){let e=new yr.Pool({connectionString:r[0]});return hs(e,r[1])}if(Rs(r[0])){let{connection:e,client:t,...s}=r[0];if(t)return hs(t,s);let n=typeof e=="string"?new yr.Pool({connectionString:e}):new yr.Pool(e);return hs(n,s)}return hs(r[0],r[1])}i(ei,"drizzle");(r=>{function e(t){return hs({},t)}i(e,"mock"),r.mock=e})(ei||(ei={}));S();w();b();S();w();b();S();w();b();S();w();b();var Gc=i((r,e,t)=>(s,n)=>{let o=-1;return a(0);async function a(c){if(c<=o)throw new Error("next() called multiple times");o=c;let l,d=!1,f;if(r[c]?(f=r[c][0][0],s.req.routeIndex=c):f=c===r.length&&n||void 0,f)try{l=await f(s,()=>a(c+1))}catch(v){if(v instanceof Error&&e)s.error=v,l=await e(v,s),d=!0;else throw v}else s.finalized===!1&&t&&(l=await t(s));return l&&(s.finalized===!1||d)&&(s.res=l),s}},"compose");S();w();b();S();w();b();S();w();b();var fg=Symbol();S();w();b();var pg=i(async(r,e=Object.create(null))=>{let{all:t=!1,dot:s=!1}=e,o=(r instanceof ti?r.raw.headers:r.headers).get("Content-Type");return o?.startsWith("multipart/form-data")||o?.startsWith("application/x-www-form-urlencoded")?_C(r,{all:t,dot:s}):{}},"parseBody");async function _C(r,e){let t=await r.formData();return t?EC(t,e):{}}i(_C,"parseFormData");function EC(r,e){let t=Object.create(null);return r.forEach((s,n)=>{e.all||n.endsWith("[]")?xC(t,n,s):t[n]=s}),e.dot&&Object.entries(t).forEach(([s,n])=>{s.includes(".")&&(CC(t,s,n),delete t[s])}),t}i(EC,"convertFormDataToBodyData");var xC=i((r,e,t)=>{r[e]!==void 0?Array.isArray(r[e])?r[e].push(t):r[e]=[r[e],t]:e.endsWith("[]")?r[e]=[t]:r[e]=t},"handleParsingAllValues"),CC=i((r,e,t)=>{let s=r,n=e.split(".");n.forEach((o,a)=>{a===n.length-1?s[o]=t:((!s[o]||typeof s[o]!="object"||Array.isArray(s[o])||s[o]instanceof File)&&(s[o]=Object.create(null)),s=s[o])})},"handleParsingNestedValues");S();w();b();var Jc=i(r=>{let e=r.split("/");return e[0]===""&&e.shift(),e},"splitPath"),dg=i(r=>{let{groups:e,path:t}=TC(r),s=Jc(t);return PC(s,e)},"splitRoutingPath"),TC=i(r=>{let e=[];return r=r.replace(/\{[^}]+\}/g,(t,s)=>{let n=`@${s}`;return e.push([n,t]),n}),{groups:e,path:r}},"extractGroupsFromPath"),PC=i((r,e)=>{for(let t=e.length-1;t>=0;t--){let[s]=e[t];for(let n=r.length-1;n>=0;n--)if(r[n].includes(s)){r[n]=r[n].replace(s,e[t][1]);break}}return r},"replaceGroupMarks"),ri={},mg=i((r,e)=>{if(r==="*")return"*";let t=r.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(t){let s=`${r}#${e}`;return ri[s]||(t[2]?ri[s]=e&&e[0]!==":"&&e[0]!=="*"?[s,t[1],new RegExp(`^${t[2]}(?=/${e})`)]:[r,t[1],new RegExp(`^${t[2]}$`)]:ri[s]=[r,t[1],!0]),ri[s]}return null},"getPattern"),si=i((r,e)=>{try{return e(r)}catch{return r.replace(/(?:%[0-9A-Fa-f]{2})+/g,t=>{try{return e(t)}catch{return t}})}},"tryDecode"),AC=i(r=>si(r,decodeURI),"tryDecodeURI"),Xc=i(r=>{let e=r.url,t=e.indexOf("/",e.charCodeAt(9)===58?13:8),s=t;for(;s<e.length;s++){let n=e.charCodeAt(s);if(n===37){let o=e.indexOf("?",s),a=e.slice(t,o===-1?void 0:o);return AC(a.includes("%25")?a.replace(/%25/g,"%2525"):a)}else if(n===63)break}return e.slice(t,s)},"getPath");var yg=i(r=>{let e=Xc(r);return e.length>1&&e.at(-1)==="/"?e.slice(0,-1):e},"getPathNoStrict"),Ut=i((r,e,...t)=>(t.length&&(e=Ut(e,...t)),`${r?.[0]==="/"?"":"/"}${r}${e==="/"?"":`${r?.at(-1)==="/"?"":"/"}${e?.[0]==="/"?e.slice(1):e}`}`),"mergePath"),ni=i(r=>{if(r.charCodeAt(r.length-1)!==63||!r.includes(":"))return null;let e=r.split("/"),t=[],s="";return e.forEach(n=>{if(n!==""&&!/\:/.test(n))s+="/"+n;else if(/\:/.test(n))if(/\?/.test(n)){t.length===0&&s===""?t.push("/"):t.push(s);let o=n.replace("?","");s+="/"+o,t.push(s)}else s+="/"+n}),t.filter((n,o,a)=>a.indexOf(n)===o)},"checkOptionalParameter"),Yc=i(r=>/[%+]/.test(r)?(r.indexOf("+")!==-1&&(r=r.replace(/\+/g," ")),r.indexOf("%")!==-1?si(r,Zc):r):r,"_decodeURI"),gg=i((r,e,t)=>{let s;if(!t&&e&&!/[%+]/.test(e)){let a=r.indexOf(`?${e}`,8);for(a===-1&&(a=r.indexOf(`&${e}`,8));a!==-1;){let c=r.charCodeAt(a+e.length+1);if(c===61){let l=a+e.length+2,d=r.indexOf("&",l);return Yc(r.slice(l,d===-1?void 0:d))}else if(c==38||isNaN(c))return"";a=r.indexOf(`&${e}`,a+1)}if(s=/[%+]/.test(r),!s)return}let n={};s??=/[%+]/.test(r);let o=r.indexOf("?",8);for(;o!==-1;){let a=r.indexOf("&",o+1),c=r.indexOf("=",o);c>a&&a!==-1&&(c=-1);let l=r.slice(o+1,c===-1?a===-1?void 0:a:c);if(s&&(l=Yc(l)),o=a,l==="")continue;let d;c===-1?d="":(d=r.slice(c+1,a===-1?void 0:a),s&&(d=Yc(d))),t?(n[l]&&Array.isArray(n[l])||(n[l]=[]),n[l].push(d)):n[l]??=d}return e?n[e]:n},"_getQueryParam"),bg=gg,wg=i((r,e)=>gg(r,e,!0),"getQueryParams"),Zc=decodeURIComponent;var Sg=i(r=>si(r,Zc),"tryDecodeURIComponent"),ti=class{static{i(this,"HonoRequest")}raw;#t;#e;routeIndex=0;path;bodyCache={};constructor(r,e="/",t=[[]]){this.raw=r,this.path=e,this.#e=t,this.#t={}}param(r){return r?this.#r(r):this.#i()}#r(r){let e=this.#e[0][this.routeIndex][1][r],t=this.#n(e);return t?/\%/.test(t)?Sg(t):t:void 0}#i(){let r={},e=Object.keys(this.#e[0][this.routeIndex][1]);for(let t of e){let s=this.#n(this.#e[0][this.routeIndex][1][t]);s&&typeof s=="string"&&(r[t]=/\%/.test(s)?Sg(s):s)}return r}#n(r){return this.#e[1]?this.#e[1][r]:r}query(r){return bg(this.url,r)}queries(r){return wg(this.url,r)}header(r){if(r)return this.raw.headers.get(r)??void 0;let e={};return this.raw.headers.forEach((t,s)=>{e[s]=t}),e}async parseBody(r){return this.bodyCache.parsedBody??=await pg(this,r)}#s=i(r=>{let{bodyCache:e,raw:t}=this,s=e[r];if(s)return s;let n=Object.keys(e)[0];return n?e[n].then(o=>(n==="json"&&(o=JSON.stringify(o)),new Response(o)[r]())):e[r]=t[r]()},"#cachedBody");json(){return this.#s("json")}text(){return this.#s("text")}arrayBuffer(){return this.#s("arrayBuffer")}blob(){return this.#s("blob")}formData(){return this.#s("formData")}addValidatedData(r,e){this.#t[r]=e}valid(r){return this.#t[r]}get url(){return this.raw.url}get method(){return this.raw.method}get[fg](){return this.#e}get matchedRoutes(){return this.#e[0].map(([[,r]])=>r)}get routePath(){return this.#e[0].map(([[,r]])=>r)[this.routeIndex].path}};S();w();b();var vg={Stringify:1,BeforeStream:2,Stream:3},RC=i((r,e)=>{let t=new String(r);return t.isEscaped=!0,t.callbacks=e,t},"raw");var eu=i(async(r,e,t,s,n)=>{typeof r=="object"&&!(r instanceof String)&&(r instanceof Promise||(r=r.toString()),r instanceof Promise&&(r=await r));let o=r.callbacks;if(!o?.length)return Promise.resolve(r);n?n[0]+=r:n=[r];let a=Promise.all(o.map(c=>c({phase:e,buffer:n,context:s}))).then(c=>Promise.all(c.filter(Boolean).map(l=>eu(l,e,!1,s,n))).then(()=>n[0]));return t?RC(await a,o):a},"resolveCallback");var NC="text/plain; charset=UTF-8",tu=i((r,e)=>({"Content-Type":r,...e}),"setDefaultContentType"),_g=class{static{i(this,"Context")}#t;#e;env={};#r;finalized=!1;error;#i;#n;#s;#l;#c;#u;#a;#h;#f;constructor(r,e){this.#t=r,e&&(this.#n=e.executionCtx,this.env=e.env,this.#u=e.notFoundHandler,this.#f=e.path,this.#h=e.matchResult)}get req(){return this.#e??=new ti(this.#t,this.#f,this.#h),this.#e}get event(){if(this.#n&&"respondWith"in this.#n)return this.#n;throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#n)return this.#n;throw Error("This context has no ExecutionContext")}get res(){return this.#s||=new Response(null,{headers:this.#a??=new Headers})}set res(r){if(this.#s&&r){r=new Response(r.body,r);for(let[e,t]of this.#s.headers.entries())if(e!=="content-type")if(e==="set-cookie"){let s=this.#s.headers.getSetCookie();r.headers.delete("set-cookie");for(let n of s)r.headers.append("set-cookie",n)}else r.headers.set(e,t)}this.#s=r,this.finalized=!0}render=i((...r)=>(this.#c??=e=>this.html(e),this.#c(...r)),"render");setLayout=i(r=>this.#l=r,"setLayout");getLayout=i(()=>this.#l,"getLayout");setRenderer=i(r=>{this.#c=r},"setRenderer");header=i((r,e,t)=>{this.finalized&&(this.#s=new Response(this.#s.body,this.#s));let s=this.#s?this.#s.headers:this.#a??=new Headers;e===void 0?s.delete(r):t?.append?s.append(r,e):s.set(r,e)},"header");status=i(r=>{this.#i=r},"status");set=i((r,e)=>{this.#r??=new Map,this.#r.set(r,e)},"set");get=i(r=>this.#r?this.#r.get(r):void 0,"get");get var(){return this.#r?Object.fromEntries(this.#r):{}}#o(r,e,t){let s=this.#s?new Headers(this.#s.headers):this.#a??new Headers;if(typeof e=="object"&&"headers"in e){let o=e.headers instanceof Headers?e.headers:new Headers(e.headers);for(let[a,c]of o)a.toLowerCase()==="set-cookie"?s.append(a,c):s.set(a,c)}if(t)for(let[o,a]of Object.entries(t))if(typeof a=="string")s.set(o,a);else{s.delete(o);for(let c of a)s.append(o,c)}let n=typeof e=="number"?e:e?.status??this.#i;return new Response(r,{status:n,headers:s})}newResponse=i((...r)=>this.#o(...r),"newResponse");body=i((r,e,t)=>this.#o(r,e,t),"body");text=i((r,e,t)=>!this.#a&&!this.#i&&!e&&!t&&!this.finalized?new Response(r):this.#o(r,e,tu(NC,t)),"text");json=i((r,e,t)=>this.#o(JSON.stringify(r),e,tu("application/json",t)),"json");html=i((r,e,t)=>{let s=i(n=>this.#o(n,e,tu("text/html; charset=UTF-8",t)),"res");return typeof r=="object"?eu(r,vg.Stringify,!1,{}).then(s):s(r)},"html");redirect=i((r,e)=>(this.header("Location",String(r)),this.newResponse(null,e??302)),"redirect");notFound=i(()=>(this.#u??=()=>new Response,this.#u(this)),"notFound")};S();w();b();var Ne="ALL",Eg="all",xg=["get","post","put","delete","options","patch"],ii="Can not add a route since the matcher is already built.",oi=class extends Error{static{i(this,"UnsupportedPathError")}};S();w();b();var Cg="__COMPOSED_HANDLER";var OC=i(r=>r.text("404 Not Found",404),"notFoundHandler"),Tg=i((r,e)=>{if("getResponse"in r){let t=r.getResponse();return e.newResponse(t.body,t)}return console.error(r),e.text("Internal Server Error",500)},"errorHandler"),ru=class{static{i(this,"Hono")}get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#t="/";routes=[];constructor(r={}){[...xg,Eg].forEach(n=>{this[n]=(o,...a)=>(typeof o=="string"?this.#t=o:this.#i(n,this.#t,o),a.forEach(c=>{this.#i(n,this.#t,c)}),this)}),this.on=(n,o,...a)=>{for(let c of[o].flat()){this.#t=c;for(let l of[n].flat())a.map(d=>{this.#i(l.toUpperCase(),this.#t,d)})}return this},this.use=(n,...o)=>(typeof n=="string"?this.#t=n:(this.#t="*",o.unshift(n)),o.forEach(a=>{this.#i(Ne,this.#t,a)}),this);let{strict:t,...s}=r;Object.assign(this,s),this.getPath=t??!0?r.getPath??Xc:yg}#e(){let r=new ru({router:this.router,getPath:this.getPath});return r.errorHandler=this.errorHandler,r.#r=this.#r,r.routes=this.routes,r}#r=OC;errorHandler=Tg;route(r,e){let t=this.basePath(r);return e.routes.map(s=>{let n;e.errorHandler===Tg?n=s.handler:(n=i(async(o,a)=>(await Gc([],e.errorHandler)(o,()=>s.handler(o,a))).res,"handler"),n[Cg]=s.handler),t.#i(s.method,s.path,n)}),this}basePath(r){let e=this.#e();return e._basePath=Ut(this._basePath,r),e}onError=i(r=>(this.errorHandler=r,this),"onError");notFound=i(r=>(this.#r=r,this),"notFound");mount(r,e,t){let s,n;t&&(typeof t=="function"?n=t:(n=t.optionHandler,t.replaceRequest===!1?s=i(c=>c,"replaceRequest"):s=t.replaceRequest));let o=n?c=>{let l=n(c);return Array.isArray(l)?l:[l]}:c=>{let l;try{l=c.executionCtx}catch{}return[c.env,l]};s||=(()=>{let c=Ut(this._basePath,r),l=c==="/"?0:c.length;return d=>{let f=new URL(d.url);return f.pathname=f.pathname.slice(l)||"/",new Request(f,d)}})();let a=i(async(c,l)=>{let d=await e(s(c.req.raw),...o(c));if(d)return d;await l()},"handler");return this.#i(Ne,Ut(r,"*"),a),this}#i(r,e,t){r=r.toUpperCase(),e=Ut(this._basePath,e);let s={basePath:this._basePath,path:e,method:r,handler:t};this.router.add(r,e,[t,s]),this.routes.push(s)}#n(r,e){if(r instanceof Error)return this.errorHandler(r,e);throw r}#s(r,e,t,s){if(s==="HEAD")return(async()=>new Response(null,await this.#s(r,e,t,"GET")))();let n=this.getPath(r,{env:t}),o=this.router.match(s,n),a=new _g(r,{path:n,matchResult:o,env:t,executionCtx:e,notFoundHandler:this.#r});if(o[0].length===1){let l;try{l=o[0][0][0][0](a,async()=>{a.res=await this.#r(a)})}catch(d){return this.#n(d,a)}return l instanceof Promise?l.then(d=>d||(a.finalized?a.res:this.#r(a))).catch(d=>this.#n(d,a)):l??this.#r(a)}let c=Gc(o[0],this.errorHandler,this.#r);return(async()=>{try{let l=await c(a);if(!l.finalized)throw new Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return l.res}catch(l){return this.#n(l,a)}})()}fetch=i((r,...e)=>this.#s(r,e[1],e[0],r.method),"fetch");request=i((r,e,t,s)=>r instanceof Request?this.fetch(e?new Request(r,e):r,t,s):(r=r.toString(),this.fetch(new Request(/^https?:\/\//.test(r)?r:`http://localhost${Ut("/",r)}`,e),t,s)),"request");fire=i(()=>{addEventListener("fetch",r=>{r.respondWith(this.#s(r.request,r,void 0,r.request.method))})},"fire")};S();w();b();S();w();b();S();w();b();var ai="[^/]+",fs=".*",ps="(?:|/.*)",gr=Symbol(),IC=new Set(".\\+*[^]$()");function LC(r,e){return r.length===1?e.length===1?r<e?-1:1:-1:e.length===1||r===fs||r===ps?1:e===fs||e===ps?-1:r===ai?1:e===ai?-1:r.length===e.length?r<e?-1:1:e.length-r.length}i(LC,"compareKey");var ci=class{static{i(this,"Node")}#t;#e;#r=Object.create(null);insert(r,e,t,s,n){if(r.length===0){if(this.#t!==void 0)throw gr;if(n)return;this.#t=e;return}let[o,...a]=r,c=o==="*"?a.length===0?["","",fs]:["","",ai]:o==="/*"?["","",ps]:o.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),l;if(c){let d=c[1],f=c[2]||ai;if(d&&c[2]&&(f=f.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(f)))throw gr;if(l=this.#r[f],!l){if(Object.keys(this.#r).some(v=>v!==fs&&v!==ps))throw gr;if(n)return;l=this.#r[f]=new ci,d!==""&&(l.#e=s.varIndex++)}!n&&d!==""&&t.push([d,l.#e])}else if(l=this.#r[o],!l){if(Object.keys(this.#r).some(d=>d.length>1&&d!==fs&&d!==ps))throw gr;if(n)return;l=this.#r[o]=new ci}l.insert(a,e,t,s,n)}buildRegExpStr(){let e=Object.keys(this.#r).sort(LC).map(t=>{let s=this.#r[t];return(typeof s.#e=="number"?`(${t})@${s.#e}`:IC.has(t)?`\\${t}`:t)+s.buildRegExpStr()});return typeof this.#t=="number"&&e.unshift(`#${this.#t}`),e.length===0?"":e.length===1?e[0]:"(?:"+e.join("|")+")"}};S();w();b();var Pg=class{static{i(this,"Trie")}#t={varIndex:0};#e=new ci;insert(r,e,t){let s=[],n=[];for(let a=0;;){let c=!1;if(r=r.replace(/\{[^}]+\}/g,l=>{let d=`@\\${a}`;return n[a]=[d,l],a++,c=!0,d}),!c)break}let o=r.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let a=n.length-1;a>=0;a--){let[c]=n[a];for(let l=o.length-1;l>=0;l--)if(o[l].indexOf(c)!==-1){o[l]=o[l].replace(c,n[a][1]);break}}return this.#e.insert(o,e,s,this.#t,t),s}buildRegExp(){let r=this.#e.buildRegExpStr();if(r==="")return[/^$/,[],[]];let e=0,t=[],s=[];return r=r.replace(/#(\d+)|@(\d+)|\.\*\$/g,(n,o,a)=>o!==void 0?(t[++e]=Number(o),"$()"):(a!==void 0&&(s[Number(a)]=++e),"")),[new RegExp(`^${r}`),t,s]}};var Ag=[],MC=[/^$/,[],Object.create(null)],Rg=Object.create(null);function Ng(r){return Rg[r]??=new RegExp(r==="*"?"":`^${r.replace(/\/\*$|([.\\+*[^\]$()])/g,(e,t)=>t?`\\${t}`:"(?:|/.*)")}$`)}i(Ng,"buildWildcardRegExp");function DC(){Rg=Object.create(null)}i(DC,"clearWildcardRegExpCache");function BC(r){let e=new Pg,t=[];if(r.length===0)return MC;let s=r.map(d=>[!/\*|\/:/.test(d[0]),...d]).sort(([d,f],[v,y])=>d?1:v?-1:f.length-y.length),n=Object.create(null);for(let d=0,f=-1,v=s.length;d<v;d++){let[y,x,m]=s[d];y?n[x]=[m.map(([E])=>[E,Object.create(null)]),Ag]:f++;let h;try{h=e.insert(x,f,y)}catch(E){throw E===gr?new oi(x):E}y||(t[f]=m.map(([E,C])=>{let P=Object.create(null);for(C-=1;C>=0;C--){let[A,B]=h[C];P[A]=B}return[E,P]}))}let[o,a,c]=e.buildRegExp();for(let d=0,f=t.length;d<f;d++)for(let v=0,y=t[d].length;v<y;v++){let x=t[d][v]?.[1];if(!x)continue;let m=Object.keys(x);for(let h=0,E=m.length;h<E;h++)x[m[h]]=c[x[m[h]]]}let l=[];for(let d in a)l[d]=t[a[d]];return[o,l,n]}i(BC,"buildMatcherFromPreprocessedRoutes");function br(r,e){if(r){for(let t of Object.keys(r).sort((s,n)=>n.length-s.length))if(Ng(t).test(e))return[...r[t]]}}i(br,"findMiddleware");var su=class{static{i(this,"RegExpRouter")}name="RegExpRouter";#t;#e;constructor(){this.#t={[Ne]:Object.create(null)},this.#e={[Ne]:Object.create(null)}}add(r,e,t){let s=this.#t,n=this.#e;if(!s||!n)throw new Error(ii);s[r]||[s,n].forEach(c=>{c[r]=Object.create(null),Object.keys(c[Ne]).forEach(l=>{c[r][l]=[...c[Ne][l]]})}),e==="/*"&&(e="*");let o=(e.match(/\/:/g)||[]).length;if(/\*$/.test(e)){let c=Ng(e);r===Ne?Object.keys(s).forEach(l=>{s[l][e]||=br(s[l],e)||br(s[Ne],e)||[]}):s[r][e]||=br(s[r],e)||br(s[Ne],e)||[],Object.keys(s).forEach(l=>{(r===Ne||r===l)&&Object.keys(s[l]).forEach(d=>{c.test(d)&&s[l][d].push([t,o])})}),Object.keys(n).forEach(l=>{(r===Ne||r===l)&&Object.keys(n[l]).forEach(d=>c.test(d)&&n[l][d].push([t,o]))});return}let a=ni(e)||[e];for(let c=0,l=a.length;c<l;c++){let d=a[c];Object.keys(n).forEach(f=>{(r===Ne||r===f)&&(n[f][d]||=[...br(s[f],d)||br(s[Ne],d)||[]],n[f][d].push([t,o-l+c+1]))})}}match(r,e){DC();let t=this.#r();return this.match=(s,n)=>{let o=t[s]||t[Ne],a=o[2][n];if(a)return a;let c=n.match(o[0]);if(!c)return[[],Ag];let l=c.indexOf("",1);return[o[1][l],c]},this.match(r,e)}#r(){let r=Object.create(null);return Object.keys(this.#e).concat(Object.keys(this.#t)).forEach(e=>{r[e]||=this.#i(e)}),this.#t=this.#e=void 0,r}#i(r){let e=[],t=r===Ne;return[this.#t,this.#e].forEach(s=>{let n=s[r]?Object.keys(s[r]).map(o=>[o,s[r][o]]):[];n.length!==0?(t||=!0,e.push(...n)):r!==Ne&&e.push(...Object.keys(s[Ne]).map(o=>[o,s[Ne][o]]))}),t?BC(e):null}};S();w();b();S();w();b();var nu=class{static{i(this,"SmartRouter")}name="SmartRouter";#t=[];#e=[];constructor(r){this.#t=r.routers}add(r,e,t){if(!this.#e)throw new Error(ii);this.#e.push([r,e,t])}match(r,e){if(!this.#e)throw new Error("Fatal error");let t=this.#t,s=this.#e,n=t.length,o=0,a;for(;o<n;o++){let c=t[o];try{for(let l=0,d=s.length;l<d;l++)c.add(...s[l]);a=c.match(r,e)}catch(l){if(l instanceof oi)continue;throw l}this.match=c.match.bind(c),this.#t=[c],this.#e=void 0;break}if(o===n)throw new Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,a}get activeRouter(){if(this.#e||this.#t.length!==1)throw new Error("No active router has been determined yet.");return this.#t[0]}};S();w();b();S();w();b();S();w();b();var ds=Object.create(null),iu=class{static{i(this,"Node")}#t;#e;#r;#i=0;#n=ds;constructor(r,e,t){if(this.#e=t||Object.create(null),this.#t=[],r&&e){let s=Object.create(null);s[r]={handler:e,possibleKeys:[],score:0},this.#t=[s]}this.#r=[]}insert(r,e,t){this.#i=++this.#i;let s=this,n=dg(e),o=[];for(let a=0,c=n.length;a<c;a++){let l=n[a],d=n[a+1],f=mg(l,d),v=Array.isArray(f)?f[0]:l;if(v in s.#e){s=s.#e[v],f&&o.push(f[1]);continue}s.#e[v]=new iu,f&&(s.#r.push(f),o.push(f[1])),s=s.#e[v]}return s.#t.push({[r]:{handler:t,possibleKeys:o.filter((a,c,l)=>l.indexOf(a)===c),score:this.#i}}),s}#s(r,e,t,s){let n=[];for(let o=0,a=r.#t.length;o<a;o++){let c=r.#t[o],l=c[e]||c[Ne],d={};if(l!==void 0&&(l.params=Object.create(null),n.push(l),t!==ds||s&&s!==ds))for(let f=0,v=l.possibleKeys.length;f<v;f++){let y=l.possibleKeys[f],x=d[l.score];l.params[y]=s?.[y]&&!x?s[y]:t[y]??s?.[y],d[l.score]=!0}}return n}search(r,e){let t=[];this.#n=ds;let n=[this],o=Jc(e),a=[];for(let c=0,l=o.length;c<l;c++){let d=o[c],f=c===l-1,v=[];for(let y=0,x=n.length;y<x;y++){let m=n[y],h=m.#e[d];h&&(h.#n=m.#n,f?(h.#e["*"]&&t.push(...this.#s(h.#e["*"],r,m.#n)),t.push(...this.#s(h,r,m.#n))):v.push(h));for(let E=0,C=m.#r.length;E<C;E++){let P=m.#r[E],A=m.#n===ds?{}:{...m.#n};if(P==="*"){let N=m.#e["*"];N&&(t.push(...this.#s(N,r,m.#n)),N.#n=A,v.push(N));continue}if(!d)continue;let[B,k,R]=P,L=m.#e[B],M=o.slice(c).join("/");if(R instanceof RegExp){let N=R.exec(M);if(N){if(A[k]=N[0],t.push(...this.#s(L,r,m.#n,A)),Object.keys(L.#e).length){L.#n=A;let Q=N[0].match(/\//)?.length??0;(a[Q]||=[]).push(L)}continue}}(R===!0||R.test(d))&&(A[k]=d,f?(t.push(...this.#s(L,r,A,m.#n)),L.#e["*"]&&t.push(...this.#s(L.#e["*"],r,A,m.#n))):(L.#n=A,v.push(L)))}}n=v.concat(a.shift()??[])}return t.length>1&&t.sort((c,l)=>c.score-l.score),[t.map(({handler:c,params:l})=>[c,l])]}};var ou=class{static{i(this,"TrieRouter")}name="TrieRouter";#t;constructor(){this.#t=new iu}add(r,e,t){let s=ni(e);if(s){for(let n=0,o=s.length;n<o;n++)this.#t.insert(r,s[n],t);return}this.#t.insert(r,e,t)}match(r,e){return this.#t.search(r,e)}};var au=class extends ru{static{i(this,"Hono")}constructor(r={}){super(r),this.router=r.router??new nu({routers:[new su,new ou]})}};var kC=Object.defineProperty,ui=i((r,e)=>{for(var t in e)kC(r,t,{get:e[t],enumerable:!0})},"__export"),ie={};ui(ie,{address:i(()=>QC,"address"),bytes:i(()=>UC,"bytes"),bytes1:i(()=>$C,"bytes1"),bytes10:i(()=>JC,"bytes10"),bytes11:i(()=>XC,"bytes11"),bytes12:i(()=>ZC,"bytes12"),bytes13:i(()=>e2,"bytes13"),bytes14:i(()=>t2,"bytes14"),bytes15:i(()=>r2,"bytes15"),bytes16:i(()=>s2,"bytes16"),bytes17:i(()=>n2,"bytes17"),bytes18:i(()=>i2,"bytes18"),bytes19:i(()=>o2,"bytes19"),bytes2:i(()=>jC,"bytes2"),bytes20:i(()=>a2,"bytes20"),bytes21:i(()=>c2,"bytes21"),bytes22:i(()=>u2,"bytes22"),bytes23:i(()=>l2,"bytes23"),bytes24:i(()=>h2,"bytes24"),bytes25:i(()=>f2,"bytes25"),bytes26:i(()=>p2,"bytes26"),bytes27:i(()=>d2,"bytes27"),bytes28:i(()=>m2,"bytes28"),bytes29:i(()=>y2,"bytes29"),bytes3:i(()=>HC,"bytes3"),bytes30:i(()=>g2,"bytes30"),bytes31:i(()=>b2,"bytes31"),bytes32:i(()=>w2,"bytes32"),bytes4:i(()=>VC,"bytes4"),bytes5:i(()=>KC,"bytes5"),bytes6:i(()=>zC,"bytes6"),bytes7:i(()=>WC,"bytes7"),bytes8:i(()=>GC,"bytes8"),bytes9:i(()=>YC,"bytes9"),client:i(()=>qC,"client"),int104:i(()=>Z2,"int104"),int112:i(()=>eT,"int112"),int120:i(()=>tT,"int120"),int128:i(()=>rT,"int128"),int136:i(()=>sT,"int136"),int144:i(()=>nT,"int144"),int152:i(()=>iT,"int152"),int16:i(()=>$2,"int16"),int160:i(()=>oT,"int160"),int24:i(()=>j2,"int24"),int256:i(()=>aT,"int256"),int32:i(()=>H2,"int32"),int40:i(()=>V2,"int40"),int48:i(()=>K2,"int48"),int56:i(()=>z2,"int56"),int64:i(()=>W2,"int64"),int72:i(()=>G2,"int72"),int8:i(()=>U2,"int8"),int80:i(()=>Y2,"int80"),int88:i(()=>J2,"int88"),int96:i(()=>X2,"int96"),struct:i(()=>cT,"struct"),uint104:i(()=>I2,"uint104"),uint112:i(()=>L2,"uint112"),uint120:i(()=>M2,"uint120"),uint128:i(()=>D2,"uint128"),uint136:i(()=>B2,"uint136"),uint144:i(()=>k2,"uint144"),uint152:i(()=>F2,"uint152"),uint16:i(()=>v2,"uint16"),uint160:i(()=>q2,"uint160"),uint24:i(()=>_2,"uint24"),uint256:i(()=>Q2,"uint256"),uint32:i(()=>E2,"uint32"),uint40:i(()=>x2,"uint40"),uint48:i(()=>C2,"uint48"),uint56:i(()=>T2,"uint56"),uint64:i(()=>P2,"uint64"),uint72:i(()=>A2,"uint72"),uint8:i(()=>S2,"uint8"),uint80:i(()=>R2,"uint80"),uint88:i(()=>N2,"uint88"),uint96:i(()=>O2,"uint96")});var FC={};ui(FC,{Address:i(()=>Og,"Address"),Bytes:i(()=>Ig,"Bytes"),Int:i(()=>Mg,"Int"),Uint:i(()=>Lg,"Uint")});var Og=class cu{static{i(this,"_Address")}address;constructor(e){this.address=e}toJSON(){return"0x"+this.address.toString("hex")}static from(e){return e.startsWith("0x")?new cu(Buffer.from(e.slice(2),"hex")):new cu(Buffer.from(e,"hex"))}},Ig=class uu{static{i(this,"_Bytes")}data;constructor(e){this.data=e}toJSON(){return"0x"+this.data.toString("hex")}static from(e){return e.startsWith("0x")?new uu(Buffer.from(e.slice(2),"hex")):new uu(Buffer.from(e,"hex"))}},Lg=class{static{i(this,"Uint")}value;constructor(r){this.value=r}toJSON(){return this.value.toString(10)}},Mg=class{static{i(this,"Int")}value;constructor(r){this.value=r}toJSON(){return this.value.toString(10)}},qC=i(r=>{let e;if(!r.env.DB_CONNECTION_STRING)throw new Error("Missing required environment variable: DB_CONNECTION_STRING");return r.env.HYPERDRIVE?.connectionString?e=ei(r.env.HYPERDRIVE.connectionString):e=an(r.env.DB_CONNECTION_STRING),e},"client"),QC=vt({dataType(){return"bytea"},toDriver(r){return r.address},fromDriver(r){if(!(r instanceof Buffer))throw new Error("Expected Buffer for bytea type");return new Og(r)}}),pe=i(r=>vt({dataType(){return"bytea"},toDriver(e){return e.data.subarray(0,r)},fromDriver(e){if(!(e instanceof Buffer))throw new Error("Expected Buffer for bytea type");return new Ig(e.subarray(0,r))}}),"internalBytes"),UC=pe(),$C=pe(1),jC=pe(2),HC=pe(3),VC=pe(4),KC=pe(5),zC=pe(6),WC=pe(7),GC=pe(8),YC=pe(9),JC=pe(10),XC=pe(11),ZC=pe(12),e2=pe(13),t2=pe(14),r2=pe(15),s2=pe(16),n2=pe(17),i2=pe(18),o2=pe(19),a2=pe(20),c2=pe(21),u2=pe(22),l2=pe(23),h2=pe(24),f2=pe(25),p2=pe(26),d2=pe(27),m2=pe(28),y2=pe(29),g2=pe(30),b2=pe(31),w2=pe(32),Oe=i(r=>vt({dataType(){return"numeric"},toDriver(e){return e.value},fromDriver(e){if(typeof e=="string")return new Lg(BigInt(e));throw new Error("Invalid type for Uint: "+typeof e)}}),"uint"),S2=Oe(8),v2=Oe(16),_2=Oe(24),E2=Oe(32),x2=Oe(40),C2=Oe(48),T2=Oe(56),P2=Oe(64),A2=Oe(72),R2=Oe(80),N2=Oe(88),O2=Oe(96),I2=Oe(104),L2=Oe(112),M2=Oe(120),D2=Oe(128),B2=Oe(136),k2=Oe(144),F2=Oe(152),q2=Oe(160),Q2=Oe(256),Ie=i(r=>vt({dataType(){return"numeric"},toDriver(e){return e.value},fromDriver(e){if(typeof e=="string")return new Mg(BigInt(e));throw new Error("Invalid type for Int: "+typeof e)}}),"int"),U2=Ie(8),$2=Ie(16),j2=Ie(24),H2=Ie(32),V2=Ie(40),K2=Ie(48),z2=Ie(56),W2=Ie(64),G2=Ie(72),Y2=Ie(80),J2=Ie(88),X2=Ie(96),Z2=Ie(104),eT=Ie(112),tT=Ie(120),rT=Ie(128),sT=Ie(136),nT=Ie(144),iT=Ie(152),oT=Ie(160),aT=Ie(256),cT=i(r=>vt({dataType(){return"jsonb"},toDriver(e){return JSON.stringify(e)}})(r),"struct"),lu={};ui(lu,{create:i(()=>uT,"create")});var uT=i(r=>new au(r),"create"),hu={};ui(hu,{authentication:i(()=>hT,"authentication")});var lT="X-IDX-AUTHENTICATED-API-KEY-NAME",hT=i(async(r,e)=>r.env?.NODE_ENV==="production"?r.req.header(lT)?await e():Response.json({unauthenticated:!0},{status:401}):await e(),"authentication");var Dg=Ns("creations_base",{blockNumber:ie.uint64("block_number"),blockTimestamp:ie.uint64("block_timestamp"),contractAddress:ie.address("contract_address"),initializationCodeHash:ie.bytes32("initialization_code_hash"),initializationCodeLength:ie.uint64("initialization_code_length"),deployedBytecodeHash:ie.bytes32("deployed_bytecode_hash"),deployedBytecodeLength:ie.uint64("deployed_bytecode_length"),txnHash:ie.bytes32("txn_hash"),isFactory:zt("is_factory"),directDeploy:zt("direct_deploy"),deployerAddress:ie.address("deployer_address"),deployerType:Mt("deployer_type"),factoryAddress:ie.address("factory_address"),deploymentType:Mt("deployment_type"),txFrom:ie.address("tx_from"),txTo:ie.address("tx_to"),factoryFuncSig:ie.bytes4("factory_func_sig"),factoryCaller:ie.address("factory_caller")}),KV=Ns("logs_base",{contractAddress:ie.address("contract_address"),topic0:ie.bytes32("topic0"),topic1:ie.bytes32("topic1"),topic2:ie.bytes32("topic2"),topic3:ie.bytes32("topic3"),data:ie.bytes("data"),txnHash:ie.bytes32("txn_hash"),blockNumber:ie.uint64("block_number"),blockTimestamp:ie.uint64("block_timestamp"),evtIndex:ie.uint64("evt_index"),traceFrom:ie.address("trace_from"),txFrom:ie.address("tx_from"),txTo:ie.address("tx_to"),originalCallDepth:ie.uint64("original_call_depth"),emittedAfterTraceAddress:Mt("emitted_after_trace_address"),userOpFrom:ie.address("user_op_from"),funcSig:ie.bytes4("func_sig")}),zV=Ns("traces_base",{blockTimestamp:ie.uint64("block_timestamp"),blockNumber:ie.uint64("block_number"),txnHash:ie.bytes32("txn_hash"),caller:ie.address("caller"),callee:ie.address("callee"),funcSig:ie.bytes4("func_sig"),parentFuncSig:ie.bytes4("parent_func_sig"),txFrom:ie.address("tx_from"),txTo:ie.address("tx_to"),userOpFrom:ie.address("user_op_from"),callDepth:ie.uint64("call_depth"),traceAddress:Mt("trace_address"),success:zt("success"),callType:ie.uint64("call_type")});var fu=lu.create();fu.use("*",hu.authentication);fu.get("/*",async r=>{try{let e=await ie.client(r).select().from(Dg).limit(5);return Response.json({result:e})}catch(e){return console.error("Database operation failed:",e),Response.json({error:e.message},{status:500})}});var eK=fu;export{eK as default};
/*! Bundled license information:

@neondatabase/serverless/index.mjs:
  (*! Bundled license information:
  
  ieee754/index.js:
    (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)
  
  buffer/index.js:
    (*!
     * The buffer module from node.js, for the browser.
     *
     * @author   Feross Aboukhadijeh <https://feross.org>
     * @license  MIT
     *)
  *)
*/
//# sourceMappingURL=index.js.map
